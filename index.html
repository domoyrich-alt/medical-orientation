<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ú–µ–¥–∏—Ü–∏–Ω—Å–∫–∞—è –ü—Ä–æ—Ñ–æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏—è</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/test-design.css">
    <link rel="stylesheet" href="css/smooth-theme.css">
</head>
<body>


    <!-- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ -->
    <div class="auth-container" id="auth-container" style="display: flex;">
        <div class="auth-form wave-bg">
            <h2>–ú–µ–¥–∏—Ü–∏–Ω—Å–∫–∞—è –ü—Ä–æ—Ñ–æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏—è</h2>
            
            <div class="auth-tabs">
                <div class="auth-tab active" onclick="switchTab('login')">–í—Ö–æ–¥</div>
                <div class="auth-tab" onclick="switchTab('register')">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</div>
            </div>
            
            <!-- –§–æ—Ä–º–∞ –≤—Ö–æ–¥–∞ -->
            <div id="login-page" class="auth-page active">
                <form onsubmit="handleLogin(event)">
                    <div class="input-group">
                        <input type="email" id="login-email" placeholder="Email" required>
                        <i class="fas fa-envelope input-icon"></i>
                    </div>
                    
                    <div class="input-group">
                        <input type="password" id="login-password" placeholder="–ü–∞—Ä–æ–ª—å" required>
                        <i class="fas fa-lock input-icon"></i>
                    </div>
                    
                    <button type="submit" class="auth-button">
                        <i class="fas fa-sign-in-alt"></i>
                        –í–æ–π—Ç–∏
                    </button>
                </form>
            </div>
            
            <!-- –§–æ—Ä–º–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ -->
            <div id="register-page" class="auth-page">
                <form onsubmit="handleRegistration(event)">
                    <div class="input-group">
                        <input type="text" id="reg-username" placeholder="–ò–º—è –∏ –§–∞–º–∏–ª–∏—è" required>
                        <i class="fas fa-user input-icon"></i>
                    </div>
                    
                    <div class="input-group">
                        <input type="email" id="reg-email" placeholder="Email" required>
                        <i class="fas fa-envelope input-icon"></i>
                    </div>
                    
                    <div class="input-group">
                        <input type="tel" id="reg-phone" placeholder="–ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞" required>
                        <i class="fas fa-phone input-icon"></i>
                    </div>
                    
                    <div class="input-group">
                        <input type="number" id="reg-age" placeholder="–í–æ–∑—Ä–∞—Å—Ç" min="14" max="99" required>
                        <i class="fas fa-birthday-cake input-icon"></i>
                    </div>
                    
                    <div class="input-group">
                        <input type="password" id="reg-password" placeholder="–ü–∞—Ä–æ–ª—å" required>
                        <i class="fas fa-lock input-icon"></i>
                    </div>
                    
                    <div class="input-group">
                        <input type="password" id="reg-confirm-password" placeholder="–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å" required>
                        <i class="fas fa-lock input-icon"></i>
                    </div>
                    
                    <button type="submit" class="auth-button">
                        <i class="fas fa-user-plus"></i>
                        –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è
                    </button>
                </form>
            </div>
            
            <!-- –ö–æ–¥ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è -->
            <div id="verification-page" class="auth-page verification-code" style="display: none !important;">
                <h3>–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ email</h3>
                <p style="text-align: center; margin-bottom: 20px;">–ú—ã –æ—Ç–ø—Ä–∞–≤–∏–ª–∏ –∫–æ–¥ –Ω–∞ –≤–∞—à email</p>
                
                <div class="code-inputs">
                    <input type="text" maxlength="1" oninput="moveToNext(this, 1)" onkeyup="moveOnBackspace(this, 0)">
                    <input type="text" maxlength="1" oninput="moveToNext(this, 2)" onkeyup="moveOnBackspace(this, 1)">
                    <input type="text" maxlength="1" oninput="moveToNext(this, 3)" onkeyup="moveOnBackspace(this, 2)">
                    <input type="text" maxlength="1" oninput="moveToNext(this, 4)" onkeyup="moveOnBackspace(this, 3)">
                    <input type="text" maxlength="1" oninput="moveToNext(this, 5)" onkeyup="moveOnBackspace(this, 4)">
                    <input type="text" maxlength="1" onkeyup="moveOnBackspace(this, 5)">
                </div>
                
                <button type="button" class="auth-button" onclick="verifyCode()">–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å</button>
                <button type="button" class="auth-button" onclick="resendCode()" style="background: #f0f0f0; color: #333; margin-top: 10px;">–û—Ç–ø—Ä–∞–≤–∏—Ç—å –∫–æ–¥ –ø–æ–≤—Ç–æ—Ä–Ω–æ</button>
            </div>
        </div>
    </div>

    <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç -->
    <div class="main-content" id="main-content" style="display: none;">
        
        <!-- –ù–∞–≤–∏–≥–∞—Ü–∏—è -->
        <nav>
            <a href="#home" onclick="showSection('home')" class="active">üè† –ì–ª–∞–≤–Ω–∞—è</a>
            <a href="#tests" onclick="showSection('tests')">üìä –¢–µ—Å—Ç—ã</a>
            <a href="#profile" onclick="showSection('profile')">üë§ –ü—Ä–æ—Ñ–∏–ª—å</a>
            <a href="#learning" onclick="showSection('learning')">üìö –û–±—É—á–µ–Ω–∏–µ</a>
            <a href="#contacts" onclick="showSection('contacts')">üìû –ö–æ–Ω—Ç–∞–∫—Ç—ã</a>
            <button type="button" class="logout-btn" onclick="logout()">
                <i class="fas fa-sign-out-alt"></i>
                –í—ã–π—Ç–∏
            </button>
        </nav>

        <!-- –ì–ª–∞–≤–Ω–∞—è -->
        <section id="home" class="visible">
            <div class="card">
                <h2>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ —Å–∏—Å—Ç–µ–º—É –º–µ–¥–∏—Ü–∏–Ω—Å–∫–æ–π –ø—Ä–æ—Ñ–æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏–∏!</h2>
                <p style="margin-top: 20px; line-height: 1.6;">
                    –≠—Ç–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ —Å–æ–∑–¥–∞–Ω–∞ –¥–ª—è –ø–æ–º–æ—â–∏ —à–∫–æ–ª—å–Ω–∏–∫–∞–º –∏ –∞–±–∏—Ç—É—Ä–∏–µ–Ω—Ç–∞–º –≤ –≤—ã–±–æ—Ä–µ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–æ–π —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏. 
                    –ü—Ä–æ–π–¥–∏—Ç–µ —Ç–µ—Å—Ç—ã, –∏–∑—É—á–∏—Ç–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã –∏ –ø–æ–ª—É—á–∏—Ç–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –≤–∞—à–µ–º—É –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–º—É –ø—É—Ç–∏ –≤ –º–µ–¥–∏—Ü–∏–Ω–µ.
                </p>
                
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-top: 40px;">
                    <div style="background: rgba(102, 126, 234, 0.1); padding: 20px; border-radius: 15px;">
                        <h3 style="color: #667eea;">üéØ –¶–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞</h3>
                        <p style="margin-top: 10px;">–ü–æ–º–æ—á—å –º–æ–ª–æ–¥—ã–º –ª—é–¥—è–º –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Å–≤–æ—é —Å–∫–ª–æ–Ω–Ω–æ—Å—Ç—å –∫ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–º –ø—Ä–æ—Ñ–µ—Å—Å–∏—è–º</p>
                    </div>
                    
                    <div style="background: rgba(76, 175, 80, 0.1); padding: 20px; border-radius: 15px;">
                        <h3 style="color: #4CAF50;">üìà –ß—Ç–æ –≤—ã –ø–æ–ª—É—á–∏—Ç–µ</h3>
                        <p style="margin-top: 10px;">–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–æ–≤, —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ—Å—Ç—è–º, —É—á–µ–±–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã</p>
                    </div>
                    
                    <div style="background: rgba(255, 152, 0, 0.1); padding: 20px; border-radius: 15px;">
                        <h3 style="color: #FF9800;">üéì –î–ª—è –∫–æ–≥–æ</h3>
                        <p style="margin-top: 10px;">–î–ª—è —à–∫–æ–ª—å–Ω–∏–∫–æ–≤ 9-11 –∫–ª–∞—Å—Å–æ–≤, –ø–ª–∞–Ω–∏—Ä—É—é—â–∏—Ö –ø–æ—Å—Ç—É–ø–∞—Ç—å –≤ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–µ –≤—É–∑—ã</p>
                    </div>
                </div>
            </div>
                
                <!-- –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç -->
                <div class="card" style="margin-top: 30px;">
                    <h3><i class="fas fa-rocket" style="color: #667eea;"></i> –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç</h3>
                    <div class="quick-start-grid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-top: 20px;">
                        <button class="quick-start-btn" onclick="showSection('tests'); startTest('profession')">
                            <span class="quick-icon">üß†</span>
                            <span class="quick-text">–ü—Ä–æ–π—Ç–∏ —Ç–µ—Å—Ç –ø—Ä–æ—Ñ–æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏–∏</span>
                        </button>
                        <button class="quick-start-btn" onclick="showSection('learning')">
                            <span class="quick-icon">üìö</span>
                            <span class="quick-text">–ù–∞—á–∞—Ç—å –æ–±—É—á–µ–Ω–∏–µ</span>
                        </button>
                        <button class="quick-start-btn" onclick="showSection('profile')">
                            <span class="quick-icon">üë§</span>
                            <span class="quick-text">–ú–æ–π –ø—Ä–æ—Ñ–∏–ª—å</span>
                        </button>
                    </div>
                </div>
                
                <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã -->
                <div class="card" style="margin-top: 30px;">
                    <h3><i class="fas fa-chart-bar" style="color: #4CAF50;"></i> –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã</h3>
                    <div class="platform-stats" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 20px; margin-top: 20px;">
                        <div class="platform-stat">
                            <span class="stat-number" id="total-users-count">0</span>
                            <span class="stat-desc">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (–Ω–∞ —ç—Ç–æ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ)</span>
                        </div>
                        <div class="platform-stat">
                            <span class="stat-number" id="total-users-global-count">‚Äî</span>
                            <span class="stat-desc">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (–≤ —Ü–µ–ª–æ–º)</span>
                        </div>
                        <div class="platform-stat">
                            <span class="stat-number" id="total-tests-count">0</span>
                            <span class="stat-desc">–¢–µ—Å—Ç–æ–≤ –ø—Ä–æ–π–¥–µ–Ω–æ (–Ω–∞ —ç—Ç–æ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ)</span>
                        </div>
                        <div class="platform-stat">
                            <span class="stat-number" id="total-test-types-count">4</span>
                            <span class="stat-desc">–¢–∏–ø–∞ —Ç–µ—Å—Ç–æ–≤</span>
                        </div>
                        <div class="platform-stat">
                            <span class="stat-number" id="total-questions-count">0</span>
                            <span class="stat-desc">–í–æ–ø—Ä–æ—Å–æ–≤ –≤ –±–∞–∑–µ</span>
                        </div>
                    </div>
                </div>
                
                <!-- –ï–∂–µ–¥–Ω–µ–≤–Ω–∞—è –º–æ—Ç–∏–≤–∞—Ü–∏—è -->
                <div class="card motivation-card" style="margin-top: 30px; background: linear-gradient(135deg, #667eea, #764ba2); color: white;">
                    <h3><i class="fas fa-lightbulb"></i> –¶–∏—Ç–∞—Ç–∞ –¥–Ω—è</h3>
                    <p id="daily-quote" style="font-size: 1.2em; font-style: italic; margin-top: 15px; line-height: 1.6;">
                        "–ú–µ–¥–∏—Ü–∏–Ω–∞ ‚Äî —ç—Ç–æ –Ω–µ —Ç–æ–ª—å–∫–æ –Ω–∞—É–∫–∞, –Ω–æ –∏ –∏—Å–∫—É—Å—Å—Ç–≤–æ. –û–Ω–∞ —Ç—Ä–µ–±—É–µ—Ç –Ω–µ —Ç–æ–ª—å–∫–æ –∑–Ω–∞–Ω–∏–π, –Ω–æ –∏ —Å–µ—Ä–¥—Ü–∞."
                    </p>
                    <p id="quote-author" style="margin-top: 10px; opacity: 0.8;">‚Äî –ì–∏–ø–ø–æ–∫—Ä–∞—Ç</p>
                </div>
                
                <!-- –ú–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–µ —Ñ–∞–∫—Ç—ã -->
                <div class="card" style="margin-top: 30px;">
                    <h3><i class="fas fa-stethoscope" style="color: #e91e63;"></i> –ò–Ω—Ç–µ—Ä–µ—Å–Ω—ã–µ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–µ —Ñ–∞–∫—Ç—ã</h3>
                    <div class="facts-carousel" id="facts-carousel" style="margin-top: 20px;">
                        <div class="fact-card active">
                            <span class="fact-icon">ü´Ä</span>
                            <p>–°–µ—Ä–¥—Ü–µ —á–µ–ª–æ–≤–µ–∫–∞ –±—å–µ—Ç—Å—è –æ–∫–æ–ª–æ 100 000 —Ä–∞–∑ –≤ –¥–µ–Ω—å –∏ –ø–µ—Ä–µ–∫–∞—á–∏–≤–∞–µ—Ç –æ–∫–æ–ª–æ 7 500 –ª–∏—Ç—Ä–æ–≤ –∫—Ä–æ–≤–∏</p>
                        </div>
                        <div class="fact-card">
                            <span class="fact-icon">üß¨</span>
                            <p>–î–ù–ö —á–µ–ª–æ–≤–µ–∫–∞ –Ω–∞ 99.9% –∏–¥–µ–Ω—Ç–∏—á–Ω–∞ –î–ù–ö –ª—é–±–æ–≥–æ –¥—Ä—É–≥–æ–≥–æ —á–µ–ª–æ–≤–µ–∫–∞ –Ω–∞ –ø–ª–∞–Ω–µ—Ç–µ</p>
                        </div>
                        <div class="fact-card">
                            <span class="fact-icon">ü¶¥</span>
                            <p>–ù–æ–≤–æ—Ä–æ–∂–¥–µ–Ω–Ω—ã–π –∏–º–µ–µ—Ç –æ–∫–æ–ª–æ 270 –∫–æ—Å—Ç–µ–π, –Ω–æ —É –≤–∑—Ä–æ—Å–ª–æ–≥–æ —á–µ–ª–æ–≤–µ–∫–∞ –∏—Ö –≤—Å–µ–≥–æ 206</p>
                        </div>
                        <div class="fact-card">
                            <span class="fact-icon">üëÅÔ∏è</span>
                            <p>–ß–µ–ª–æ–≤–µ—á–µ—Å–∫–∏–π –≥–ª–∞–∑ –º–æ–∂–µ—Ç —Ä–∞–∑–ª–∏—á–∏—Ç—å –æ–∫–æ–ª–æ 10 –º–∏–ª–ª–∏–æ–Ω–æ–≤ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ü–≤–µ—Ç–æ–≤</p>
                        </div>
                        <div class="fact-card">
                            <span class="fact-icon">üß†</span>
                            <p>–ú–æ–∑–≥ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –æ–∫–æ–ª–æ 20% –≤—Å–µ–≥–æ –∫–∏—Å–ª–æ—Ä–æ–¥–∞ –∏ –∫–∞–ª–æ—Ä–∏–π, –ø–æ—Ç—Ä–µ–±–ª—è–µ–º—ã—Ö –æ—Ä–≥–∞–Ω–∏–∑–º–æ–º</p>
                        </div>
                    </div>
                    <div class="facts-controls" style="display: flex; justify-content: center; gap: 10px; margin-top: 15px;">
                        <button onclick="prevFact()" class="fact-btn"><i class="fas fa-chevron-left"></i></button>
                        <div class="facts-dots" id="facts-dots"></div>
                        <button onclick="nextFact()" class="fact-btn"><i class="fas fa-chevron-right"></i></button>
                    </div>
                </div>
                
                <!-- –ü–æ–ª–µ–∑–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã -->
                <div class="card" style="margin-top: 30px;">
                    <h3><i class="fas fa-link" style="color: #2196f3;"></i> –ü–æ–ª–µ–∑–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã</h3>
                    <div class="resources-grid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px; margin-top: 20px;">
                        <a href="https://www.mos.ru/otrasli/zdorove/" target="_blank" class="resource-link">
                            <i class="fas fa-hospital"></i>
                            <span>–ü–æ—Ä—Ç–∞–ª –∑–¥–æ—Ä–æ–≤—å—è</span>
                        </a>
                        <a href="https://www.who.int/ru" target="_blank" class="resource-link">
                            <i class="fas fa-globe"></i>
                            <span>–í–û–ó (WHO)</span>
                        </a>
                        <a href="#" onclick="showSection('learning'); return false;" class="resource-link">
                            <i class="fas fa-book-medical"></i>
                            <span>–£—á–µ–±–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã</span>
                        </a>
                        <a href="#" onclick="showSection('contacts'); return false;" class="resource-link">
                            <i class="fas fa-headset"></i>
                            <span>–ü–æ–¥–¥–µ—Ä–∂–∫–∞</span>
                        </a>
                    </div>
                </div>
        </section>

        <!-- –°–µ–∫—Ü–∏—è –¢–µ—Å—Ç–æ–≤ -->
        <section id="tests">
            <!-- –ü–∞–Ω–µ–ª—å –≤—ã–±–æ—Ä–∞ —Ç–µ—Å—Ç–æ–≤ –ø–æ –∫–ª–∞—Å—Å–∞–º –∏ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ -->
            <div class="card tests-selection-screen">
                <h2><i class="fas fa-clipboard-list"></i> –¶–µ–Ω—Ç—Ä —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è</h2>
                <p style="margin-top: 10px; color: rgba(255,255,255,0.8);">–í—ã–±–µ—Ä–∏—Ç–µ —Ç–µ—Å—Ç –¥–ª—è –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è. –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤–∫–ª—é—á–∞—é—Ç –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π –ø—Å–∏—Ö–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑.</p>
                
                <!-- –§–∏–ª—å—Ç—Ä –ø–æ –∫–ª–∞—Å—Å–∞–º -->
                <div class="tests-filter-panel" style="margin-top: 25px;">
                    <h3 class="filter-title"><i class="fas fa-graduation-cap"></i> –í—ã–±–µ—Ä–∏—Ç–µ –∫–ª–∞—Å—Å</h3>
                    <div class="filter-buttons grade-filters">
                        <button class="filter-btn active" onclick="filterByGrade('all')">–í—Å–µ</button>
                        <button class="filter-btn" onclick="filterByGrade(1)">1</button>
                        <button class="filter-btn" onclick="filterByGrade(2)">2</button>
                        <button class="filter-btn" onclick="filterByGrade(3)">3</button>
                        <button class="filter-btn" onclick="filterByGrade(4)">4</button>
                        <button class="filter-btn" onclick="filterByGrade(5)">5</button>
                        <button class="filter-btn" onclick="filterByGrade(6)">6</button>
                        <button class="filter-btn" onclick="filterByGrade(7)">7</button>
                        <button class="filter-btn" onclick="filterByGrade(8)">8</button>
                        <button class="filter-btn" onclick="filterByGrade(9)">9</button>
                        <button class="filter-btn" onclick="filterByGrade(10)">10</button>
                        <button class="filter-btn" onclick="filterByGrade(11)">11</button>
                    </div>
                    
                    <!-- –§–∏–ª—å—Ç—Ä –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º -->
                    <div class="difficulty-panel" style="margin-top: 20px;">
                        <h3 class="filter-title"><i class="fas fa-folder"></i> –ö–∞—Ç–µ–≥–æ—Ä–∏—è —Ç–µ—Å—Ç–∞</h3>
                        <div class="filter-buttons">
                            <button class="filter-btn category-btn active" onclick="filterByCategory('all')">–í—Å–µ</button>
                            <button class="filter-btn category-btn" onclick="filterByCategory('profession_general')">üéØ –ü—Ä–æ—Ñ–æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏—è</button>
                            <button class="filter-btn category-btn" onclick="filterByCategory('profession_med')">ü©∫ –ú–µ–¥. –ø—Ä–æ—Ñ–æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏—è</button>
                            <button class="filter-btn category-btn" onclick="filterByCategory('biology')">üß¨ –ë–∏–æ–ª–æ–≥–∏—è</button>
                            <button class="filter-btn category-btn" onclick="filterByCategory('chemistry')">üß™ –•–∏–º–∏—è</button>
                        </div>
                    </div>
                </div>
                
                <!-- –°–µ—Ç–∫–∞ —Ç–µ—Å—Ç–æ–≤ -->
                <div class="test-cards" id="tests-grid">
                    
                    <!-- ==================== –ü–†–û–§–û–†–ò–ï–ù–¢–ê–¶–ò–Ø –û–ë–©–ê–Ø ==================== -->
                    
                    <!-- 1-4 –∫–ª–∞—Å—Å -->
                    <div class="test-card" onclick="startTest('profession_general_1')" data-grade="1,2,3,4" data-category="profession_general">
                        <div class="test-card-icon">üåà</div>
                        <h3>–ö–µ–º —è —Ö–æ—á—É —Å—Ç–∞—Ç—å?</h3>
                        <p>–£–∑–Ω–∞–π –∫–∞–∫–∏–µ –ø—Ä–æ—Ñ–µ—Å—Å–∏–∏ —Ç–µ–±–µ –ø–æ–¥—Ö–æ–¥—è—Ç</p>
                        <div class="test-card-badge">20 –≤–æ–ø—Ä–æ—Å–æ–≤</div>
                        <div class="test-card-meta">
                            <span class="difficulty-tag easy">–õ—ë–≥–∫–∏–π</span>
                            <span class="grade-tag">1-4 –∫–ª–∞—Å—Å</span>
                        </div>
                    </div>
                    
                    <!-- 5-6 –∫–ª–∞—Å—Å -->
                    <div class="test-card" onclick="startTest('profession_general_5')" data-grade="5,6" data-category="profession_general">
                        <div class="test-card-icon">üéØ</div>
                        <h3>–ú–æ–∏ –∏–Ω—Ç–µ—Ä–µ—Å—ã –∏ —Ç–∞–ª–∞–Ω—Ç—ã</h3>
                        <p>–û–ø—Ä–µ–¥–µ–ª–∏ —Å–≤–æ–∏ —Å–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã</p>
                        <div class="test-card-badge">30 –≤–æ–ø—Ä–æ—Å–æ–≤</div>
                        <div class="test-card-meta">
                            <span class="difficulty-tag medium">–°—Ä–µ–¥–Ω–∏–π</span>
                            <span class="grade-tag">5-6 –∫–ª–∞—Å—Å</span>
                        </div>
                    </div>
                    
                    <!-- 7-8 –∫–ª–∞—Å—Å -->
                    <div class="test-card" onclick="startTest('profession_general_7')" data-grade="7,8" data-category="profession_general">
                        <div class="test-card-icon">üß≠</div>
                        <h3>–ü—Ä–æ—Ñ–æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏—è</h3>
                        <p>–¢–µ—Å—Ç –Ω–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã—Ö —Å–∫–ª–æ–Ω–Ω–æ—Å—Ç–µ–π</p>
                        <div class="test-card-badge">40 –≤–æ–ø—Ä–æ—Å–æ–≤</div>
                        <div class="test-card-meta">
                            <span class="difficulty-tag medium">–°—Ä–µ–¥–Ω–∏–π</span>
                            <span class="grade-tag">7-8 –∫–ª–∞—Å—Å</span>
                        </div>
                    </div>
                    
                    <!-- 9 –∫–ª–∞—Å—Å -->
                    <div class="test-card" onclick="startTest('profession_general_9')" data-grade="9" data-category="profession_general">
                        <div class="test-card-icon">üéì</div>
                        <h3>–í—ã–±–æ—Ä –ø—Ä–æ—Ñ–µ—Å—Å–∏–∏</h3>
                        <p>–ö–æ–º–ø–ª–µ–∫—Å–Ω—ã–π —Ç–µ—Å—Ç –ø—Ä–æ—Ñ–æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏–∏</p>
                        <div class="test-card-badge">40 –≤–æ–ø—Ä–æ—Å–æ–≤</div>
                        <div class="test-card-meta">
                            <span class="difficulty-tag hard">–°–ª–æ–∂–Ω—ã–π</span>
                            <span class="grade-tag">9 –∫–ª–∞—Å—Å</span>
                        </div>
                    </div>
                    
                    <!-- 10-11 –∫–ª–∞—Å—Å -->
                    <div class="test-card" onclick="startTest('profession_general_10')" data-grade="10,11" data-category="profession_general">
                        <div class="test-card-icon">üöÄ</div>
                        <h3>–ö–∞—Ä—å–µ—Ä–Ω—ã–π –ø—É—Ç—å</h3>
                        <p>–û–ø—Ä–µ–¥–µ–ª–∏ —Å–≤–æ–π –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π –ø—É—Ç—å</p>
                        <div class="test-card-badge">40 –≤–æ–ø—Ä–æ—Å–æ–≤</div>
                        <div class="test-card-meta">
                            <span class="difficulty-tag expert">–≠–∫—Å–ø–µ—Ä—Ç</span>
                            <span class="grade-tag">10-11 –∫–ª–∞—Å—Å</span>
                        </div>
                    </div>
                    
                    <!-- ==================== –ú–ï–î–ò–¶–ò–ù–°–ö–ê–Ø –ü–†–û–§–û–†–ò–ï–ù–¢–ê–¶–ò–Ø ==================== -->
                    
                    <!-- 1-4 –∫–ª–∞—Å—Å -->
                    <div class="test-card" onclick="startTest('profession_med_1')" data-grade="1,2,3,4" data-category="profession_med">
                        <div class="test-card-icon">üë®‚Äç‚öïÔ∏è</div>
                        <h3>–•–æ—á—É –ª–∏ —è –±—ã—Ç—å –≤—Ä–∞—á–æ–º?</h3>
                        <p>–£–∑–Ω–∞–π –ø–æ–¥—Ö–æ–¥–∏—Ç –ª–∏ —Ç–µ–±–µ –ø—Ä–æ—Ñ–µ—Å—Å–∏—è –≤—Ä–∞—á–∞</p>
                        <div class="test-card-badge">20 –≤–æ–ø—Ä–æ—Å–æ–≤</div>
                        <div class="test-card-meta">
                            <span class="difficulty-tag easy">–õ—ë–≥–∫–∏–π</span>
                            <span class="grade-tag">1-4 –∫–ª–∞—Å—Å</span>
                        </div>
                    </div>
                    
                    <!-- 5-6 –∫–ª–∞—Å—Å -->
                    <div class="test-card" onclick="startTest('profession_med_5')" data-grade="5,6" data-category="profession_med">
                        <div class="test-card-icon">üè•</div>
                        <h3>–ú–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–µ –ø—Ä–æ—Ñ–µ—Å—Å–∏–∏</h3>
                        <p>–ö–∞–∫–∞—è –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∞—è –ø—Ä–æ—Ñ–µ—Å—Å–∏—è —Ç–µ–±–µ –ø–æ–¥—Ö–æ–¥–∏—Ç?</p>
                        <div class="test-card-badge">30 –≤–æ–ø—Ä–æ—Å–æ–≤</div>
                        <div class="test-card-meta">
                            <span class="difficulty-tag medium">–°—Ä–µ–¥–Ω–∏–π</span>
                            <span class="grade-tag">5-6 –∫–ª–∞—Å—Å</span>
                        </div>
                    </div>
                    
                    <!-- 7-8 –∫–ª–∞—Å—Å -->
                    <div class="test-card" onclick="startTest('profession_med_7')" data-grade="7,8" data-category="profession_med">
                        <div class="test-card-icon">ü©∫</div>
                        <h3>–ü—É—Ç—å –≤ –º–µ–¥–∏—Ü–∏–Ω—É</h3>
                        <p>–û—Ü–µ–Ω–∏ —Å–≤–æ—é –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–æ–π –∫–∞—Ä—å–µ—Ä–µ</p>
                        <div class="test-card-badge">40 –≤–æ–ø—Ä–æ—Å–æ–≤</div>
                        <div class="test-card-meta">
                            <span class="difficulty-tag medium">–°—Ä–µ–¥–Ω–∏–π</span>
                            <span class="grade-tag">7-8 –∫–ª–∞—Å—Å</span>
                        </div>
                    </div>
                    
                    <!-- 9 –∫–ª–∞—Å—Å -->
                    <div class="test-card" onclick="startTest('profession_med_9')" data-grade="9" data-category="profession_med">
                        <div class="test-card-icon">‚öïÔ∏è</div>
                        <h3>–ú–µ–¥–∏—Ü–∏–Ω—Å–∫–∞—è –ø—Ä–æ—Ñ–æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏—è</h3>
                        <p>–û–ø—Ä–µ–¥–µ–ª–∏ —Å–≤–æ—é –º–µ–¥–∏—Ü–∏–Ω—Å–∫—É—é —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é</p>
                        <div class="test-card-badge">40 –≤–æ–ø—Ä–æ—Å–æ–≤</div>
                        <div class="test-card-meta">
                            <span class="difficulty-tag hard">–°–ª–æ–∂–Ω—ã–π</span>
                            <span class="grade-tag">9 –∫–ª–∞—Å—Å</span>
                        </div>
                    </div>
                    
                    <!-- 10-11 –∫–ª–∞—Å—Å -->
                    <div class="test-card" onclick="startTest('profession_med_10')" data-grade="10,11" data-category="profession_med">
                        <div class="test-card-icon">üî¨</div>
                        <h3>–í—ã–±–æ—Ä –º–µ–¥. —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏</h3>
                        <p>–ö–∞–∫–æ–π –≤—Ä–∞—á –∏–∑ —Ç–µ–±—è –ø–æ–ª—É—á–∏—Ç—Å—è?</p>
                        <div class="test-card-badge">40 –≤–æ–ø—Ä–æ—Å–æ–≤</div>
                        <div class="test-card-meta">
                            <span class="difficulty-tag expert">–≠–∫—Å–ø–µ—Ä—Ç</span>
                            <span class="grade-tag">10-11 –∫–ª–∞—Å—Å</span>
                        </div>
                    </div>
                    
                    <!-- ==================== –ë–ò–û–õ–û–ì–ò–Ø ==================== -->
                    
                    <!-- 1-4 –∫–ª–∞—Å—Å -->
                    <div class="test-card" onclick="startTest('biology_1')" data-grade="1,2,3,4" data-category="biology">
                        <div class="test-card-icon">üå±</div>
                        <h3>–ú–∏—Ä –ø—Ä–∏—Ä–æ–¥—ã</h3>
                        <p>–†–∞—Å—Ç–µ–Ω–∏—è, –∂–∏–≤–æ—Ç–Ω—ã–µ –∏ —á–µ–ª–æ–≤–µ–∫</p>
                        <div class="test-card-badge">20 –≤–æ–ø—Ä–æ—Å–æ–≤</div>
                        <div class="test-card-meta">
                            <span class="difficulty-tag easy">–õ—ë–≥–∫–∏–π</span>
                            <span class="grade-tag">1-4 –∫–ª–∞—Å—Å</span>
                        </div>
                    </div>
                    
                    <!-- 5-6 –∫–ª–∞—Å—Å -->
                    <div class="test-card" onclick="startTest('biology_5')" data-grade="5,6" data-category="biology">
                        <div class="test-card-icon">ü¶†</div>
                        <h3>–ñ–∏–≤—ã–µ –æ—Ä–≥–∞–Ω–∏–∑–º—ã</h3>
                        <p>–ö–ª–µ—Ç–∫–∏, —Ç–∫–∞–Ω–∏ –∏ –æ—Ä–≥–∞–Ω–∏–∑–º—ã</p>
                        <div class="test-card-badge">30 –≤–æ–ø—Ä–æ—Å–æ–≤</div>
                        <div class="test-card-meta">
                            <span class="difficulty-tag medium">–°—Ä–µ–¥–Ω–∏–π</span>
                            <span class="grade-tag">5-6 –∫–ª–∞—Å—Å</span>
                        </div>
                    </div>
                    
                    <!-- 7-8 –∫–ª–∞—Å—Å -->
                    <div class="test-card" onclick="startTest('biology_7')" data-grade="7,8" data-category="biology">
                        <div class="test-card-icon">üß¨</div>
                        <h3>–ê–Ω–∞—Ç–æ–º–∏—è —á–µ–ª–æ–≤–µ–∫–∞</h3>
                        <p>–°—Ç—Ä–æ–µ–Ω–∏–µ –∏ —Ñ—É–Ω–∫—Ü–∏–∏ –æ—Ä–≥–∞–Ω–∏–∑–º–∞</p>
                        <div class="test-card-badge">40 –≤–æ–ø—Ä–æ—Å–æ–≤</div>
                        <div class="test-card-meta">
                            <span class="difficulty-tag medium">–°—Ä–µ–¥–Ω–∏–π</span>
                            <span class="grade-tag">7-8 –∫–ª–∞—Å—Å</span>
                        </div>
                    </div>
                    
                    <!-- 9 –∫–ª–∞—Å—Å -->
                    <div class="test-card" onclick="startTest('biology_9')" data-grade="9" data-category="biology">
                        <div class="test-card-icon">üî¨</div>
                        <h3>–ë–∏–æ–ª–æ–≥–∏—è 9 –∫–ª–∞—Å—Å</h3>
                        <p>–ì–µ–Ω–µ—Ç–∏–∫–∞, —ç–≤–æ–ª—é—Ü–∏—è –∏ —ç–∫–æ–ª–æ–≥–∏—è</p>
                        <div class="test-card-badge">40 –≤–æ–ø—Ä–æ—Å–æ–≤</div>
                        <div class="test-card-meta">
                            <span class="difficulty-tag hard">–°–ª–æ–∂–Ω—ã–π</span>
                            <span class="grade-tag">9 –∫–ª–∞—Å—Å</span>
                        </div>
                    </div>
                    
                    <!-- 10-11 –∫–ª–∞—Å—Å -->
                    <div class="test-card" onclick="startTest('biology_10')" data-grade="10,11" data-category="biology">
                        <div class="test-card-icon">üß´</div>
                        <h3>–ë–∏–æ–ª–æ–≥–∏—è 10-11</h3>
                        <p>–ú–æ–ª–µ–∫—É–ª—è—Ä–Ω–∞—è –±–∏–æ–ª–æ–≥–∏—è –∏ –±–∏–æ—Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏</p>
                        <div class="test-card-badge">40 –≤–æ–ø—Ä–æ—Å–æ–≤</div>
                        <div class="test-card-meta">
                            <span class="difficulty-tag expert">–≠–∫—Å–ø–µ—Ä—Ç</span>
                            <span class="grade-tag">10-11 –∫–ª–∞—Å—Å</span>
                        </div>
                    </div>
                    
                    <!-- ==================== –•–ò–ú–ò–Ø ==================== -->
                    
                    <!-- 1-4 –∫–ª–∞—Å—Å -->
                    <div class="test-card" onclick="startTest('chemistry_1')" data-grade="1,2,3,4" data-category="chemistry">
                        <div class="test-card-icon">üíß</div>
                        <h3>–ú–∏—Ä –≤–µ—â–µ—Å—Ç–≤</h3>
                        <p>–í–æ–¥–∞, –≤–æ–∑–¥—É—Ö –∏ –ø—Ä–æ—Å—Ç—ã–µ –≤–µ—â–µ—Å—Ç–≤–∞</p>
                        <div class="test-card-badge">20 –≤–æ–ø—Ä–æ—Å–æ–≤</div>
                        <div class="test-card-meta">
                            <span class="difficulty-tag easy">–õ—ë–≥–∫–∏–π</span>
                            <span class="grade-tag">1-4 –∫–ª–∞—Å—Å</span>
                        </div>
                    </div>
                    
                    <!-- 5-6 –∫–ª–∞—Å—Å -->
                    <div class="test-card" onclick="startTest('chemistry_5')" data-grade="5,6" data-category="chemistry">
                        <div class="test-card-icon">‚öóÔ∏è</div>
                        <h3>–í–≤–µ–¥–µ–Ω–∏–µ –≤ —Ö–∏–º–∏—é</h3>
                        <p>–ê—Ç–æ–º—ã, –º–æ–ª–µ–∫—É–ª—ã –∏ –ø—Ä–µ–≤—Ä–∞—â–µ–Ω–∏—è</p>
                        <div class="test-card-badge">30 –≤–æ–ø—Ä–æ—Å–æ–≤</div>
                        <div class="test-card-meta">
                            <span class="difficulty-tag medium">–°—Ä–µ–¥–Ω–∏–π</span>
                            <span class="grade-tag">5-6 –∫–ª–∞—Å—Å</span>
                        </div>
                    </div>
                    
                    <!-- 7-8 –∫–ª–∞—Å—Å -->
                    <div class="test-card" onclick="startTest('chemistry_7')" data-grade="7,8" data-category="chemistry">
                        <div class="test-card-icon">üß™</div>
                        <h3>–•–∏–º–∏—è 7-8</h3>
                        <p>–•–∏–º–∏—á–µ—Å–∫–∏–µ —Ä–µ–∞–∫—Ü–∏–∏ –∏ —ç–ª–µ–º–µ–Ω—Ç—ã</p>
                        <div class="test-card-badge">40 –≤–æ–ø—Ä–æ—Å–æ–≤</div>
                        <div class="test-card-meta">
                            <span class="difficulty-tag medium">–°—Ä–µ–¥–Ω–∏–π</span>
                            <span class="grade-tag">7-8 –∫–ª–∞—Å—Å</span>
                        </div>
                    </div>
                    
                    <!-- 9 –∫–ª–∞—Å—Å -->
                    <div class="test-card" onclick="startTest('chemistry_9')" data-grade="9" data-category="chemistry">
                        <div class="test-card-icon">üî•</div>
                        <h3>–•–∏–º–∏—è 9 –∫–ª–∞—Å—Å</h3>
                        <p>–û—Ä–≥–∞–Ω–∏—á–µ—Å–∫–∞—è –∏ –Ω–µ–æ—Ä–≥–∞–Ω–∏—á–µ—Å–∫–∞—è —Ö–∏–º–∏—è</p>
                        <div class="test-card-badge">40 –≤–æ–ø—Ä–æ—Å–æ–≤</div>
                        <div class="test-card-meta">
                            <span class="difficulty-tag hard">–°–ª–æ–∂–Ω—ã–π</span>
                            <span class="grade-tag">9 –∫–ª–∞—Å—Å</span>
                        </div>
                    </div>
                    
                    <!-- 10-11 –∫–ª–∞—Å—Å -->
                    <div class="test-card" onclick="startTest('chemistry_10')" data-grade="10,11" data-category="chemistry">
                        <div class="test-card-icon">‚öõÔ∏è</div>
                        <h3>–•–∏–º–∏—è 10-11</h3>
                        <p>–£–≥–ª—É–±–ª—ë–Ω–Ω—ã–π –∫—É—Ä—Å –∏ –±–∏–æ—Ö–∏–º–∏—è</p>
                        <div class="test-card-badge">40 –≤–æ–ø—Ä–æ—Å–æ–≤</div>
                        <div class="test-card-meta">
                            <span class="difficulty-tag expert">–≠–∫—Å–ø–µ—Ä—Ç</span>
                            <span class="grade-tag">10-11 –∫–ª–∞—Å—Å</span>
                        </div>
                    </div>
                    
                </div>
            </div>

            <!-- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –≤–æ–ø—Ä–æ—Å–æ–≤ —Ç–µ—Å—Ç–∞ -->
            <div id="test-questions-container" class="test-container">
                <div class="card">
                    <div style="display: flex; justify-content: space-between; align-items: center; gap: 12px; margin-bottom: 15px; flex-wrap: wrap;">
                        <button class="test-button secondary" onclick="goBackToTests()" style="padding: 10px 14px;">
                            <i class="fas fa-arrow-left"></i> –ù–∞–∑–∞–¥ –∫ —Ç–µ—Å—Ç–∞–º
                        </button>
                        <div style="opacity: 0.75; font-size: 14px;">–ú–æ–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å—Å—è –∫ –≤—ã–±–æ—Ä—É —Ç–µ—Å—Ç–æ–≤ –≤ –ª—é–±–æ–π –º–æ–º–µ–Ω—Ç</div>
                    </div>
                    <!-- –ü–∞–Ω–µ–ª—å –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ –ø–æ –≤–æ–ø—Ä–æ—Å–∞–º -->
                    <div class="question-nav-panel">
                        <div class="question-nav-header">
                            <h3 style="color: #667eea;">–ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ –≤–æ–ø—Ä–æ—Å–∞–º</h3>
                            <button class="test-button warning" onclick="goToFirstSkipped()" style="padding: 8px 15px; font-size: 14px;">
                                <i class="fas fa-redo-alt"></i> –ö –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã–º
                            </button>
                        </div>
                        
                        <div class="question-nav-grid" id="question-nav">
                            <!-- –ö–Ω–æ–ø–∫–∏ –≤–æ–ø—Ä–æ—Å–æ–≤ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã —á–µ—Ä–µ–∑ JavaScript -->
                        </div>
                        
                        <div class="question-stats">
                            <div class="question-stat">
                                <div class="question-stat-color" style="background: #4CAF50;"></div>
                                <span>–û—Ç–≤–µ—á–µ–Ω–Ω—ã–µ</span>
                            </div>
                            <div class="question-stat">
                                <div class="question-stat-color" style="background: #667eea;"></div>
                                <span>–¢–µ–∫—É—â–∏–π</span>
                            </div>
                            <div class="question-stat">
                                <div class="question-stat-color" style="background: #ff9800;"></div>
                                <span>–ü—Ä–æ–ø—É—â–µ–Ω–Ω—ã–µ</span>
                            </div>
                            <div class="question-stat">
                                <div class="question-stat-color" style="background: #9c27b0;"></div>
                                <span>–û—Ç–º–µ—á–µ–Ω–Ω—ã–µ</span>
                            </div>
                            <div class="question-stat">
                                <div class="question-stat-color" style="background: #ff6b6b;"></div>
                                <span>–ü—É—Å—Ç—ã–µ</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="progress-bar">
                        <div class="progress-fill" id="test-progress"></div>
                    </div>
                    <div class="progress-text" id="progress-text">–í–æ–ø—Ä–æ—Å 1 –∏–∑ 40</div>
                    
                    <div id="questions-container">
                        <!-- –í–æ–ø—Ä–æ—Å—ã –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã —á–µ—Ä–µ–∑ JavaScript -->
                    </div>
                    
                    <div class="test-controls">
                        <button class="test-button secondary" onclick="prevQuestion()" id="prev-btn">
                            <i class="fas fa-arrow-left"></i> –ù–∞–∑–∞–¥
                        </button>
                        
                        <div style="display: flex; gap: 10px;">
                            <button class="test-button danger" onclick="clearCurrentAnswer()" id="clear-btn">
                                <i class="fas fa-times"></i> –û—á–∏—Å—Ç–∏—Ç—å
                            </button>
                            <button class="test-button success" onclick="markQuestion()" id="mark-btn">
                                <i class="fas fa-flag"></i> –û—Ç–º–µ—Ç–∏—Ç—å
                            </button>
                        </div>
                        
                        <button class="test-button" onclick="nextQuestion()" id="next-btn">
                            –î–∞–ª–µ–µ <i class="fas fa-arrow-right"></i>
                        </button>
                    </div>
                    
                    <button class="test-button pulse" onclick="checkTestResults()" id="check-btn" style="display: none; width: 100%; margin-top: 20px;">
                        <i class="fas fa-check-circle"></i> –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
                    </button>
                </div>
            </div>

            <!-- –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∞ - –ö—Ä–∞—Å–∏–≤—ã–π –¥–∏–∑–∞–π–Ω —Å –∞–Ω–∞–ª–∏–∑–æ–º -->
            <div id="test-results" class="result-container">
                <div class="result-header">
                    <h2>üéâ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∞</h2>
                    <div class="result-score" id="result-score">0%</div>
                    <p class="result-title" id="result-title"></p>
                </div>
                
                <div class="result-message" id="result-message"></div>
                
                <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ -->
                <div class="result-stats" id="result-stats">
                    <div class="stat-item">
                        <span class="stat-icon">‚úÖ</span>
                        <span class="stat-value" id="correct-count">0</span>
                        <span class="stat-label">–ü—Ä–∞–≤–∏–ª—å–Ω—ã—Ö</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-icon">‚ùå</span>
                        <span class="stat-value" id="incorrect-count">0</span>
                        <span class="stat-label">–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-icon">‚è±Ô∏è</span>
                        <span class="stat-value" id="time-spent">0:00</span>
                        <span class="stat-label">–í—Ä–µ–º—è</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-icon">üìä</span>
                        <span class="stat-value" id="accuracy-rate">0%</span>
                        <span class="stat-label">–¢–æ—á–Ω–æ—Å—Ç—å</span>
                    </div>
                </div>
                
                <!-- –ê–Ω–∞–ª–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ -->
                <div class="analysis-section" id="analysis-section">
                    <h3><i class="fas fa-chart-line"></i> –ê–Ω–∞–ª–∏–∑ –≤–∞—à–µ–≥–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞</h3>
                    
                    <div class="grade-estimate" id="grade-estimate">
                        üìà –í–∞—à —É—Ä–æ–≤–µ–Ω—å –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏: <span id="level-text">–û–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è...</span>
                    </div>
                    
                    <div class="strengths" id="strengths-section">
                        <h4>–°–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã</h4>
                        <div class="category-list">
                            <ul id="strengths-list">
                                <li>–ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–≤–æ–¥–∏—Ç—Å—è...</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="weaknesses" id="weaknesses-section">
                        <h4>–û–±–ª–∞—Å—Ç–∏ –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è</h4>
                        <div class="category-list">
                            <ul id="weaknesses-list">
                                <li>–ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–≤–æ–¥–∏—Ç—Å—è...</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="recommendations" id="recommendations-section">
                        <h4>–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏</h4>
                        <div class="category-list">
                            <ul id="recommendations-list">
                                <li>–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ —Ñ–æ—Ä–º–∏—Ä—É—é—Ç—Å—è...</li>
                            </ul>
                        </div>
                    </div>
                </div>
                
                <!-- –î–µ—Ç–∞–ª—å–Ω—ã–π —Ä–∞–∑–±–æ—Ä –æ—Ç–≤–µ—Ç–æ–≤ -->
                <div class="detailed-answers" id="detailed-answers">
                    <h3>üìã –î–µ—Ç–∞–ª—å–Ω—ã–π —Ä–∞–∑–±–æ—Ä –æ—Ç–≤–µ—Ç–æ–≤</h3>
                    <div id="answers-review">
                        <!-- –û—Ç–≤–µ—Ç—ã –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã —á–µ—Ä–µ–∑ JavaScript -->
                    </div>
                </div>
                
                <!-- –ö–Ω–æ–ø–∫–∏ –¥–µ–π—Å—Ç–≤–∏–π -->
                <div class="result-actions">
                    <button class="test-button success" onclick="restartCurrentTest()">
                        <i class="fas fa-redo"></i> –ü—Ä–æ–π—Ç–∏ –∑–∞–Ω–æ–≤–æ
                    </button>
                    <button class="test-button" onclick="goBackToTests()">
                        <i class="fas fa-list"></i> –í—Å–µ —Ç–µ—Å—Ç—ã
                    </button>
                    <button class="test-button secondary" onclick="shareResults()">
                        <i class="fas fa-share-alt"></i> –ü–æ–¥–µ–ª–∏—Ç—å—Å—è
                    </button>
                    <button class="test-button info" onclick="downloadResultsPDF()">
                        <i class="fas fa-file-pdf"></i> –°–∫–∞—á–∞—Ç—å PDF
                    </button>
                    <button class="test-button warning" onclick="printResults()">
                        <i class="fas fa-print"></i> –ü–µ—á–∞—Ç—å
                    </button>
                </div>
            </div>
            
            <!-- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –Ω–æ–≤–æ–π –∞–¥–∞–ø—Ç–∏–≤–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è -->
            <div class="test-container" style="display: none;">
                <div class="test-header">
                    <div class="current-test-line">
                        <span class="status-chip strong" id="current-test-label">–í—ã–±–µ—Ä–∏—Ç–µ —Ç–µ—Å—Ç, —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å</span>
                    </div>
                    <div class="test-progress">
                        <div class="progress-text">–ü—Ä–æ–≥—Ä–µ—Å—Å —Ç–µ—Å—Ç–∞</div>
                        <div class="progress-bar">
                            <div class="progress-fill" id="progress-fill"></div>
                        </div>
                        <div class="status-chips">
                            <div class="status-chip" id="difficulty-indicator">–£—Ä–æ–≤–µ–Ω—å —Å–ª–æ–∂–Ω–æ—Å—Ç–∏: –ù–∞—á–∞–ª—å–Ω—ã–π</div>
                            <div class="status-chip muted" id="skipped-info">–ü—Ä–æ–ø—É—â–µ–Ω–æ: 0</div>
                        </div>
                    </div>
                </div>
                
                <div id="question-card" class="question-card">
                    <div class="question-header">
                        <div class="question-progress">
                            <span class="status-chip strong" id="question-counter">–í–æ–ø—Ä–æ—Å 1 –∏–∑ 40</span>
                        </div>
                    </div>
                    
                    <div class="question-content">
                        <div id="question-text" class="question-text">–ù–∞–∂–º–∏—Ç–µ –Ω–∞ –ª—é–±–æ–π —Ç–µ—Å—Ç –≤—ã—à–µ, —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å</div>
                        <div id="options-container" class="options-container"></div>
                    </div>
                    
                    <div class="question-actions" style="display: flex; gap: 10px; justify-content: flex-end; flex-wrap: wrap;">
                        <button id="adaptive-prev-btn" class="btn btn-secondary" onclick="prevAdaptiveQuestion()" disabled>
                            <i class="fas fa-arrow-left"></i> –ù–∞–∑–∞–¥
                        </button>
                        <button id="adaptive-exit-btn" class="btn btn-secondary" onclick="goBackToTests()">
                            <i class="fas fa-sign-out-alt"></i> –í—ã–π—Ç–∏
                        </button>
                        <button id="adaptive-skip-btn" class="btn btn-skip" onclick="skipQuestion()">
                            <i class="fas fa-forward"></i> –ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å
                        </button>
                        <button id="adaptive-next-btn" class="btn btn-primary" onclick="nextQuestion()" disabled>
                            <i class="fas fa-arrow-right"></i> –û—Ç–≤–µ—Ç–∏—Ç—å / –î–∞–ª–µ–µ
                        </button>
                    </div>
                </div>
            </div>

            <!-- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã -->
            <div class="result-container" id="adaptive-result-container" style="display: none;">
                <div class="result-header">
                    <h2>üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∞–¥–∞–ø—Ç–∏–≤–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è</h2>
                    <div class="result-score" id="adaptive-result-score">0%</div>
                </div>
                
                <div class="result-stats" id="adaptive-result-stats">
                    <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω–∞ —á–µ—Ä–µ–∑ JavaScript -->
                </div>
                
                <div class="analysis-section" id="adaptive-analysis-section">
                    <!-- –ê–Ω–∞–ª–∏–∑ –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω —á–µ—Ä–µ–∑ JavaScript -->
                </div>
                
                <div class="detailed-answers" id="adaptive-detailed-answers">
                    <!-- –ü–æ–¥—Ä–æ–±–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã —á–µ—Ä–µ–∑ JavaScript -->
                </div>
                
                <div class="result-actions">
                    <button class="test-button success" onclick="restartTest()">
                        <i class="fas fa-redo"></i> –ü—Ä–æ–π—Ç–∏ –µ—â—ë —Ä–∞–∑
                    </button>
                    <button class="test-button primary" onclick="shareResults()">
                        <i class="fas fa-share-alt"></i> –ü–æ–¥–µ–ª–∏—Ç—å—Å—è
                    </button>
                    <button class="test-button secondary" onclick="goBackToTests()">
                        <i class="fas fa-arrow-left"></i> –ö —Ç–µ—Å—Ç–∞–º
                    </button>
                </div>
            </div>
        </section>

        <!-- –ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è -->
        <section id="profile">
            <div class="card float-animation">
                <div class="profile-header">
                    <div class="avatar-container particles">
                        <div id="avatar-placeholder" class="avatar-placeholder"></div>
                        <img id="avatar-image" class="avatar" style="display: none;" alt="–ê–≤–∞—Ç–∞—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è">
                        <div class="avatar-upload" onclick="document.getElementById('avatar-input').click()">
                            <i class="fas fa-camera"></i>
                        </div>
                        <input type="file" id="avatar-input" class="avatar-input" accept="image/*" onchange="handleAvatarUpload(event)">
                        <div class="profile-level-badge" id="profile-level-badge">
                            <span class="level-icon">‚≠ê</span>
                            <span class="level-text" id="user-level">–£—Ä–æ–≤–µ–Ω—å 1</span>
                        </div>
                    </div>
                    
                    <div class="profile-info">
                        <div class="profile-name-container">
                            <h2 id="profile-name">–ó–∞–≥—Ä—É–∑–∫–∞...</h2>
                            <button class="edit-name-btn" onclick="editProfileName()">
                                <i class="fas fa-pen"></i> –ò–∑–º–µ–Ω–∏—Ç—å
                            </button>
                        </div>
                        <p><i class="fas fa-envelope"></i> <span id="profile-email-text">–ó–∞–≥—Ä—É–∑–∫–∞...</span></p>
                        <p><i class="fas fa-phone"></i> <span id="profile-phone-text">–ó–∞–≥—Ä—É–∑–∫–∞...</span></p>
                        <p><i class="fas fa-birthday-cake"></i> <span id="profile-age-text">–ó–∞–≥—Ä—É–∑–∫–∞...</span></p>
                        <p><i class="fas fa-calendar-alt"></i> –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω: <span id="profile-reg-date">–ó–∞–≥—Ä—É–∑–∫–∞...</span></p>
                        <p><i class="fas fa-graduation-cap"></i> –°—Ç–∞—Ç—É—Å: <span id="profile-status">–ù–æ–≤–∏—á–æ–∫</span></p>
                    </div>
                </div>
                
                <!-- –ü—Ä–æ–≥—Ä–µ—Å—Å –±–∞—Ä —É—Ä–æ–≤–Ω—è -->
                <div class="level-progress-container">
                    <div class="level-progress-header">
                        <span>–û–ø—ã—Ç –¥–æ —Å–ª–µ–¥—É—é—â–µ–≥–æ —É—Ä–æ–≤–Ω—è</span>
                        <span id="xp-text">0 / 100 XP</span>
                    </div>
                    <div class="level-progress-bar">
                        <div class="level-progress-fill" id="xp-progress" style="width: 0%"></div>
                    </div>
                </div>
                
                <div class="profile-stats">
                    <div class="stat-card">
                        <div class="stat-value" id="tests-completed">0</div>
                        <div class="stat-label">–ü—Ä–æ–π–¥–µ–Ω–æ —Ç–µ—Å—Ç–æ–≤</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="average-score">0%</div>
                        <div class="stat-label">–°—Ä–µ–¥–Ω–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="best-score">0%</div>
                        <div class="stat-label">–õ—É—á—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="days-registered">0</div>
                        <div class="stat-label">–î–Ω–µ–π —Å –Ω–∞–º–∏</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="total-xp">0</div>
                        <div class="stat-label">–í—Å–µ–≥–æ XP</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="streak-days">0</div>
                        <div class="stat-label">–î–Ω–µ–π –ø–æ–¥—Ä—è–¥</div>
                    </div>
                </div>
                
                <!-- –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∫–∞—Ä—å–µ—Ä–µ -->
                <div class="career-recommendations">
                    <h3><i class="fas fa-compass"></i> –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏</h3>
                    <div id="career-recommendations-list" class="career-list">
                        <p style="text-align: center; color: #999; padding: 20px;">–ü—Ä–æ–π–¥–∏—Ç–µ —Ç–µ—Å—Ç—ã, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏</p>
                    </div>
                </div>
                
                <!-- –ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è -->
                <div class="quick-actions">
                    <h3><i class="fas fa-bolt"></i> –ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è</h3>
                    <div class="actions-grid">
                        <button class="action-btn" onclick="showSection('tests'); startTest('profession')">
                            <i class="fas fa-brain"></i>
                            <span>–ü—Ä–æ—Ñ–æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏—è</span>
                        </button>
                        <button class="action-btn" onclick="showSection('tests'); startTest('biology')">
                            <i class="fas fa-dna"></i>
                            <span>–¢–µ—Å—Ç –ø–æ –±–∏–æ–ª–æ–≥–∏–∏</span>
                        </button>
                        <button class="action-btn" onclick="showSection('tests'); startTest('chemistry')">
                            <i class="fas fa-flask"></i>
                            <span>–¢–µ—Å—Ç –ø–æ —Ö–∏–º–∏–∏</span>
                        </button>
                        <button class="action-btn" onclick="showSection('learning')">
                            <i class="fas fa-book-open"></i>
                            <span>–£—á–µ–±–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã</span>
                        </button>
                        <button class="action-btn" onclick="viewTestHistory()">
                            <i class="fas fa-history"></i>
                            <span>–ò—Å—Ç–æ—Ä–∏—è —Ç–µ—Å—Ç–æ–≤</span>
                        </button>
                        <button class="action-btn" onclick="editProfileName()">
                            <i class="fas fa-user-edit"></i>
                            <span>–ò–∑–º–µ–Ω–∏—Ç—å –∏–º—è</span>
                        </button>
                        <button class="action-btn" onclick="exportProfile()">
                            <i class="fas fa-file-export"></i>
                            <span>–≠–∫—Å–ø–æ—Ä—Ç –ø—Ä–æ—Ñ–∏–ª—è</span>
                        </button>
                        <button class="action-btn" onclick="showSection('contacts')">
                            <i class="fas fa-headset"></i>
                            <span>–ü–æ–¥–¥–µ—Ä–∂–∫–∞</span>
                        </button>
                    </div>
                </div>
                
                <div class="test-history">
                    <h3><i class="fas fa-history"></i> –ò—Å—Ç–æ—Ä–∏—è —Ç–µ—Å—Ç–æ–≤</h3>
                    <div id="tests-history-container">
                        <p style="text-align: center; color: #999; padding: 20px;">–¢–µ—Å—Ç—ã –µ—â–µ –Ω–µ –ø—Ä–æ–π–¥–µ–Ω—ã</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- –û–±—É—á–µ–Ω–∏–µ -->
        <section id="learning">
            <div class="card">
                <h2>üìö –û–±—É—á–µ–Ω–∏–µ –∏ –º–∞—Ç–µ—Ä–∏–∞–ª—ã</h2>
                <p style="margin-top: 10px;">–ò–∑—É—á–∏—Ç–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã –¥–ª—è –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ –∫ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–æ–º—É –≤—É–∑—É</p>
                
                <div class="learning-grid">
                    <!-- –û—Å–Ω–æ–≤—ã –º–µ–¥–∏—Ü–∏–Ω—ã -->
                    <div class="learning-card" onclick="toggleLearningCard(this)">
                        <div class="learning-toggle">‚ñº</div>
                        <h3><i class="fas fa-book-medical"></i> –û—Å–Ω–æ–≤—ã –º–µ–¥–∏—Ü–∏–Ω—ã</h3>
                        <p>–í–≤–µ–¥–µ–Ω–∏–µ –≤ –º–µ–¥–∏—Ü–∏–Ω—Å–∫—É—é –Ω–∞—É–∫—É, –∏—Å—Ç–æ—Ä–∏—è –º–µ–¥–∏—Ü–∏–Ω—ã, –æ—Å–Ω–æ–≤–Ω—ã–µ –ø–æ–Ω—è—Ç–∏—è –∏ —Ç–µ—Ä–º–∏–Ω—ã</p>
                        
                        <div class="learning-details">
                            <div class="learning-content">
                                <h4><i class="fas fa-info-circle"></i> –ß—Ç–æ —Ç–∞–∫–æ–µ –º–µ–¥–∏—Ü–∏–Ω–∞?</h4>
                                <p>–ú–µ–¥–∏—Ü–∏–Ω–∞ ‚Äî —ç—Ç–æ –Ω–∞—É–∫–∞ –∏ –ø—Ä–∞–∫—Ç–∏–∫–∞ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏, –ª–µ—á–µ–Ω–∏—è –∏ –ø—Ä–æ—Ñ–∏–ª–∞–∫—Ç–∏–∫–∏ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–π. –û–Ω–∞ –≤–∫–ª—é—á–∞–µ—Ç –≤ —Å–µ–±—è —Ä–∞–∑–ª–∏—á–Ω—ã–µ –æ–±–ª–∞—Å—Ç–∏ –∑–Ω–∞–Ω–∏–π –æ –∑–¥–æ—Ä–æ–≤—å–µ —á–µ–ª–æ–≤–µ–∫–∞.</p>
                                
                                <h4><i class="fas fa-history"></i> –ò—Å—Ç–æ—Ä–∏—è –º–µ–¥–∏—Ü–∏–Ω—ã</h4>
                                <ul>
                                    <li><strong>–î—Ä–µ–≤–Ω–∏–π –º–∏—Ä:</strong> –ü–µ—Ä–≤—ã–µ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–µ –∑–Ω–∞–Ω–∏—è –ø–æ—è–≤–∏–ª–∏—Å—å –≤ –î—Ä–µ–≤–Ω–µ–º –ï–≥–∏–ø—Ç–µ, –ú–µ—Å–æ–ø–æ—Ç–∞–º–∏–∏, –ò–Ω–¥–∏–∏ –∏ –ö–∏—Ç–∞–µ</li>
                                    <li><strong>–ê–Ω—Ç–∏—á–Ω–æ—Å—Ç—å:</strong> –ì–∏–ø–ø–æ–∫—Ä–∞—Ç —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–ª –æ—Å–Ω–æ–≤—ã –º–µ–¥–∏—Ü–∏–Ω—Å–∫–æ–π —ç—Ç–∏–∫–∏, –ì–∞–ª–µ–Ω –∑–∞–ª–æ–∂–∏–ª –æ—Å–Ω–æ–≤—ã –∞–Ω–∞—Ç–æ–º–∏–∏</li>
                                    <li><strong>–°—Ä–µ–¥–Ω–µ–≤–µ–∫–æ–≤—å–µ:</strong> –†–∞–∑–≤–∏—Ç–∏–µ –º–µ–¥–∏—Ü–∏–Ω—ã –≤ –∞—Ä–∞–±—Å–∫–æ–º –º–∏—Ä–µ, —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∞–Ω—Ç–∏—á–Ω—ã—Ö –∑–Ω–∞–Ω–∏–π</li>
                                    <li><strong>–≠–ø–æ—Ö–∞ –í–æ–∑—Ä–æ–∂–¥–µ–Ω–∏—è:</strong> –ê–Ω–¥—Ä–µ–∞—Å –í–µ–∑–∞–ª–∏–π —Å–æ–∑–¥–∞–ª —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—É—é –∞–Ω–∞—Ç–æ–º–∏—é</li>
                                    <li><strong>XIX-XX –≤–µ–∫–∞:</strong> –û—Ç–∫—Ä—ã—Ç–∏–µ –º–∏–∫—Ä–æ–æ—Ä–≥–∞–Ω–∏–∑–º–æ–≤, —Ä–∞–∑–≤–∏—Ç–∏–µ —Ö–∏—Ä—É—Ä–≥–∏–∏, –ø–æ—è–≤–ª–µ–Ω–∏–µ –∞–Ω—Ç–∏–±–∏–æ—Ç–∏–∫–æ–≤</li>
                                </ul>
                                
                                <h4><i class="fas fa-stethoscope"></i> –û—Å–Ω–æ–≤–Ω—ã–µ –ø–æ–Ω—è—Ç–∏—è</h4>
                                <ul>
                                    <li><strong>–ó–¥–æ—Ä–æ–≤—å–µ:</strong> –°–æ—Å—Ç–æ—è–Ω–∏–µ –ø–æ–ª–Ω–æ–≥–æ —Ñ–∏–∑–∏—á–µ—Å–∫–æ–≥–æ, –ø—Å–∏—Ö–∏—á–µ—Å–∫–æ–≥–æ –∏ —Å–æ—Ü–∏–∞–ª—å–Ω–æ–≥–æ –±–ª–∞–≥–æ–ø–æ–ª—É—á–∏—è</li>
                                    <li><strong>–ë–æ–ª–µ–∑–Ω—å:</strong> –ù–∞—Ä—É—à–µ–Ω–∏–µ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–π –∂–∏–∑–Ω–µ–¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –æ—Ä–≥–∞–Ω–∏–∑–º–∞</li>
                                    <li><strong>–î–∏–∞–≥–Ω–æ–∑:</strong> –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ –æ–±—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è</li>
                                    <li><strong>–õ–µ—á–µ–Ω–∏–µ:</strong> –ö–æ–º–ø–ª–µ–∫—Å –º–µ—Ä –¥–ª—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –∑–¥–æ—Ä–æ–≤—å—è</li>
                                    <li><strong>–ü—Ä–æ—Ñ–∏–ª–∞–∫—Ç–∏–∫–∞:</strong> –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–π</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    
                    <!-- –ê–Ω–∞—Ç–æ–º–∏—è —á–µ–ª–æ–≤–µ–∫–∞ -->
                    <div class="learning-card" onclick="toggleLearningCard(this)">
                        <div class="learning-toggle">‚ñº</div>
                        <h3><i class="fas fa-brain"></i> –ê–Ω–∞—Ç–æ–º–∏—è —á–µ–ª–æ–≤–µ–∫–∞</h3>
                        <p>–°—Ç—Ä–æ–µ–Ω–∏–µ —á–µ–ª–æ–≤–µ—á–µ—Å–∫–æ–≥–æ —Ç–µ–ª–∞, —Å–∏—Å—Ç–µ–º—ã –æ—Ä–≥–∞–Ω–æ–≤, —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è –∞–Ω–∞—Ç–æ–º–∏—è</p>
                        
                        <div class="learning-details">
                            <div class="learning-content">
                                <h4><i class="fas fa-bone"></i> –û—Å–Ω–æ–≤–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã –æ—Ä–≥–∞–Ω–∏–∑–º–∞</h4>
                                <ul>
                                    <li><strong>–û–ø–æ—Ä–Ω–æ-–¥–≤–∏–≥–∞—Ç–µ–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞:</strong> –ö–æ—Å—Ç–∏, –º—ã—à—Ü—ã, —Å—É—Å—Ç–∞–≤—ã</li>
                                    <li><strong>–ù–µ—Ä–≤–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞:</strong> –ì–æ–ª–æ–≤–Ω–æ–π –∏ —Å–ø–∏–Ω–Ω–æ–π –º–æ–∑–≥, –Ω–µ—Ä–≤—ã</li>
                                    <li><strong>–°–µ—Ä–¥–µ—á–Ω–æ-—Å–æ—Å—É–¥–∏—Å—Ç–∞—è —Å–∏—Å—Ç–µ–º–∞:</strong> –°–µ—Ä–¥—Ü–µ, –∫—Ä–æ–≤–µ–Ω–æ—Å–Ω—ã–µ —Å–æ—Å—É–¥—ã</li>
                                    <li><strong>–î—ã—Ö–∞—Ç–µ–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞:</strong> –õ–µ–≥–∫–∏–µ, —Ç—Ä–∞—Ö–µ—è, –±—Ä–æ–Ω—Ö–∏</li>
                                    <li><strong>–ü–∏—â–µ–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞:</strong> –ñ–µ–ª—É–¥–æ–∫, –∫–∏—à–µ—á–Ω–∏–∫, –ø–µ—á–µ–Ω—å</li>
                                    <li><strong>–ú–æ—á–µ–≤—ã–¥–µ–ª–∏—Ç–µ–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞:</strong> –ü–æ—á–∫–∏, –º–æ—á–µ–≤–æ–π –ø—É–∑—ã—Ä—å</li>
                                    <li><strong>–≠–Ω–¥–æ–∫—Ä–∏–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞:</strong> –ñ–µ–ª–µ–∑—ã –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–π —Å–µ–∫—Ä–µ—Ü–∏–∏</li>
                                    <li><strong>–ò–º–º—É–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞:</strong> –õ–∏–º—Ñ–∞—Ç–∏—á–µ—Å–∫–∏–µ —É–∑–ª—ã, —Å–µ–ª–µ–∑–µ–Ω–∫–∞</li>
                                </ul>
                                
                                <h4><i class="fas fa-heartbeat"></i> –í–∞–∂–Ω—ã–µ –æ—Ä–≥–∞–Ω—ã</h4>
                                <ul>
                                    <li><strong>–°–µ—Ä–¥—Ü–µ:</strong> –ù–∞—Å–æ—Å, –ø–µ—Ä–µ–∫–∞—á–∏–≤–∞—é—â–∏–π –∫—Ä–æ–≤—å –ø–æ –≤—Å–µ–º—É —Ç–µ–ª—É</li>
                                    <li><strong>–ú–æ–∑–≥:</strong> –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π –æ—Ä–≥–∞–Ω –Ω–µ—Ä–≤–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã</li>
                                    <li><strong>–õ–µ–≥–∫–∏–µ:</strong> –û—Ä–≥–∞–Ω—ã –≥–∞–∑–æ–æ–±–º–µ–Ω–∞</li>
                                    <li><strong>–ü–µ—á–µ–Ω—å:</strong> –ö—Ä—É–ø–Ω–µ–π—à–∞—è –∂–µ–ª–µ–∑–∞, –≤—ã–ø–æ–ª–Ω—è—é—â–∞—è –º–Ω–æ–∂–µ—Å—Ç–≤–æ —Ñ—É–Ω–∫—Ü–∏–π</li>
                                    <li><strong>–ü–æ—á–∫–∏:</strong> –§–∏–ª—å—Ç—Ä—É—é—Ç –∫—Ä–æ–≤—å –∏ –≤—ã–≤–æ–¥—è—Ç —Ç–æ–∫—Å–∏–Ω—ã</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    
                    <!-- –ú–µ–¥–∏—Ü–∏–Ω—Å–∫–∞—è —Ö–∏–º–∏—è -->
                    <div class="learning-card" onclick="toggleLearningCard(this)">
                        <div class="learning-toggle">‚ñº</div>
                        <h3><i class="fas fa-vial"></i> –ú–µ–¥–∏—Ü–∏–Ω—Å–∫–∞—è —Ö–∏–º–∏—è</h3>
                        <p>–û—Å–Ω–æ–≤—ã –±–∏–æ—Ö–∏–º–∏–∏, —Ñ–∞—Ä–º–∞–∫–æ–ª–æ–≥–∏–∏, —Ö–∏–º–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ—Ü–µ—Å—Å—ã –≤ –æ—Ä–≥–∞–Ω–∏–∑–º–µ</p>
                        
                        <div class="learning-details">
                            <div class="learning-content">
                                <h4><i class="fas fa-atom"></i> –û—Å–Ω–æ–≤–Ω—ã–µ —Ö–∏–º–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ—Ü–µ—Å—Å—ã</h4>
                                <ul>
                                    <li><strong>–ú–µ—Ç–∞–±–æ–ª–∏–∑–º:</strong> –°–æ–≤–æ–∫—É–ø–Ω–æ—Å—Ç—å —Ö–∏–º–∏—á–µ—Å–∫–∏—Ö —Ä–µ–∞–∫—Ü–∏–π –≤ –æ—Ä–≥–∞–Ω–∏–∑–º–µ</li>
                                    <li><strong>–§–æ—Ç–æ—Å–∏–Ω—Ç–µ–∑:</strong> –ü—Ä–æ—Ü–µ—Å—Å –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –æ—Ä–≥–∞–Ω–∏—á–µ—Å–∫–∏—Ö –≤–µ—â–µ—Å—Ç–≤ –≤ —Ä–∞—Å—Ç–µ–Ω–∏—è—Ö</li>
                                    <li><strong>–î—ã—Ö–∞–Ω–∏–µ:</strong> –ü—Ä–æ—Ü–µ—Å—Å –ø–æ–ª—É—á–µ–Ω–∏—è —ç–Ω–µ—Ä–≥–∏–∏ –∏–∑ –ø–∏—Ç–∞—Ç–µ–ª—å–Ω—ã—Ö –≤–µ—â–µ—Å—Ç–≤</li>
                                    <li><strong>–ü–∏—â–µ–≤–∞—Ä–µ–Ω–∏–µ:</strong> –†–∞—Å—â–µ–ø–ª–µ–Ω–∏–µ —Å–ª–æ–∂–Ω—ã—Ö –≤–µ—â–µ—Å—Ç–≤ –Ω–∞ –ø—Ä–æ—Å—Ç—ã–µ</li>
                                </ul>
                                
                                <h4><i class="fas fa-pills"></i> –§–∞—Ä–º–∞–∫–æ–ª–æ–≥–∏—è</h4>
                                <ul>
                                    <li><strong>–õ–µ–∫–∞—Ä—Å—Ç–≤–µ–Ω–Ω—ã–µ —Ñ–æ—Ä–º—ã:</strong> –¢–∞–±–ª–µ—Ç–∫–∏, –∫–∞–ø—Å—É–ª—ã, —Ä–∞—Å—Ç–≤–æ—Ä—ã, –º–∞–∑–∏</li>
                                    <li><strong>–ú–µ—Ö–∞–Ω–∏–∑–º –¥–µ–π—Å—Ç–≤–∏—è:</strong> –ö–∞–∫ –ª–µ–∫–∞—Ä—Å—Ç–≤–∞ —Ä–∞–±–æ—Ç–∞—é—Ç –≤ –æ—Ä–≥–∞–Ω–∏–∑–º–µ</li>
                                    <li><strong>–ü–æ–±–æ—á–Ω—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã:</strong> –ù–µ–∂–µ–ª–∞—Ç–µ–ª—å–Ω—ã–µ —Ä–µ–∞–∫—Ü–∏–∏ –Ω–∞ –ª–µ–∫–∞—Ä—Å—Ç–≤–∞</li>
                                    <li><strong>–î–æ–∑–∏—Ä–æ–≤–∫–∞:</strong> –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ª–µ–∫–∞—Ä—Å—Ç–≤–∞</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    
                    <!-- –ü—Ä–æ—Ñ–µ—Å—Å–∏–∏ –≤ –º–µ–¥–∏—Ü–∏–Ω–µ -->
                    <div class="learning-card" onclick="toggleLearningCard(this)">
                        <div class="learning-toggle">‚ñº</div>
                        <h3><i class="fas fa-user-md"></i> –ü—Ä–æ—Ñ–µ—Å—Å–∏–∏ –≤ –º–µ–¥–∏—Ü–∏–Ω–µ</h3>
                        <p>–û–±–∑–æ—Ä –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏—Ö —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–µ–π, —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è, –∫–∞—Ä—å–µ—Ä–Ω—ã–µ –ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤—ã</p>
                        
                        <div class="learning-details">
                            <div class="learning-content">
                                <h4><i class="fas fa-stethoscope"></i> –û—Å–Ω–æ–≤–Ω—ã–µ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–µ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏</h4>
                                <ul>
                                    <li><strong>–¢–µ—Ä–∞–ø–µ–≤—Ç:</strong> –í—Ä–∞—á –æ–±—â–µ–π –ø—Ä–∞–∫—Ç–∏–∫–∏, –ø–µ—Ä–≤—ã–π –∫–æ–Ω—Ç–∞–∫—Ç —Å –ø–∞—Ü–∏–µ–Ω—Ç–æ–º</li>
                                    <li><strong>–•–∏—Ä—É—Ä–≥:</strong> –ü—Ä–æ–≤–æ–¥–∏—Ç –æ–ø–µ—Ä–∞—Ü–∏–∏, —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è –Ω–∞ —Ä–∞–∑–Ω—ã—Ö –æ—Ä–≥–∞–Ω–∞—Ö</li>
                                    <li><strong>–ü–µ–¥–∏–∞—Ç—Ä:</strong> –í—Ä–∞—á –¥–ª—è –¥–µ—Ç–µ–π –æ—Ç —Ä–æ–∂–¥–µ–Ω–∏—è –¥–æ 18 –ª–µ—Ç</li>
                                    <li><strong>–ö–∞—Ä–¥–∏–æ–ª–æ–≥:</strong> –°–ø–µ—Ü–∏–∞–ª–∏—Å—Ç –ø–æ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è–º —Å–µ—Ä–¥—Ü–∞</li>
                                    <li><strong>–ù–µ–≤—Ä–æ–ª–æ–≥:</strong> –õ–µ—á–∏—Ç –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è –Ω–µ—Ä–≤–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã</li>
                                    <li><strong>–û—Ñ—Ç–∞–ª—å–º–æ–ª–æ–≥:</strong> –°–ø–µ—Ü–∏–∞–ª–∏—Å—Ç –ø–æ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è–º –≥–ª–∞–∑</li>
                                    <li><strong>–°—Ç–æ–º–∞—Ç–æ–ª–æ–≥:</strong> –í—Ä–∞—á –ø–æ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è–º –∑—É–±–æ–≤ –∏ –ø–æ–ª–æ—Å—Ç–∏ —Ä—Ç–∞</li>
                                    <li><strong>–ü—Å–∏—Ö–∏–∞—Ç—Ä:</strong> –õ–µ—á–∏—Ç –ø—Å–∏—Ö–∏—á–µ—Å–∫–∏–µ —Ä–∞—Å—Å—Ç—Ä–æ–π—Å—Ç–≤–∞</li>
                                </ul>
                                
                                <h4><i class="fas fa-graduation-cap"></i> –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –≤—Ä–∞—á–∞–º</h4>
                                <ul>
                                    <li><strong>–û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ:</strong> 6 –ª–µ—Ç –≤ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–æ–º –≤—É–∑–µ + 2 –≥–æ–¥–∞ –æ—Ä–¥–∏–Ω–∞—Ç—É—Ä—ã</li>
                                    <li><strong>–õ–∏—á–Ω—ã–µ –∫–∞—á–µ—Å—Ç–≤–∞:</strong> –≠–º–ø–∞—Ç–∏—è, —Å—Ç—Ä–µ—Å—Å–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å, –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å</li>
                                    <li><strong>–ù–∞–≤—ã–∫–∏:</strong> –ö–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è, –∞–Ω–∞–ª–∏–∑, –ø—Ä–∏–Ω—è—Ç–∏–µ —Ä–µ—à–µ–Ω–∏–π</li>
                                    <li><strong>–ü–æ—Å—Ç–æ—è–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ:</strong> –ú–µ–¥–∏—Ü–∏–Ω–∞ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ —Ä–∞–∑–≤–∏–≤–∞–µ—Ç—Å—è</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    
                    <!-- –ü–æ—Å—Ç—É–ø–ª–µ–Ω–∏–µ –≤ –º–µ–¥–≤—É–∑ -->
                    <div class="learning-card" onclick="toggleLearningCard(this)">
                        <div class="learning-toggle">‚ñº</div>
                        <h3><i class="fas fa-university"></i> –ü–æ—Å—Ç—É–ø–ª–µ–Ω–∏–µ –≤ –º–µ–¥–≤—É–∑</h3>
                        <p>–ö–∞–∫ –ø–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å—Å—è –∫ —ç–∫–∑–∞–º–µ–Ω–∞–º, –≤—ã–±–æ—Ä –≤—É–∑–∞, –≤—Å—Ç—É–ø–∏—Ç–µ–ª—å–Ω—ã–µ –∏—Å–ø—ã—Ç–∞–Ω–∏—è</p>
                        
                        <div class="learning-details">
                            <div class="learning-content">
                                <h4><i class="fas fa-book"></i> –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ —ç–∫–∑–∞–º–µ–Ω–∞–º</h4>
                                <ul>
                                    <li><strong>–ë–∏–æ–ª–æ–≥–∏—è:</strong> –£–≥–ª—É–±–ª–µ–Ω–Ω–æ–µ –∏–∑—É—á–µ–Ω–∏–µ –∞–Ω–∞—Ç–æ–º–∏–∏, —Ñ–∏–∑–∏–æ–ª–æ–≥–∏–∏, –≥–µ–Ω–µ—Ç–∏–∫–∏</li>
                                    <li><strong>–•–∏–º–∏—è:</strong> –û—Ä–≥–∞–Ω–∏—á–µ—Å–∫–∞—è –∏ –Ω–µ–æ—Ä–≥–∞–Ω–∏—á–µ—Å–∫–∞—è —Ö–∏–º–∏—è, –±–∏–æ—Ö–∏–º–∏—è</li>
                                    <li><strong>–†—É—Å—Å–∫–∏–π —è–∑—ã–∫:</strong> –ì—Ä–∞–º–æ—Ç–Ω–æ–µ –ø–∏—Å—å–º–æ –≤–∞–∂–Ω–æ –¥–ª—è –º–µ–¥–∏—Ü–∏–Ω—Å–∫–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏</li>
                                    <li><strong>–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞/–§–∏–∑–∏–∫–∞:</strong> –í –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π –≤—É–∑–∞</li>
                                </ul>
                                
                                <h4><i class="fas fa-list-alt"></i> –í—Å—Ç—É–ø–∏—Ç–µ–ª—å–Ω—ã–µ –∏—Å–ø—ã—Ç–∞–Ω–∏—è</h4>
                                <ul>
                                    <li><strong>–ï–ì–≠:</strong> –û—Å–Ω–æ–≤–Ω–∞—è —Ñ–æ—Ä–º–∞ –≤—Å—Ç—É–ø–∏—Ç–µ–ª—å–Ω—ã—Ö —ç–∫–∑–∞–º–µ–Ω–æ–≤</li>
                                    <li><strong>–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∏—Å–ø—ã—Ç–∞–Ω–∏—è:</strong> –ù–µ–∫–æ—Ç–æ—Ä—ã–µ –≤—É–∑—ã –ø—Ä–æ–≤–æ–¥—è—Ç —Å–≤–æ–∏ —ç–∫–∑–∞–º–µ–Ω—ã</li>
                                    <li><strong>–ü–æ—Ä—Ç—Ñ–æ–ª–∏–æ:</strong> –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è –≤ –æ–ª–∏–º–ø–∏–∞–¥–∞—Ö, –≤–æ–ª–æ–Ω—Ç–µ—Ä—Å—Ç–≤–æ</li>
                                    <li><strong>–°–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏–µ:</strong> –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–æ—Ç–∏–≤–∞—Ü–∏–∏ –∏ –ª–∏—á–Ω—ã—Ö –∫–∞—á–µ—Å—Ç–≤</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    
                    <!-- –°–æ–≤–µ—Ç—ã –æ—Ç –≤—Ä–∞—á–µ–π -->
                    <div class="learning-card" onclick="toggleLearningCard(this)">
                        <div class="learning-toggle">‚ñº</div>
                        <h3><i class="fas fa-comments"></i> –°–æ–≤–µ—Ç—ã –æ—Ç –≤—Ä–∞—á–µ–π</h3>
                        <p>–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –æ—Ç –ø—Ä–∞–∫—Ç–∏–∫—É—é—â–∏—Ö –≤—Ä–∞—á–µ–π, —Ä–µ–∞–ª—å–Ω—ã–π –æ–ø—ã—Ç —Ä–∞–±–æ—Ç—ã –≤ –º–µ–¥–∏—Ü–∏–Ω–µ</p>
                        
                        <div class="learning-details">
                            <div class="learning-content">
                                <h4><i class="fas fa-lightbulb"></i> –°–æ–≤–µ—Ç—ã –±—É–¥—É—â–∏–º –º–µ–¥–∏–∫–∞–º</h4>
                                <ul>
                                    <li><strong>–ù–∞—á–∏–Ω–∞–π—Ç–µ –≥–æ—Ç–æ–≤–∏—Ç—å—Å—è –∑–∞—Ä–∞–Ω–µ–µ:</strong> –ú–µ–¥–∏—Ü–∏–Ω–∞ —Ç—Ä–µ–±—É–µ—Ç –≥–ª—É–±–æ–∫–∏—Ö –∑–Ω–∞–Ω–∏–π</li>
                                    <li><strong>–†–∞–∑–≤–∏–≤–∞–π—Ç–µ —ç–º–ø–∞—Ç–∏—é:</strong> –£–º–µ–Ω–∏–µ —Å–ª—É—à–∞—Ç—å –∏ –ø–æ–Ω–∏–º–∞—Ç—å –ø–∞—Ü–∏–µ–Ω—Ç–∞ - –∫–ª—é—á–µ–≤–æ–π –Ω–∞–≤—ã–∫</li>
                                    <li><strong>–£—á–∏—Ç–µ—Å—å —Ä–∞–±–æ—Ç–∞—Ç—å –≤ –∫–æ–º–∞–Ω–¥–µ:</strong> –ú–µ–¥–∏—Ü–∏–Ω–∞ - –∫–æ–ª–ª–µ–∫—Ç–∏–≤–Ω–∞—è —Ä–∞–±–æ—Ç–∞</li>
                                    <li><strong>–ë—É–¥—å—Ç–µ –≥–æ—Ç–æ–≤—ã –∫ –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ–º—É –æ–±—É—á–µ–Ω–∏—é:</strong> –ú–µ–¥–∏—Ü–∏–Ω–∞ –±—ã—Å—Ç—Ä–æ —Ä–∞–∑–≤–∏–≤–∞–µ—Ç—Å—è</li>
                                    <li><strong>–†–∞–∑–≤–∏–≤–∞–π—Ç–µ —Å—Ç—Ä–µ—Å—Å–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å:</strong> –†–∞–±–æ—Ç–∞ —Å –±–æ–ª–µ–∑–Ω—è–º–∏ –∏ —Å—Ç—Ä–∞–¥–∞–Ω–∏—è–º–∏ —Ç—Ä–µ–±—É–µ—Ç —Å–∏–ª—ã –¥—É—Ö–∞</li>
                                </ul>
                                
                                <h4><i class="fas fa-handshake"></i> –†–µ–∞–ª—å–Ω—ã–π –æ–ø—ã—Ç</h4>
                                <p>"–ú–µ–¥–∏—Ü–∏–Ω–∞ - —ç—Ç–æ –Ω–µ —Ç–æ–ª—å–∫–æ –∑–Ω–∞–Ω–∏—è, –Ω–æ –∏ –∏—Å–∫—É—Å—Å—Ç–≤–æ. –ö–∞–∂–¥—ã–π –ø–∞—Ü–∏–µ–Ω—Ç —É–Ω–∏–∫–∞–ª–µ–Ω, –∫–∞–∂–¥–∞—è —Å–∏—Ç—É–∞—Ü–∏—è —Ç—Ä–µ–±—É–µ—Ç –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞. –°–∞–º–æ–µ –≤–∞–∂–Ω–æ–µ - –ø–æ–º–Ω–∏—Ç—å, —á—Ç–æ –∑–∞ –∫–∞–∂–¥—ã–º –¥–∏–∞–≥–Ω–æ–∑–æ–º —Å—Ç–æ–∏—Ç —á–µ–ª–æ–≤–µ–∫ —Å–æ —Å–≤–æ–µ–π –∏—Å—Ç–æ—Ä–∏–µ–π, –Ω–∞–¥–µ–∂–¥–∞–º–∏ –∏ —Å—Ç—Ä–∞—Ö–∞–º–∏."</p>
                                <p>- –î–æ–∫—Ç–æ—Ä –ò–≤–∞–Ω–æ–≤–∞ –ê.–ù., —Ç–µ—Ä–∞–ø–µ–≤—Ç —Å 15-–ª–µ—Ç–Ω–∏–º —Å—Ç–∞–∂–µ–º</p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div style="margin-top: 40px; background: rgba(102, 126, 234, 0.1); padding: 25px; border-radius: 15px;">
                    <h3 style="color: #667eea;"><i class="fas fa-external-link-alt"></i> –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ —Ä–µ—Å—É—Ä—Å—ã</h3>
                    <ul style="margin-top: 15px; padding-left: 20px;">
                        <li style="margin-bottom: 10px;">Khan Academy - –±–µ—Å–ø–ª–∞—Ç–Ω—ã–µ –∫—É—Ä—Å—ã –ø–æ –±–∏–æ–ª–æ–≥–∏–∏ –∏ —Ö–∏–º–∏–∏</li>
                        <li style="margin-bottom: 10px;">Coursera - –æ–Ω–ª–∞–π–Ω-–∫—É—Ä—Å—ã –æ—Ç –≤–µ–¥—É—â–∏—Ö –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏—Ö –≤—É–∑–æ–≤</li>
                        <li style="margin-bottom: 10px;">–£—á–µ–±–Ω–∏–∫–∏ –ø–æ –∞–Ω–∞—Ç–æ–º–∏–∏ –∏ —Ñ–∏–∑–∏–æ–ª–æ–≥–∏–∏ —á–µ–ª–æ–≤–µ–∫–∞</li>
                        <li>–û—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–µ —Å–∞–π—Ç—ã –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏—Ö —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç–æ–≤ –£–∑–±–µ–∫–∏—Å—Ç–∞–Ω–∞</li>
                    </ul>
                </div>
            </div>
        </section>

        <!-- –ö–æ–Ω—Ç–∞–∫—Ç—ã -->
        <section id="contacts">
            <div class="card">
                <h2>üìû –ö–æ–Ω—Ç–∞–∫—Ç—ã –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∞</h2>
                <p style="margin-top: 10px;">–°–≤—è–∂–∏—Ç–µ—Å—å —Å –Ω–∞–º–∏ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏</p>
                
                <div class="contact-info">
                    <a href="https://t.me/MedBot_uzb_bot" target="_blank" style="text-decoration: none; width: 100%; max-width: 400px;">
                        <div class="contact-item">
                            <div class="contact-icon">ü§ñ</div>
                            <div class="contact-text">
                                <h4>Telegram –±–æ—Ç MedBot</h4>
                                <p>@MedBot_uzb_bot</p>
                                <p style="font-size: 0.8em; color: #999;">–ü–æ–º–æ—â—å –≤ –∏–∑—É—á–µ–Ω–∏–∏ –º–µ–¥–∏—Ü–∏–Ω—ã –∏ –ø—Ä–æ—Ñ–µ—Å—Å–∏–π –≤—Ä–∞—á–µ–π</p>
                            </div>
                        </div>
                    </a>
                    
                    <div class="contact-item" onclick="window.open('tel:+998906310013', '_self')">
                        <div class="contact-icon">üìû</div>
                        <div class="contact-text">
                            <h4>–¢–µ–ª–µ—Ñ–æ–Ω –ø–æ–¥–¥–µ—Ä–∂–∫–∏</h4>
                            <p>+998 90 631 00 13</p>
                            <p style="font-size: 0.8em; color: #999;">–ï–∂–µ–¥–Ω–µ–≤–Ω–æ —Å 9:00 –¥–æ 18:00</p>
                        </div>
                    </div>
                    
                    <div class="contact-item" onclick="window.location.href='mailto:support@medorient.uz'">
                        <div class="contact-icon">‚úâÔ∏è</div>
                        <div class="contact-text">
                            <h4>Email</h4>
                            <p>support@medorient.uz</p>
                            <p style="font-size: 0.8em; color: #999;">–û—Ç–≤–µ—Ç–∏–º –≤ —Ç–µ—á–µ–Ω–∏–µ 24 —á–∞—Å–æ–≤</p>
                        </div>
                    </div>
                    
                    <div class="contact-item" onclick="window.open('tel:+998906310013', '_self')">
                        <div class="contact-icon">üë®‚Äç‚öïÔ∏è</div>
                        <div class="contact-text">
                            <h4>–ö–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—è –ø—Å–∏—Ö–æ–ª–æ–≥–∞</h4>
                            <p>+998 90 631 00 13</p>
                            <p style="font-size: 0.8em; color: #999;">–ó–∞–ø–∏—Å—å –ø–æ –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ–π –¥–æ–≥–æ–≤–æ—Ä–µ–Ω–Ω–æ—Å—Ç–∏</p>
                        </div>
                    </div>
                </div>
                
                <div style="margin-top: 40px; text-align: center;">
                    <p>–ï—Å–ª–∏ —É –≤–∞—Å –µ—Å—Ç—å –≤–æ–ø—Ä–æ—Å—ã –∏–ª–∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –ø–æ —É–ª—É—á—à–µ–Ω–∏—é –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã, —Å–≤—è–∂–∏—Ç–µ—Å—å —Å –Ω–∞–º–∏ –ø–æ —É–∫–∞–∑–∞–Ω–Ω—ã–º –∫–æ–Ω—Ç–∞–∫—Ç–∞–º.</p>
                    <p style="margin-top: 10px; color: #667eea; font-weight: 600;">–ú—ã –≤—Å–µ–≥–¥–∞ —Ä–∞–¥—ã –ø–æ–º–æ—á—å –≤–∞–º –≤ –≤—ã–±–æ—Ä–µ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–æ–π –ø—Ä–æ—Ñ–µ—Å—Å–∏–∏!</p>
                </div>
            </div>
        </section>
    </div>

    <script>
        const DEBUG = (function () {
            try { return localStorage.getItem('debug') === '1'; } catch { return false; }
        })();
        try {
            if (!DEBUG && typeof console !== 'undefined' && console && typeof console.log === 'function') {
                console.log = function () { };
            }
        } catch {
            // ignore
        }

        console.log('=== SCRIPT START ===');
        
        // –ì–ª–æ–±–∞–ª—å–Ω—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –æ—à–∏–±–æ–∫
        window.onerror = function(msg, url, line, col, error) {
            console.error('GLOBAL ERROR:', msg, 'at line', line, error);
            return false;
        };

        console.log('1. Starting function definitions...');
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ö—Ä–∞–Ω–∏–ª–∏—â–∞
        const USERS_KEY = 'medical_users_v5';
        const CURRENT_USER_KEY = 'current_medical_user_v5';
        const AVATARS_KEY = 'medical_avatars_v1';
        
        // –û–¢–õ–ê–î–ö–ê: –°–æ–∑–¥–∞–µ–º —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–ª—è –≤—Ö–æ–¥–∞
        function createTestUser() {
            const testUser = {
                id: 1,
                name: "–¢–µ—Å—Ç –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å",
                email: "test@test.com",
                phone: "+7 900 000 0000", 
                age: 18,
                password: "123456",
                registrationDate: new Date().toISOString().split('T')[0],
                testsCompleted: 0,
                totalScore: 0,
                level: 1,
                achievements: [],
                testHistory: []
            };
            
            let users = [];
            if (localStorage.getItem(USERS_KEY)) {
                users = JSON.parse(localStorage.getItem(USERS_KEY));
            }
            
            // –ü—Ä–æ–≤–µ—Ä–∏–º, –µ—Å—Ç—å –ª–∏ —É–∂–µ —Ç–µ—Å—Ç–æ–≤—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
            if (!users.find(u => u.email === "test@test.com")) {
                users.push(testUser);
                localStorage.setItem(USERS_KEY, JSON.stringify(users));
                console.log('Test user created: test@test.com / 123456');
            }
        }

        function isLocalhost() {
            try {
                const h = String(location && location.hostname ? location.hostname : '').toLowerCase();
                return h === 'localhost' || h === '127.0.0.1' || h === '::1';
            } catch {
                return false;
            }
        }

        // –î–ª—è —É–¥–æ–±—Å—Ç–≤–∞ –Ω–∞ –ª–æ–∫–∞–ª–∫–µ —Å–æ–∑–¥–∞—ë–º –¥–µ–º–æ-–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –µ—Å–ª–∏ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –ø—É—Å—Ç–æ–µ.
        try {
            const hasUsers = !!localStorage.getItem(USERS_KEY);
            if (DEBUG || (isLocalhost() && !hasUsers)) createTestUser();
        } catch {
            // ignore
        }
        
        let verificationCode = '';
        let currentTestType = '';
        let currentQuestionIndex = 0;
        let testAnswers = {};
        let markedQuestions = {};
        let userTestResults = {};
        let currentTestQuestions = []; // –ú–∞—Å—Å–∏–≤ –¥–ª—è —Ç–µ–∫—É—â–∏—Ö –ø–µ—Ä–µ–º–µ—à–∞–Ω–Ω—ã—Ö –≤–æ–ø—Ä–æ—Å–æ–≤

        // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –º–µ–∂–¥—É –≤–∫–ª–∞–¥–∫–∞–º–∏
        function switchTab(tab) {
            console.log('switchTab called with:', tab);
            document.querySelectorAll('.auth-page').forEach(page => {
                page.classList.remove('active');
            });
            
            document.querySelectorAll('.auth-tab').forEach(tabElement => {
                tabElement.classList.remove('active');
            });
            
            if (tab === 'login') {
                document.getElementById('login-page').classList.add('active');
                document.querySelector('.auth-tab:nth-child(1)').classList.add('active');
            } else if (tab === 'register') {
                document.getElementById('register-page').classList.add('active');
                document.querySelector('.auth-tab:nth-child(2)').classList.add('active');
            } else if (tab === 'verify') {
                document.getElementById('verification-page').classList.add('active');
            }
        }

        // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –∫–æ–¥–æ–º –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è (—É–ø—Ä–æ—â–µ–Ω–Ω—ã–µ)
        function moveToNext(current, nextIndex) {
            if (current.value.length >= current.maxLength) {
                const inputs = document.querySelectorAll('.code-inputs input');
                if (nextIndex >= 0 && nextIndex < inputs.length) {
                    inputs[nextIndex].focus();
                }
            }
        }

        function moveOnBackspace(input, prevIndex) {
            if (input.value.length === 0 && event.key === 'Backspace') {
                const inputs = document.querySelectorAll('.code-inputs input');
                if (prevIndex >= 0) {
                    inputs[prevIndex].focus();
                }
            }
        }
        
        // –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è - –£–ü–†–û–©–ï–ù–ù–ê–Ø –ë–ï–ó –í–ï–†–ò–§–ò–ö–ê–¶–ò–ò
        function handleRegistration(event) {
            event.preventDefault();
            
            const username = document.getElementById('reg-username').value.trim();
            const email = document.getElementById('reg-email').value.trim().toLowerCase(); // –ü—Ä–∏–≤–æ–¥–∏–º –∫ –Ω–∏–∂–Ω–µ–º—É —Ä–µ–≥–∏—Å—Ç—Ä—É
            const phone = document.getElementById('reg-phone').value.trim();
            const age = document.getElementById('reg-age').value;
            const password = document.getElementById('reg-password').value;
            const confirmPassword = document.getElementById('reg-confirm-password').value;
            
            // –í–∞–ª–∏–¥–∞—Ü–∏—è
            if (password !== confirmPassword) {
                alert('–ü–∞—Ä–æ–ª–∏ –Ω–µ —Å–æ–≤–ø–∞–¥–∞—é—Ç!');
                return;
            }
            
            if (password.length < 6) {
                alert('–ü–∞—Ä–æ–ª—å –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å –º–∏–Ω–∏–º—É–º 6 —Å–∏–º–≤–æ–ª–æ–≤!');
                return;
            }
            
            if (age < 14 || age > 99) {
                alert('–í–æ–∑—Ä–∞—Å—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –æ—Ç 14 –¥–æ 99 –ª–µ—Ç!');
                return;
            }
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ email
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (!emailRegex.test(email)) {
                alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π email!');
                return;
            }
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–æ–º–µ—Ä–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–∞
            const phoneRegex = /^\+?[0-9\s\-\(\)]+$/;
            if (!phoneRegex.test(phone)) {
                alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞!');
                return;
            }
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å —Ç–∞–∫–∏–º email
            try {
                if (localStorage.getItem(USERS_KEY)) {
                    const users = JSON.parse(localStorage.getItem(USERS_KEY));
                    const existingUser = users.find(user => user.email.toLowerCase() === email);
                    if (existingUser) {
                        alert('–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å —Ç–∞–∫–∏–º email —É–∂–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω!');
                        return;
                    }
                }
            } catch (e) {
                alert('–•—Ä–∞–Ω–∏–ª–∏—â–µ –±—Ä–∞—É–∑–µ—Ä–∞ (localStorage) –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ. –û—Ç–∫—Ä–æ–π—Ç–µ —Å–∞–π—Ç –≤ –æ–±—ã—á–Ω–æ–º –±—Ä–∞—É–∑–µ—Ä–µ (Chrome/Edge) –∏ –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞.');
                return;
            }
            
            // –°—Ä–∞–∑—É –∑–∞–≤–µ—Ä—à–∞–µ–º —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é –±–µ–∑ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏
            window.tempUserData = {
                username,
                email,
                phone,
                age: parseInt(age),
                password
            };
            
            completeRegistration();
        }

        // –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ (—É–ø—Ä–æ—â–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è –±–µ–∑ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏)
        function completeRegistration() {
            const userData = window.tempUserData;

            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ localStorage
            try {
                localStorage.setItem('__mo_ls_probe', '1');
                localStorage.removeItem('__mo_ls_probe');
            } catch {
                alert('–•—Ä–∞–Ω–∏–ª–∏—â–µ –±—Ä–∞—É–∑–µ—Ä–∞ (localStorage) –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ. –û—Ç–∫—Ä–æ–π—Ç–µ —Å–∞–π—Ç –≤ –æ–±—ã—á–Ω–æ–º –±—Ä–∞—É–∑–µ—Ä–µ (Chrome/Edge) –∏ –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞.');
                return;
            }
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º —Ö—Ä–∞–Ω–∏–ª–∏—â–µ
            if (!localStorage.getItem(USERS_KEY)) {
                localStorage.setItem(USERS_KEY, JSON.stringify([]));
            }

            const users = JSON.parse(localStorage.getItem(USERS_KEY));
            
            // –°–æ–∑–¥–∞–µ–º –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            const newUser = {
                id: Date.now(),
                name: userData.username,
                email: userData.email,
                phone: userData.phone,
                age: userData.age,
                password: userData.password,
                registrationDate: new Date().toISOString().split('T')[0],
                testsCompleted: 0,
                totalScore: 0,
                level: 1,
                achievements: [],
                testHistory: []
            };

            // –î–æ–±–∞–≤–ª—è–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ —Å–ø–∏—Å–æ–∫
            users.push(newUser);
            localStorage.setItem(USERS_KEY, JSON.stringify(users));

            // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            localStorage.setItem(CURRENT_USER_KEY, JSON.stringify(newUser));
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É—Å–ø–µ—à–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
            alert('üéâ –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∞! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ —Å–∏—Å—Ç–µ–º—É –º–µ–¥–∏—Ü–∏–Ω—Å–∫–æ–π –ø—Ä–æ—Ñ–æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏–∏!');
            
            // –ü–µ—Ä–µ—Ö–æ–¥–∏–º –∫ –æ—Å–Ω–æ–≤–Ω–æ–º—É –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—é —á–µ—Ä–µ–∑ –µ–¥–∏–Ω—ã–π –ø–æ—Ç–æ–∫
            showMainContent(newUser);
            
            // –û—á–∏—â–∞–µ–º –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
            window.tempUserData = null;
        }
        
        // –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        function getCurrentUser() {
            try {
                const userJson = localStorage.getItem(CURRENT_USER_KEY);
                return userJson ? JSON.parse(userJson) : null;
            } catch (e) {
                console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:', e);
                return null;
            }
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –ø–æ—Å–ª–µ –≤—Ö–æ–¥–∞/—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
        function updateUserInterface() {
            const currentUser = getCurrentUser();
            if (!currentUser) return;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –ø—Ä–æ—Ñ–∏–ª—è
            document.getElementById('profile-name').textContent = currentUser.name;
            document.getElementById('profile-email-text').textContent = currentUser.email;
            document.getElementById('profile-phone-text').textContent = currentUser.phone;
            document.getElementById('profile-age-text').textContent = `${currentUser.age} –ª–µ—Ç`;
            document.getElementById('profile-reg-date').textContent = new Date(currentUser.registrationDate).toLocaleDateString();
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
            updateUserStats(currentUser);
        }

        // –ü–æ–≤—Ç–æ—Ä–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ –∫–æ–¥–∞ (–æ—Ç–∫–ª—é—á–µ–Ω–∞)
        function resendCode() {
            alert('–í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è –æ—Ç–∫–ª—é—á–µ–Ω–∞ –¥–ª—è —É–ø—Ä–æ—â–µ–Ω–∏—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏');
        }

        // –í—Ö–æ–¥
        function handleLogin(event) {
            console.log('handleLogin called');
            event.preventDefault();
            
            const email = document.getElementById('login-email').value.trim().toLowerCase();
            const password = document.getElementById('login-password').value;
            
            console.log('Email:', email, 'Password:', password);
            
            let usersJson = '';
            try {
                usersJson = localStorage.getItem(USERS_KEY) || '';
            } catch {
                alert('–•—Ä–∞–Ω–∏–ª–∏—â–µ –±—Ä–∞—É–∑–µ—Ä–∞ (localStorage) –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ. –û—Ç–∫—Ä–æ–π—Ç–µ —Å–∞–π—Ç –≤ –æ–±—ã—á–Ω–æ–º –±—Ä–∞—É–∑–µ—Ä–µ (Chrome/Edge) –∏ –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞.');
                return;
            }

            if (!usersJson) {
                console.log('No users found in localStorage');
                alert('–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω! –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å —Å–Ω–∞—á–∞–ª–∞.');
                return;
            }

            let users = [];
            try {
                users = JSON.parse(usersJson);
            } catch {
                users = [];
            }
            console.log('Users in storage:', users);
            const user = users.find(u => u.email.toLowerCase() === email && u.password === password);
            
            if (user) {
                console.log('User found:', user);
                localStorage.setItem(CURRENT_USER_KEY, JSON.stringify(user));
                showMainContent(user);
            } else {
                console.log('User not found or wrong credentials');
                alert('–ù–µ–≤–µ—Ä–Ω—ã–π email –∏–ª–∏ –ø–∞—Ä–æ–ª—å!');
            }
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å –æ—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç
        function showMainContent(user) {
            console.log('showMainContent called with user:', user);
            
            // –ü—Ä—è–º–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ display –≤–º–µ—Å—Ç–æ –∫–ª–∞—Å—Å–æ–≤
            document.getElementById('auth-container').style.display = 'none';
            document.getElementById('main-content').style.display = 'block';
            
            console.log('Auth container hidden, main content visible');
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ç–µ—Å—Ç–æ–≤
            try {
                initializeTests();
                console.log('Tests initialized successfully');
            } catch (e) {
                console.error('Error initializing tests:', e);
            }
            
            // –ó–∞–≥—Ä—É–∑–∫–∞ –∞–≤–∞—Ç–∞—Ä–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            loadUserAvatar(user.id);
            
            // –ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–æ—Ñ–∏–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            loadUserProfile();

            // –û–±–Ω–æ–≤–ª—è–µ–º ¬´—Ä–µ–∞–ª—å–Ω—É—é¬ª —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –≥–ª–∞–≤–Ω–æ–≥–æ —ç–∫—Ä–∞–Ω–∞
            updatePlatformStats();
        }

        function updatePlatformStats() {
            const totalUsersEl = document.getElementById('total-users-count');
            const totalUsersGlobalEl = document.getElementById('total-users-global-count');
            const totalTestsEl = document.getElementById('total-tests-count');
            const totalTypesEl = document.getElementById('total-test-types-count');
            const totalQuestionsEl = document.getElementById('total-questions-count');

            if (!totalUsersEl && !totalUsersGlobalEl && !totalTestsEl && !totalTypesEl && !totalQuestionsEl) return;

            // –ì–ª–æ–±–∞–ª—å–Ω—ã–π —Å—á—ë—Ç—á–∏–∫ (–≤—Å–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞) ‚Äî —Ç—Ä–µ–±—É–µ—Ç Cloudflare Pages Functions + KV.
            try {
                if (totalUsersGlobalEl && !window.__globalUsersCountFetchInFlight) {
                    const VISITOR_ID_KEY = 'mo_visitor_id_v1';
                    let visitorId = '';
                    try {
                        visitorId = String(localStorage.getItem(VISITOR_ID_KEY) || '');
                    } catch {
                        visitorId = '';
                    }

                    if (!visitorId) {
                        if (window.crypto && typeof window.crypto.randomUUID === 'function') {
                            visitorId = window.crypto.randomUUID();
                        } else {
                            visitorId = 'v_' + Math.random().toString(16).slice(2) + Date.now().toString(16);
                        }
                        try {
                            localStorage.setItem(VISITOR_ID_KEY, visitorId);
                        } catch {
                            // ignore
                        }
                    }

                    totalUsersGlobalEl.textContent = '‚Ä¶';
                    window.__globalUsersCountFetchInFlight = true;

                    fetch(`/api/visitors?id=${encodeURIComponent(visitorId)}`, { cache: 'no-store' })
                        .then(async (r) => {
                            let data = null;
                            try {
                                data = await r.json();
                            } catch {
                                data = null;
                            }
                            return { ok: r.ok, status: r.status, data };
                        })
                        .then(({ ok, status, data }) => {
                            if (data && data.ok && typeof data.totalUsers === 'number') {
                                totalUsersGlobalEl.textContent = data.totalUsers.toLocaleString('ru-RU');
                                return;
                            }
                            // –ï—Å–ª–∏ KV –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –≤ Cloudflare Pages ‚Äî –ø–æ–∫–∞–∂–µ–º –ø–æ–Ω—è—Ç–Ω—É—é –ø–æ–¥—Å–∫–∞–∑–∫—É
                            const err = data && typeof data.error === 'string' ? data.error : '';
                            if (!ok && (status === 501 || /not configured/i.test(err))) {
                                totalUsersGlobalEl.textContent = '–ù—É–∂–Ω–æ KV';
                                return;
                            }
                            totalUsersGlobalEl.textContent = '‚Äî';
                        })
                        .catch(() => {
                            totalUsersGlobalEl.textContent = '‚Äî';
                        })
                        .finally(() => {
                            window.__globalUsersCountFetchInFlight = false;
                        });
                }
            } catch {
                if (totalUsersGlobalEl) totalUsersGlobalEl.textContent = '‚Äî';
            }

            let users = [];
            try {
                users = JSON.parse(localStorage.getItem(USERS_KEY) || '[]');
                if (!Array.isArray(users)) users = [];
            } catch {
                users = [];
            }

            const totalUsers = users.length;
            let totalTestsCompleted = 0;
            for (const user of users) {
                const testResults = user?.testResults && typeof user.testResults === 'object' ? user.testResults : {};
                totalTestsCompleted += Object.keys(testResults).length;
            }

            // –¢–∏–ø–æ–≤ —Ç–µ—Å—Ç–æ–≤ –Ω–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ (–∫–∞—Ç–µ–≥–æ—Ä–∏–∏)
            const totalTestTypes = 4;

            // –í–æ–ø—Ä–æ—Å–æ–≤ –≤ –±–∞–∑–µ ‚Äî —Å—á–∏—Ç–∞–µ–º —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –ø–æ id, –µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω–∞ –±–∞–∑–∞
            let totalQuestions = 0;
            try {
                // –ü—Ä–µ–¥–ø–æ—á—Ç–∏—Ç–µ–ª—å–Ω–æ: –∑–∞—Ä–∞–Ω–µ–µ —Ä–∞—Å—Å—á–∏—Ç–∞–Ω–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ (–Ω–µ —Ç—Ä–µ–±—É–µ—Ç –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –±–∞–Ω–∫–∞)
                if (window.__questionCountsByTestId && typeof window.__questionCountsByTestId === 'object') {
                    totalQuestions = Object.values(window.__questionCountsByTestId)
                        .filter(v => typeof v === 'number' && Number.isFinite(v))
                        .reduce((sum, v) => sum + v, 0);
                } else {
                const db = (typeof questionDatabase !== 'undefined' && questionDatabase) ? questionDatabase : (window.fullTestQuestions || null);
                if (db && typeof db === 'object') {
                    const ids = new Set();
                    let raw = 0;
                    Object.values(db).forEach((val) => {
                        if (Array.isArray(val)) {
                            val.forEach((q) => {
                                raw += 1;
                                if (q && q.id) ids.add(String(q.id));
                            });
                        }
                    });
                    totalQuestions = ids.size > 0 ? ids.size : raw;
                }
                }
            } catch {
                totalQuestions = 0;
            }

            if (totalUsersEl) totalUsersEl.textContent = totalUsers.toLocaleString('ru-RU');
            if (totalTestsEl) totalTestsEl.textContent = totalTestsCompleted.toLocaleString('ru-RU');
            if (totalTypesEl) totalTypesEl.textContent = totalTestTypes.toLocaleString('ru-RU');
            if (totalQuestionsEl) totalQuestionsEl.textContent = totalQuestions ? totalQuestions.toLocaleString('ru-RU') : '‚Äî';
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –∞–≤–∞—Ç–∞—Ä–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        function loadUserAvatar(userId) {
            const avatars = JSON.parse(localStorage.getItem(AVATARS_KEY)) || {};
            const avatar = avatars[userId];
            
            const avatarImage = document.getElementById('avatar-image');
            const avatarPlaceholder = document.getElementById('avatar-placeholder');
            
            if (avatar) {
                avatarImage.src = avatar;
                avatarImage.style.display = 'block';
                avatarPlaceholder.style.display = 'none';
                
                // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∏–Ω–∏—Ü–∏–∞–ª—ã –≤ –∞—Ç—Ä–∏–±—É—Ç alt
                const currentUser = JSON.parse(localStorage.getItem(CURRENT_USER_KEY));
                if (currentUser && currentUser.username) {
                    const initials = getInitials(currentUser.username);
                    avatarImage.alt = `–ê–≤–∞—Ç–∞—Ä ${currentUser.username} (${initials})`;
                }
            } else {
                avatarImage.style.display = 'none';
                avatarPlaceholder.style.display = 'flex';
                
                // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∏–Ω–∏—Ü–∏–∞–ª—ã –≤ placeholder
                const currentUser = JSON.parse(localStorage.getItem(CURRENT_USER_KEY));
                if (currentUser && currentUser.username) {
                    const initials = getInitials(currentUser.username);
                    avatarPlaceholder.textContent = initials;
                }
            }
        }

        // –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω–∏—Ü–∏–∞–ª–æ–≤ –∏–∑ –∏–º–µ–Ω–∏
        function getInitials(username) {
            return username.split(' ').map(name => name[0]).join('').toUpperCase().substring(0, 2);
        }

        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∞–≤–∞—Ç–∞—Ä–∞
        function handleAvatarUpload(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ç–∏–ø —Ñ–∞–π–ª–∞
            if (!file.type.match('image.*')) {
                alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ!');
                return;
            }
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞ (–º–∞–∫—Å–∏–º—É–º 5MB)
            if (file.size > 5 * 1024 * 1024) {
                alert('–†–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞ –Ω–µ –¥–æ–ª–∂–µ–Ω –ø—Ä–µ–≤—ã—à–∞—Ç—å 5MB!');
                return;
            }
            
            const reader = new FileReader();
            
            reader.onload = function(e) {
                const currentUser = JSON.parse(localStorage.getItem(CURRENT_USER_KEY));
                if (!currentUser) return;
                
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∞–≤–∞—Ç–∞—Ä
                const avatars = JSON.parse(localStorage.getItem(AVATARS_KEY)) || {};
                avatars[currentUser.id] = e.target.result;
                localStorage.setItem(AVATARS_KEY, JSON.stringify(avatars));
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ
                loadUserAvatar(currentUser.id);
                
                alert('–ê–≤–∞—Ç–∞—Ä —É—Å–ø–µ—à–Ω–æ –æ–±–Ω–æ–≤–ª–µ–Ω!');
            };
            
            reader.readAsDataURL(file);
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–æ—Ñ–∏–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        function loadUserProfile() {
            const currentUser = JSON.parse(localStorage.getItem(CURRENT_USER_KEY));
            if (!currentUser) return;
            
            // –û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
            document.getElementById('profile-name').textContent = currentUser.username;
            document.getElementById('profile-email-text').textContent = currentUser.email;
            document.getElementById('profile-phone-text').textContent = currentUser.phone;
            document.getElementById('profile-age-text').textContent = `${currentUser.age} –ª–µ—Ç`;
            
            // –î–∞—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
            const regDate = new Date(currentUser.registrationDate);
            document.getElementById('profile-reg-date').textContent = regDate.toLocaleDateString('ru-RU', {
                day: 'numeric',
                month: 'long',
                year: 'numeric'
            });
            
            // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –∏–∑ –ø—Ä–æ—Ñ–∏–ª—è (—ç–ª–µ–º–µ–Ω—Ç—ã –º–æ–≥—É—Ç –±—ã—Ç—å —Å–∫—Ä—ã—Ç—ã/—É–¥–∞–ª–µ–Ω—ã –∏–∑ UI)
            if (currentUser.profile) {
                const educationEl = document.getElementById('education-info');
                if (educationEl) educationEl.textContent = currentUser.profile.education || "–ù–µ —É–∫–∞–∑–∞–Ω–æ";

                const locationEl = document.getElementById('location-info');
                if (locationEl) locationEl.textContent = currentUser.profile.location || "–ù–µ —É–∫–∞–∑–∞–Ω–æ";

                const interestsEl = document.getElementById('interests-info');
                if (interestsEl) interestsEl.textContent = currentUser.profile.interests || "–ù–µ —É–∫–∞–∑–∞–Ω—ã";
            }
            
            // –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
            updateUserStats(currentUser);
            
            // –ò—Å—Ç–æ—Ä–∏—è —Ç–µ—Å—Ç–æ–≤
            loadTestHistory(currentUser);
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        function updateUserStats(user) {
            const testResults = user.testResults || {};
            const testKeys = Object.keys(testResults);
            
            // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–π–¥–µ–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤
            document.getElementById('tests-completed').textContent = testKeys.length;
            
            // –°—Ä–µ–¥–Ω–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç
            let totalScore = 0;
            let bestScore = 0;
            
            testKeys.forEach(testKey => {
                const test = testResults[testKey];
                if (test && test.score !== undefined && test.maxScore !== undefined) {
                    const percentage = Math.round((test.score / test.maxScore) * 100);
                    totalScore += percentage;
                    bestScore = Math.max(bestScore, percentage);
                }
            });
            
            const averageScore = testKeys.length > 0 ? Math.round(totalScore / testKeys.length) : 0;
            document.getElementById('average-score').textContent = `${averageScore}%`;
            document.getElementById('best-score').textContent = `${bestScore}%`;
            
            // –î–Ω–µ–π —Å —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
            const regDate = new Date(user.registrationDate);
            const today = new Date();
            const diffTime = Math.abs(today - regDate);
            const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
            document.getElementById('days-registered').textContent = diffDays;
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –∏—Å—Ç–æ—Ä–∏–∏ —Ç–µ—Å—Ç–æ–≤
        function loadTestHistory(user) {
            const testResults = user.testResults || {};
            const testKeys = Object.keys(testResults);
            const container = document.getElementById('tests-history-container');
            
            if (testKeys.length === 0) {
                container.innerHTML = '<p style="text-align: center; color: #999; padding: 20px;">–¢–µ—Å—Ç—ã –µ—â–µ –Ω–µ –ø—Ä–æ–π–¥–µ–Ω—ã</p>';
                return;
            }
            
            let html = '';
            
            // –°–æ—Ä—Ç–∏—Ä—É–µ–º —Ç–µ—Å—Ç—ã –ø–æ –¥–∞—Ç–µ (–Ω–æ–≤—ã–µ –ø–µ—Ä–≤—ã–µ)
            const sortedTests = testKeys
                .map(key => ({
                    key,
                    ...testResults[key]
                }))
                .sort((a, b) => new Date(b.date) - new Date(a.date));
            
            sortedTests.forEach(test => {
                const testName = getTestName(test.key);
                const percentage = Math.round((test.score / test.maxScore) * 100);
                const date = new Date(test.date).toLocaleDateString('ru-RU');
                
                html += `
                    <div class="history-item">
                        <div>
                            <div class="test-name">${testName}</div>
                            <div class="test-date">${date}</div>
                        </div>
                        <div class="test-score">${percentage}%</div>
                    </div>
                `;
            });
            
            container.innerHTML = html;
        }

        // –ü–æ–ª—É—á–µ–Ω–∏–µ –Ω–∞–∑–≤–∞–Ω–∏—è —Ç–µ—Å—Ç–∞ –ø–æ –∫–ª—é—á—É
        function getTestName(testKey) {
            const testNames = {
                'profession': '–ü—Ä–æ—Ñ–æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏—è',
                'chemistry': '–•–∏–º–∏—è',
                'biology': '–ë–∏–æ–ª–æ–≥–∏—è',

                // –ü—Ä–æ—Ñ–æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏—è (–æ–±—â–∞—è)
                'profession_general_1': '–ü—Ä–æ—Ñ–æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏—è (1‚Äì4 –∫–ª–∞—Å—Å)',
                'profession_general_5': '–ü—Ä–æ—Ñ–æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏—è (5‚Äì6 –∫–ª–∞—Å—Å)',
                'profession_general_7': '–ü—Ä–æ—Ñ–æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏—è (7‚Äì8 –∫–ª–∞—Å—Å)',
                'profession_general_9': '–ü—Ä–æ—Ñ–æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏—è (9 –∫–ª–∞—Å—Å)',
                'profession_general_10': '–ü—Ä–æ—Ñ–æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏—è (10‚Äì11 –∫–ª–∞—Å—Å)',

                // –ü—Ä–æ—Ñ–æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏—è (–º–µ–¥–∏—Ü–∏–Ω–∞)
                'profession_med_1': '–ú–µ–¥–∏—Ü–∏–Ω—Å–∫–∞—è –ø—Ä–æ—Ñ–æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏—è (1‚Äì4 –∫–ª–∞—Å—Å)',
                'profession_med_5': '–ú–µ–¥–∏—Ü–∏–Ω—Å–∫–∞—è –ø—Ä–æ—Ñ–æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏—è (5‚Äì6 –∫–ª–∞—Å—Å)',
                'profession_med_7': '–ú–µ–¥–∏—Ü–∏–Ω—Å–∫–∞—è –ø—Ä–æ—Ñ–æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏—è (7‚Äì8 –∫–ª–∞—Å—Å)',
                'profession_med_9': '–ú–µ–¥–∏—Ü–∏–Ω—Å–∫–∞—è –ø—Ä–æ—Ñ–æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏—è (9 –∫–ª–∞—Å—Å)',
                'profession_med_10': '–ú–µ–¥–∏—Ü–∏–Ω—Å–∫–∞—è –ø—Ä–æ—Ñ–æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏—è (10‚Äì11 –∫–ª–∞—Å—Å)',

                // –ë–∏–æ–ª–æ–≥–∏—è
                'biology_1': '–ë–∏–æ–ª–æ–≥–∏—è (1‚Äì4 –∫–ª–∞—Å—Å)',
                'biology_5': '–ë–∏–æ–ª–æ–≥–∏—è (5‚Äì6 –∫–ª–∞—Å—Å)',
                'biology_7': '–ë–∏–æ–ª–æ–≥–∏—è (7‚Äì8 –∫–ª–∞—Å—Å)',
                'biology_9': '–ë–∏–æ–ª–æ–≥–∏—è (9 –∫–ª–∞—Å—Å)',
                'biology_10': '–ë–∏–æ–ª–æ–≥–∏—è (10‚Äì11 –∫–ª–∞—Å—Å)',

                // –•–∏–º–∏—è
                'chemistry_1': '–•–∏–º–∏—è (1‚Äì4 –∫–ª–∞—Å—Å)',
                'chemistry_5': '–•–∏–º–∏—è (5‚Äì6 –∫–ª–∞—Å—Å)',
                'chemistry_7': '–•–∏–º–∏—è (7‚Äì8 –∫–ª–∞—Å—Å)',
                'chemistry_9': '–•–∏–º–∏—è (9 –∫–ª–∞—Å—Å)',
                'chemistry_10': '–•–∏–º–∏—è (10‚Äì11 –∫–ª–∞—Å—Å)'
            };
            
            return testNames[testKey] || testKey;
        }

        // –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è
        function editEducation() {
            const currentUser = JSON.parse(localStorage.getItem(CURRENT_USER_KEY));
            const currentEducation = currentUser.profile?.education || "";
            
            const newEducation = prompt('–í–≤–µ–¥–∏—Ç–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–∏:', currentEducation);
            if (newEducation !== null) {
                // –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–æ—Ñ–∏–ª—å
                if (!currentUser.profile) currentUser.profile = {};
                currentUser.profile.education = newEducation.trim();
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –≤ localStorage
                localStorage.setItem(CURRENT_USER_KEY, JSON.stringify(currentUser));
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –≤ –æ–±—â–µ–º —Å–ø–∏—Å–∫–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
                const users = JSON.parse(localStorage.getItem(USERS_KEY));
                const userIndex = users.findIndex(u => u.id === currentUser.id);
                if (userIndex !== -1) {
                    users[userIndex] = currentUser;
                    localStorage.setItem(USERS_KEY, JSON.stringify(users));
                }
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ (–µ—Å–ª–∏ –±–ª–æ–∫ –µ—Å—Ç—å –≤ UI)
                const educationEl = document.getElementById('education-info');
                if (educationEl) educationEl.textContent = newEducation.trim() || "–ù–µ —É–∫–∞–∑–∞–Ω–æ";
                alert('–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∞!');
            }
        }

        // –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏—è
        function editLocation() {
            const currentUser = JSON.parse(localStorage.getItem(CURRENT_USER_KEY));
            const currentLocation = currentUser.profile?.location || "";
            
            const newLocation = prompt('–í–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ (–≥–æ—Ä–æ–¥, —Ä–µ–≥–∏–æ–Ω):', currentLocation);
            if (newLocation !== null) {
                // –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–æ—Ñ–∏–ª—å
                if (!currentUser.profile) currentUser.profile = {};
                currentUser.profile.location = newLocation.trim();
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –≤ localStorage
                localStorage.setItem(CURRENT_USER_KEY, JSON.stringify(currentUser));
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –≤ –æ–±—â–µ–º —Å–ø–∏—Å–∫–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
                const users = JSON.parse(localStorage.getItem(USERS_KEY));
                const userIndex = users.findIndex(u => u.id === currentUser.id);
                if (userIndex !== -1) {
                    users[userIndex] = currentUser;
                    localStorage.setItem(USERS_KEY, JSON.stringify(users));
                }
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ (–µ—Å–ª–∏ –±–ª–æ–∫ –µ—Å—Ç—å –≤ UI)
                const locationEl = document.getElementById('location-info');
                if (locationEl) locationEl.textContent = newLocation.trim() || "–ù–µ —É–∫–∞–∑–∞–Ω–æ";
                alert('–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–æ!');
            }
        }

        // –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–Ω—Ç–µ—Ä–µ—Å–æ–≤
        function editInterests() {
            const currentUser = JSON.parse(localStorage.getItem(CURRENT_USER_KEY));
            const currentInterests = currentUser.profile?.interests || "";
            
            const newInterests = prompt('–í–≤–µ–¥–∏—Ç–µ –≤–∞—à–∏ –∏–Ω—Ç–µ—Ä–µ—Å—ã (—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é):', currentInterests);
            if (newInterests !== null) {
                // –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–æ—Ñ–∏–ª—å
                if (!currentUser.profile) currentUser.profile = {};
                currentUser.profile.interests = newInterests.trim();
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –≤ localStorage
                localStorage.setItem(CURRENT_USER_KEY, JSON.stringify(currentUser));
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –≤ –æ–±—â–µ–º —Å–ø–∏—Å–∫–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
                const users = JSON.parse(localStorage.getItem(USERS_KEY));
                const userIndex = users.findIndex(u => u.id === currentUser.id);
                if (userIndex !== -1) {
                    users[userIndex] = currentUser;
                    localStorage.setItem(USERS_KEY, JSON.stringify(users));
                }
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ (–µ—Å–ª–∏ –±–ª–æ–∫ –µ—Å—Ç—å –≤ UI)
                const interestsEl = document.getElementById('interests-info');
                if (interestsEl) interestsEl.textContent = newInterests.trim() || "–ù–µ —É–∫–∞–∑–∞–Ω—ã";
                alert('–ò–Ω—Ç–µ—Ä–µ—Å—ã –æ–±–Ω–æ–≤–ª–µ–Ω—ã!');
            }
        }
        
        // –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ü–µ–ª–∏
        function editGoal() {
            const currentUser = JSON.parse(localStorage.getItem(CURRENT_USER_KEY));
            const currentGoal = currentUser.profile?.goal || "";
            
            const goals = [
                "1 - –ü–æ—Å—Ç—É–ø–ª–µ–Ω–∏–µ –≤ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–π –≤—É–∑",
                "2 - –í—ã–±–æ—Ä –º–µ–¥–∏—Ü–∏–Ω—Å–∫–æ–π —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏",
                "3 - –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ –ï–ì–≠",
                "4 - –û–±—â–µ–µ —Ä–∞–∑–≤–∏—Ç–∏–µ –≤ –º–µ–¥–∏—Ü–∏–Ω–µ",
                "5 - –ö–∞—Ä—å–µ—Ä–Ω–∞—è –ø–µ—Ä–µ–æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏—è"
            ];
            
            const goalChoice = prompt(`–í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—à—É —Ü–µ–ª—å:\n${goals.join('\n')}\n\n–í–≤–µ–¥–∏—Ç–µ –Ω–æ–º–µ—Ä –∏–ª–∏ —Å–≤–æ—é —Ü–µ–ª—å:`, currentGoal);
            if (goalChoice !== null) {
                let newGoal = goalChoice.trim();
                const goalNum = parseInt(newGoal);
                if (goalNum >= 1 && goalNum <= 5) {
                    newGoal = goals[goalNum - 1].substring(4);
                }
                
                if (!currentUser.profile) currentUser.profile = {};
                currentUser.profile.goal = newGoal;
                
                localStorage.setItem(CURRENT_USER_KEY, JSON.stringify(currentUser));
                
                const users = JSON.parse(localStorage.getItem(USERS_KEY));
                const userIndex = users.findIndex(u => u.id === currentUser.id);
                if (userIndex !== -1) {
                    users[userIndex] = currentUser;
                    localStorage.setItem(USERS_KEY, JSON.stringify(users));
                }
                
                const goalEl = document.getElementById('goal-info');
                if (goalEl) goalEl.textContent = newGoal || "–ù–µ —É–∫–∞–∑–∞–Ω–∞";
                showNotification('–¶–µ–ª—å –æ–±–Ω–æ–≤–ª–µ–Ω–∞!', 'success');
            }
        }
        
        // –≠–∫—Å–ø–æ—Ä—Ç –ø—Ä–æ—Ñ–∏–ª—è
        function exportProfile() {
            const currentUser = JSON.parse(localStorage.getItem(CURRENT_USER_KEY));
            if (!currentUser) {
                showNotification('–û—à–∏–±–∫–∞: –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω', 'error');
                return;
            }
            
            const exportData = {
                name: currentUser.name || currentUser.username,
                email: currentUser.email,
                registrationDate: currentUser.registrationDate,
                profile: currentUser.profile,
                testResults: currentUser.testResults,
                exportDate: new Date().toISOString()
            };
            
            const blob = new Blob([JSON.stringify(exportData, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `medical-profile-${currentUser.name || 'user'}-${new Date().toISOString().split('T')[0]}.json`;
            a.click();
            URL.revokeObjectURL(url);
            
            showNotification('–ü—Ä–æ—Ñ–∏–ª—å —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω!', 'success');
        }
        
        // –ü–æ–¥–µ–ª–∏—Ç—å—Å—è –ø—Ä–æ—Ñ–∏–ª–µ–º
        function shareProfile() {
            const currentUser = JSON.parse(localStorage.getItem(CURRENT_USER_KEY));
            if (!currentUser) return;
            
            const testResults = currentUser.testResults || {};
            const testCount = Object.keys(testResults).length;
            
            let totalScore = 0;
            Object.values(testResults).forEach(test => {
                if (test.score && test.maxScore) {
                    totalScore += Math.round((test.score / test.maxScore) * 100);
                }
            });
            const avgScore = testCount > 0 ? Math.round(totalScore / testCount) : 0;
            
            const shareText = `üè• –ú–æ–π –ø—Ä–æ—Ñ–∏–ª—å –Ω–∞ –ú–µ–¥–∏—Ü–∏–Ω—Å–∫–æ–π –ü—Ä–æ—Ñ–æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏–∏!\n\nüë§ ${currentUser.name || currentUser.username}\nüìä –ü—Ä–æ–π–¥–µ–Ω–æ —Ç–µ—Å—Ç–æ–≤: ${testCount}\nüìà –°—Ä–µ–¥–Ω–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: ${avgScore}%\n‚≠ê –£—Ä–æ–≤–µ–Ω—å: ${calculateLevel(currentUser)}\n\n–ü—Ä–∏—Å–æ–µ–¥–∏–Ω—è–π—Å—è –∏ –æ–ø—Ä–µ–¥–µ–ª–∏ —Å–≤–æ—é –º–µ–¥–∏—Ü–∏–Ω—Å–∫—É—é —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ—Å—Ç—å!`;
            
            if (navigator.share) {
                navigator.share({
                    title: '–ú–æ–π –ø—Ä–æ—Ñ–∏–ª—å - –ú–µ–¥–∏—Ü–∏–Ω—Å–∫–∞—è –ü—Ä–æ—Ñ–æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏—è',
                    text: shareText
                }).catch(console.error);
            } else {
                navigator.clipboard.writeText(shareText).then(() => {
                    showNotification('–ü—Ä–æ—Ñ–∏–ª—å —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞!', 'success');
                });
            }
        }
        
        // –°–±—Ä–æ—Å –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
        function resetProgress() {
            if (!confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —Å–±—Ä–æ—Å–∏—Ç—å –≤–µ—Å—å –ø—Ä–æ–≥—Ä–µ—Å—Å? –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å!')) {
                return;
            }
            
            if (!confirm('–≠—Ç–æ —É–¥–∞–ª–∏—Ç –≤—Å–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–æ–≤ –∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è. –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å?')) {
                return;
            }
            
            const currentUser = JSON.parse(localStorage.getItem(CURRENT_USER_KEY));
            if (!currentUser) return;
            
            currentUser.testResults = {};
            currentUser.achievements = [];
            currentUser.xp = 0;
            currentUser.level = 1;
            currentUser.streak = 0;
            
            localStorage.setItem(CURRENT_USER_KEY, JSON.stringify(currentUser));
            
            const users = JSON.parse(localStorage.getItem(USERS_KEY));
            const userIndex = users.findIndex(u => u.id === currentUser.id);
            if (userIndex !== -1) {
                users[userIndex] = currentUser;
                localStorage.setItem(USERS_KEY, JSON.stringify(users));
            }
            
            loadUserProfile();
            showNotification('–ü—Ä–æ–≥—Ä–µ—Å—Å —Å–±—Ä–æ—à–µ–Ω', 'warning');
        }
        
        // –¢—ë–º–Ω–∞—è —Ç–µ–º–∞
        function toggleDarkMode() {
            const body = document.body;
            const isDark = body.getAttribute('data-theme') === 'dark';
            
            if (isDark) {
                body.removeAttribute('data-theme');
                localStorage.setItem('theme', 'light');
                showNotification('–°–≤–µ—Ç–ª–∞—è —Ç–µ–º–∞ –≤–∫–ª—é—á–µ–Ω–∞', 'info');
            } else {
                body.setAttribute('data-theme', 'dark');
                localStorage.setItem('theme', 'dark');
                showNotification('–¢—ë–º–Ω–∞—è —Ç–µ–º–∞ –≤–∫–ª—é—á–µ–Ω–∞', 'info');
            }
        }
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ —Ç–µ–º—ã –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ
        function loadTheme() {
            const savedTheme = localStorage.getItem('theme');
            if (savedTheme === 'dark') {
                document.body.setAttribute('data-theme', 'dark');
            }
        }
        
        // –†–∞—Å—á—ë—Ç —É—Ä–æ–≤–Ω—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        function calculateLevel(user) {
            const xp = user.xp || 0;
            return Math.floor(xp / 100) + 1;
        }
        
        // –†–∞—Å—á—ë—Ç XP
        function calculateXP(user) {
            let xp = 0;
            const testResults = user.testResults || {};
            
            Object.values(testResults).forEach(test => {
                // 10 XP –∑–∞ –∫–∞–∂–¥—ã–π —Ç–µ—Å—Ç + –±–æ–Ω—É—Å –∑–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç
                xp += 10;
                if (test.score && test.maxScore) {
                    const percentage = (test.score / test.maxScore) * 100;
                    xp += Math.round(percentage / 10); // –î–æ 10 –±–æ–Ω—É—Å–Ω—ã—Ö XP
                }
            });
            
            return xp;
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π
        function updateAchievements(user) {
            const achievements = user.achievements || [];
            const testResults = user.testResults || {};
            const testCount = Object.keys(testResults).length;
            
            const achievementChecks = {
                'first_test': testCount >= 1,
                'five_tests': testCount >= 5,
                'ten_tests': testCount >= 10,
                'perfect_score': Object.values(testResults).some(t => t.score && t.maxScore && (t.score / t.maxScore) >= 0.95),
                'streak_3': (user.streak || 0) >= 3,
                'streak_7': (user.streak || 0) >= 7,
                'all_subjects': ['biology', 'chemistry', 'profession_general', 'profession_med'].every(subj => 
                    Object.keys(testResults).some(key => key.includes(subj))
                ),
                'speed_demon': Object.values(testResults).some(t => t.timeSpent && t.timeSpent < 300)
            };
            
            Object.entries(achievementChecks).forEach(([id, unlocked]) => {
                const el = document.querySelector(`.achievement[data-id="${id}"]`);
                if (el) {
                    if (unlocked) {
                        el.classList.remove('locked');
                        el.classList.add('unlocked');
                        if (!achievements.includes(id)) {
                            achievements.push(id);
                            showNotification(`üèÜ –ù–æ–≤–æ–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ: ${el.querySelector('.achievement-name').textContent}!`, 'success');
                        }
                    } else {
                        el.classList.add('locked');
                        el.classList.remove('unlocked');
                    }
                }
            });
            
            user.achievements = achievements;
            return user;
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞–ª–µ–Ω–¥–∞—Ä—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
        function updateActivityCalendar(user) {
            const calendar = document.getElementById('activity-calendar');
            if (!calendar) return;
            
            const testResults = user.testResults || {};
            const activityMap = {};
            
            // –ü–æ–¥—Å—á—ë—Ç –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ø–æ –¥–Ω—è–º
            Object.values(testResults).forEach(test => {
                if (test.date) {
                    const date = test.date.split('T')[0];
                    activityMap[date] = (activityMap[date] || 0) + 1;
                }
            });
            
            // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è 30 –¥–Ω–µ–π
            calendar.innerHTML = '';
            const today = new Date();
            
            for (let i = 29; i >= 0; i--) {
                const date = new Date(today);
                date.setDate(date.getDate() - i);
                const dateStr = date.toISOString().split('T')[0];
                
                const count = activityMap[dateStr] || 0;
                let className = 'calendar-day empty';
                if (count >= 5) className = 'calendar-day high';
                else if (count >= 3) className = 'calendar-day medium';
                else if (count >= 1) className = 'calendar-day low';
                
                const day = document.createElement('div');
                day.className = className;
                day.title = `${dateStr}: ${count} —Ç–µ—Å—Ç–æ–≤`;
                calendar.appendChild(day);
            }
        }
        
        // –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∫–∞—Ä—å–µ—Ä–µ
        function updateCareerRecommendations(user) {
            const container = document.getElementById('career-recommendations-list');
            if (!container) return;
            
            const testResults = user.testResults || {};
            if (Object.keys(testResults).length === 0) {
                container.innerHTML = '<p style="text-align: center; color: #999; padding: 20px;">–ü—Ä–æ–π–¥–∏—Ç–µ —Ç–µ—Å—Ç—ã, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏</p>';
                return;
            }
            
            // –ê–Ω–∞–ª–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –¥–ª—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π
            const careers = [
                { name: '–¢–µ—Ä–∞–ø–µ–≤—Ç', icon: 'ü©∫', match: 0, desc: '–í—Ä–∞—á –æ–±—â–µ–π –ø—Ä–∞–∫—Ç–∏–∫–∏' },
                { name: '–•–∏—Ä—É—Ä–≥', icon: '‚öîÔ∏è', match: 0, desc: '–û–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–µ –ª–µ—á–µ–Ω–∏–µ' },
                { name: '–ü–µ–¥–∏–∞—Ç—Ä', icon: 'üë∂', match: 0, desc: '–î–µ—Ç—Å–∫–∏–π –≤—Ä–∞—á' },
                { name: '–ö–∞—Ä–¥–∏–æ–ª–æ–≥', icon: '‚ù§Ô∏è', match: 0, desc: '–°–ø–µ—Ü–∏–∞–ª–∏—Å—Ç –ø–æ —Å–µ—Ä–¥—Ü—É' },
                { name: '–ù–µ–≤—Ä–æ–ª–æ–≥', icon: 'üß†', match: 0, desc: '–ù–µ—Ä–≤–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞' },
                { name: '–§–∞—Ä–º–∞—Ü–µ–≤—Ç', icon: 'üíä', match: 0, desc: '–†–∞–±–æ—Ç–∞ —Å –ª–µ–∫–∞—Ä—Å—Ç–≤–∞–º–∏' }
            ];
            
            // –ü—Ä–æ—Å—Ç–æ–π –∞–ª–≥–æ—Ä–∏—Ç–º –ø–æ–¥–±–æ—Ä–∞
            let totalScore = 0;
            let count = 0;
            
            Object.values(testResults).forEach(test => {
                if (test.score && test.maxScore) {
                    totalScore += (test.score / test.maxScore) * 100;
                    count++;
                }
            });
            
            const avgScore = count > 0 ? totalScore / count : 50;
            
            careers.forEach(career => {
                career.match = Math.min(95, Math.max(40, avgScore + (Math.random() * 20 - 10)));
            });
            
            careers.sort((a, b) => b.match - a.match);
            
            container.innerHTML = careers.slice(0, 4).map(career => `
                <div class="career-item">
                    <span class="career-icon">${career.icon}</span>
                    <div class="career-info">
                        <h4>${career.name}</h4>
                        <p>${career.desc}</p>
                    </div>
                    <span class="career-match">${Math.round(career.match)}%</span>
                </div>
            `).join('');
        }
        
        // –û–±–Ω–æ–≤–ª—ë–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è loadUserProfile
        const originalLoadUserProfile = loadUserProfile;
        loadUserProfile = function() {
            const currentUser = JSON.parse(localStorage.getItem(CURRENT_USER_KEY));
            if (!currentUser) return;
            
            // –û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
            document.getElementById('profile-name').textContent = currentUser.name || currentUser.username;
            document.getElementById('profile-email-text').textContent = currentUser.email;
            document.getElementById('profile-phone-text').textContent = currentUser.phone;
            document.getElementById('profile-age-text').textContent = `${currentUser.age} –ª–µ—Ç`;
            
            // –î–∞—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
            const regDate = new Date(currentUser.registrationDate);
            document.getElementById('profile-reg-date').textContent = regDate.toLocaleDateString('ru-RU', {
                day: 'numeric',
                month: 'long',
                year: 'numeric'
            });
            
            // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è (—ç–ª–µ–º–µ–Ω—Ç—ã –º–æ–≥—É—Ç –±—ã—Ç—å —Å–∫—Ä—ã—Ç—ã/—É–¥–∞–ª–µ–Ω—ã –∏–∑ UI)
            if (currentUser.profile) {
                const educationEl = document.getElementById('education-info');
                if (educationEl) educationEl.textContent = currentUser.profile.education || "–ù–µ —É–∫–∞–∑–∞–Ω–æ";

                const locationEl = document.getElementById('location-info');
                if (locationEl) locationEl.textContent = currentUser.profile.location || "–ù–µ —É–∫–∞–∑–∞–Ω–æ";

                const interestsEl = document.getElementById('interests-info');
                if (interestsEl) interestsEl.textContent = currentUser.profile.interests || "–ù–µ —É–∫–∞–∑–∞–Ω—ã";

                const goalEl = document.getElementById('goal-info');
                if (goalEl) goalEl.textContent = currentUser.profile.goal || "–ù–µ —É–∫–∞–∑–∞–Ω–∞";
            }
            
            // XP –∏ —É—Ä–æ–≤–µ–Ω—å
            const xp = calculateXP(currentUser);
            const level = Math.floor(xp / 100) + 1;
            const xpInLevel = xp % 100;
            
            const levelEl = document.getElementById('user-level');
            if (levelEl) levelEl.textContent = `–£—Ä–æ–≤–µ–Ω—å ${level}`;
            
            const xpTextEl = document.getElementById('xp-text');
            if (xpTextEl) xpTextEl.textContent = `${xpInLevel} / 100 XP`;
            
            const xpProgressEl = document.getElementById('xp-progress');
            if (xpProgressEl) xpProgressEl.style.width = `${xpInLevel}%`;
            
            const totalXpEl = document.getElementById('total-xp');
            if (totalXpEl) totalXpEl.textContent = xp;
            
            // –°—Ç–∞—Ç—É—Å
            const statusEl = document.getElementById('profile-status');
            if (statusEl) {
                const statuses = ['–ù–æ–≤–∏—á–æ–∫', '–£—á–µ–Ω–∏–∫', '–°—Ç—É–¥–µ–Ω—Ç', '–°–ø–µ—Ü–∏–∞–ª–∏—Å—Ç', '–≠–∫—Å–ø–µ—Ä—Ç', '–ú–∞—Å—Ç–µ—Ä'];
                statusEl.textContent = statuses[Math.min(level - 1, statuses.length - 1)];
            }
            
            // Streak
            const streakEl = document.getElementById('streak-days');
            if (streakEl) streakEl.textContent = currentUser.streak || 0;
            
            // –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
            updateUserStats(currentUser);
            
            // –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è
            updateAchievements(currentUser);
            
            // –ö–∞–ª–µ–Ω–¥–∞—Ä—å –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
            updateActivityCalendar(currentUser);
            
            // –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∫–∞—Ä—å–µ—Ä–µ
            updateCareerRecommendations(currentUser);
            
            // –ò—Å—Ç–æ—Ä–∏—è —Ç–µ—Å—Ç–æ–≤
            loadTestHistory(currentUser);
        };

        // –í—ã—Ö–æ–¥
        function logout() {
            // –ë–µ–∑ confirm: –∫–Ω–æ–ø–∫–∞ –¥–æ–ª–∂–Ω–∞ —Ä–∞–±–æ—Ç–∞—Ç—å –≤—Å–µ–≥–¥–∞ –∏ –±—ã—Å—Ç—Ä–æ
            try { localStorage.removeItem(CURRENT_USER_KEY); } catch { /* ignore */ }

            // –¢–∞–∫–∂–µ –∑–∞–∫—Ä—ã–≤–∞–µ–º —Ç–µ–∫—É—â–∏–π —Ç–µ—Å—Ç–æ–≤—ã–π UI, –µ—Å–ª–∏ –æ—Ç–∫—Ä—ã—Ç
            try {
                document.querySelectorAll('#tests .test-container').forEach(c => {
                    c.classList.remove('active');
                    c.style.display = 'none';
                });
                document.querySelectorAll('.result-container').forEach(c => {
                    c.classList.remove('show');
                    c.style.display = 'none';
                });
            } catch { /* ignore */ }

            // –í–æ–∑–≤—Ä–∞—Ç –Ω–∞ —ç–∫—Ä–∞–Ω –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –±–µ–∑ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏
            try {
                const auth = document.getElementById('auth-container');
                const main = document.getElementById('main-content');
                if (main) main.style.display = 'none';
                if (auth) auth.style.display = 'flex';
            } catch {
                // fallback
                try { location.reload(); } catch { /* ignore */ }
            }
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å —Å–µ–∫—Ü–∏—é
        function showSection(sectionId) {
            console.log('showSection called with:', sectionId);
            // –°–∫—Ä—ã—Ç—å –≤—Å–µ —Å–µ–∫—Ü–∏–∏
            document.querySelectorAll('section').forEach(section => {
                section.style.display = 'none';
                section.classList.remove('visible');
            });

            // –°–±—Ä–æ—Å–∏—Ç—å UI —Ç–µ—Å—Ç–æ–≤ (—á—Ç–æ–±—ã –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –≤—Å—ë —Å–Ω–æ–≤–∞ –∫–ª–∏–∫–∞–±–µ–ª—å–Ω–æ —Ä–∞–±–æ—Ç–∞–ª–æ)
            try {
                const legacyQuestions = document.getElementById('test-questions-container');
                if (legacyQuestions) {
                    legacyQuestions.classList.remove('active');
                    legacyQuestions.style.display = 'none';
                }
                const legacyResults = document.getElementById('test-results');
                if (legacyResults) {
                    legacyResults.classList.remove('show');
                    legacyResults.style.display = 'none';
                }
                document.querySelectorAll('#tests .test-container').forEach(c => {
                    c.classList.remove('active');
                    c.style.display = 'none';
                });
                document.querySelectorAll('#tests .result-container').forEach(c => {
                    c.classList.remove('show');
                    c.style.display = 'none';
                });
                const cards = document.querySelector('#tests .test-cards');
                if (cards) cards.style.display = sectionId === 'tests' ? 'grid' : cards.style.display;
            } catch (e) {
                console.warn('showSection test UI reset failed', e);
            }
            
            // –ü–æ–∫–∞–∑–∞—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—É—é —Å–µ–∫—Ü–∏—é
            const section = document.getElementById(sectionId);
            if (section) {
                section.style.display = 'block';
                
                // –ï—Å–ª–∏ —ç—Ç–æ –ø—Ä–æ—Ñ–∏–ª—å, –æ–±–Ω–æ–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ
                if (sectionId === 'profile') {
                    loadUserProfile();
                }
                
                setTimeout(() => {
                    section.classList.add('visible');
                }, 50);
            }

            // –û–±–Ω–æ–≤–∏—Ç—å –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä —Ç–µ–∫—É—â–µ–≥–æ —Ç–µ—Å—Ç–∞ –ø—Ä–∏ –∑–∞—Ö–æ–¥–µ –≤ "–¢–µ—Å—Ç—ã"
            try {
                if (sectionId === 'tests' && typeof updateCurrentTestUI === 'function') {
                    updateCurrentTestUI();
                }
            } catch { /* ignore */ }

            // –°–∫—Ä–æ–ª–ª –∫ –≤–µ—Ä—Ö—É —Å–µ–∫—Ü–∏–∏ (–∏ –±–µ–∑ –ª–∏—à–Ω–µ–π –∞–Ω–∏–º–∞—Ü–∏–∏ –ø—Ä–∏ reduced-motion)
            try {
                const reduceMotion = window.matchMedia && window.matchMedia('(prefers-reduced-motion: reduce)').matches;
                window.scrollTo({ top: 0, behavior: reduceMotion ? 'auto' : 'smooth' });
            } catch {
                window.scrollTo(0, 0);
            }
            
            // –û–±–Ω–æ–≤–∏—Ç—å –Ω–∞–≤–∏–≥–∞—Ü–∏—é
            document.querySelectorAll('nav a').forEach(link => {
                link.classList.remove('active');
            });
            
            // –ù–∞–π—Ç–∏ –∞–∫—Ç–∏–≤–Ω—É—é —Å—Å—ã–ª–∫—É –ø–æ sectionId
            const activeLink = Array.from(document.querySelectorAll('nav a')).find(link => 
                link.getAttribute('href') === `#${sectionId}`
            );
            
            if (activeLink) {
                activeLink.classList.add('active');
            }
        }

        // –ú–µ—Ç–∫–∏ —à–∫–∞–ª –ø—Ä–æ—Ñ–æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏–∏ (–¥–ª—è –∫—Ä–∞—Å–∏–≤–æ–≥–æ –≤—ã–≤–æ–¥–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤)
        const ORIENTATION_DIM_LABELS = {
            people: '–û–±—â–µ–Ω–∏–µ –∏ –ø–æ–º–æ—â—å –ª—é–¥—è–º',
            analysis: '–ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –∏ —Å–∏—Å—Ç–µ–º–Ω–æ–µ –º—ã—à–ª–µ–Ω–∏–µ',
            creativity: '–¢–≤–æ—Ä—á–µ—Å—Ç–≤–æ –∏ –∏–¥–µ–∏',
            practice: '–ü—Ä–∞–∫—Ç–∏–∫–∞ –∏ ¬´–¥–µ–ª–∞—Ç—å —Ä—É–∫–∞–º–∏¬ª',
            empathy: '–≠–º–ø–∞—Ç–∏—è',
            responsibility: '–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å',
            stress: '–°—Ç—Ä–µ—Å—Å–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å',
            accuracy: '–í–Ω–∏–º–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏ –∞–∫–∫—É—Ä–∞—Ç–Ω–æ—Å—Ç—å',
            science: '–ò–Ω—Ç–µ—Ä–µ—Å –∫ –Ω–∞—É–∫–µ',
            teamwork: '–ö–æ–º–∞–Ω–¥–Ω–∞—è —Ä–∞–±–æ—Ç–∞'
        };

        // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –∫–∞—Ä—Ç–æ—á–µ–∫ –æ–±—É—á–µ–Ω–∏—è
        function toggleLearningCard(element) {
            const card = element.closest('.learning-card');
            const details = card.querySelector('.learning-details');
            const toggle = card.querySelector('.learning-toggle');
            
            // –ó–∞–∫—Ä—ã–≤–∞–µ–º –¥—Ä—É–≥–∏–µ –æ—Ç–∫—Ä—ã—Ç—ã–µ –∫–∞—Ä—Ç–æ—á–∫–∏
            document.querySelectorAll('.learning-card').forEach(otherCard => {
                if (otherCard !== card) {
                    const otherDetails = otherCard.querySelector('.learning-details');
                    const otherToggle = otherCard.querySelector('.learning-toggle');
                    otherDetails.classList.remove('active');
                    otherToggle.classList.remove('active');
                    otherCard.style.zIndex = '1';
                }
            });
            
            // –û—Ç–∫—Ä—ã–≤–∞–µ–º/–∑–∞–∫—Ä—ã–≤–∞–µ–º —Ç–µ–∫—É—â—É—é –∫–∞—Ä—Ç–æ—á–∫—É
            details.classList.toggle('active');
            toggle.classList.toggle('active');
            
            // –ü–æ–¥–Ω–∏–º–∞–µ–º —Ç–µ–∫—É—â—É—é –∫–∞—Ä—Ç–æ—á–∫—É –Ω–∞ –ø–µ—Ä–µ–¥–Ω–∏–π –ø–ª–∞–Ω
            if (details.classList.contains('active')) {
                card.style.zIndex = '10';
            } else {
                card.style.zIndex = '1';
            }
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–µ—Ä–µ–º–µ—à–∏–≤–∞–Ω–∏—è –º–∞—Å—Å–∏–≤–∞ (–∞–ª–≥–æ—Ä–∏—Ç–º –§–∏—à–µ—Ä–∞-–ô–µ—Ç—Å–∞)
        function shuffleArray(array) {
            const newArray = [...array];
            for (let i = newArray.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [newArray[i], newArray[j]] = [newArray[j], newArray[i]];
            }
            return newArray;
        }

        // –ü–æ–ª—É—á–∏—Ç—å —Å–ª—É—á–∞–π–Ω—ã–µ 40 –≤–æ–ø—Ä–æ—Å–æ–≤ –∏–∑ –ø–æ–ª–Ω–æ–π –±–∞–∑—ã
        function getRandomQuestions(questions, count = 40) {
            // –ü–µ—Ä–µ–º–µ—à–∏–≤–∞–µ–º –≤—Å–µ –≤–æ–ø—Ä–æ—Å—ã
            const shuffled = shuffleArray(questions);
            // –ë–µ—Ä–µ–º –ø–µ—Ä–≤—ã–µ count –≤–æ–ø—Ä–æ—Å–æ–≤
            return shuffled.slice(0, count);
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ç–µ—Å—Ç–æ–≤ - –°–û–ó–î–ê–ï–ú –ü–û–õ–ù–£–Æ –ë–ê–ó–£ –í–û–ü–†–û–°–û–í (100+ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–µ—Å—Ç–∞)
        function initializeTests() {
            // –°–æ–∑–¥–∞–µ–º –ø–æ–ª–Ω—É—é –±–∞–∑—É –≤–æ–ø—Ä–æ—Å–æ–≤ –¥–ª—è –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤
            window.fullTestQuestions = {
                profession: generateProfessionQuestions(),
                chemistry: generateChemistryQuestions(),
                biology: generateBiologyQuestions(),
                specialty: generateSpecialtyQuestions()
            };
        }

        // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è 100+ –≤–æ–ø—Ä–æ—Å–æ–≤ –¥–ª—è —Ç–µ—Å—Ç–∞ –ø–æ –ø—Ä–æ—Ñ–æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏–∏
        function generateProfessionQuestions() {
            const questions = [];
            
            const baseQuestionTexts = [
                "–ú–Ω–µ –Ω—Ä–∞–≤–∏—Ç—Å—è –∏–∑—É—á–∞—Ç—å —Å—Ç—Ä–æ–µ–Ω–∏–µ —á–µ–ª–æ–≤–µ—á–µ—Å–∫–æ–≥–æ —Ç–µ–ª–∞",
                "–Ø —Å–ø–æ–∫–æ–π–Ω–æ –æ—Ç–Ω–æ—à—É—Å—å –∫ –≤–∏–¥—É –∫—Ä–æ–≤–∏",
                "–ú–µ–Ω—è –∏–Ω—Ç–µ—Ä–µ—Å—É–µ—Ç —Ä–∞–±–æ—Ç–∞ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–æ–≥–æ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è",
                "–Ø –≥–æ—Ç–æ–≤ –¥–æ–ª–≥–æ —É—á–∏—Ç—å—Å—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –º–µ–¥–∏—Ü–∏–Ω—Å–∫–æ–π –ø—Ä–æ—Ñ–µ—Å—Å–∏–∏",
                "–ú–Ω–µ –Ω—Ä–∞–≤–∏—Ç—Å—è –ø–æ–º–æ–≥–∞—Ç—å –ª—é–¥—è–º",
                "–Ø –≤–Ω–∏–º–∞—Ç–µ–ª–µ–Ω –∫ –¥–µ—Ç–∞–ª—è–º",
                "–Ø —Ö–æ—Ä–æ—à–æ —Ä–∞–±–æ—Ç–∞—é –≤ —Å—Ç—Ä–µ—Å—Å–æ–≤—ã—Ö —Å–∏—Ç—É–∞—Ü–∏—è—Ö",
                "–ú–Ω–µ –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã –±–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ—Ü–µ—Å—Å—ã",
                "–Ø —Ç–µ—Ä–ø–µ–ª–∏–≤ –∏ –º–æ–≥—É –¥–æ–ª–≥–æ –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è",
                "–Ø –≥–æ—Ç–æ–≤ —Ä–∞–±–æ—Ç–∞—Ç—å –≤ –Ω–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–º –≥—Ä–∞—Ñ–∏–∫–µ",
                "–ú–µ–Ω—è –∏–Ω—Ç–µ—Ä–µ—Å—É—é—Ç –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–µ –æ—Ç–∫—Ä—ã—Ç–∏—è",
                "–Ø —Ö–æ—Ä–æ—à–æ –∑–∞–ø–æ–º–∏–Ω–∞—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é",
                "–ú–Ω–µ –Ω—Ä–∞–≤–∏—Ç—Å—è —Ä–µ—à–∞—Ç—å —Å–ª–æ–∂–Ω—ã–µ –∑–∞–¥–∞—á–∏",
                "–Ø –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π —á–µ–ª–æ–≤–µ–∫",
                "–Ø —É–º–µ—é —Å–æ–ø–µ—Ä–µ–∂–∏–≤–∞—Ç—å",
                "–ú–µ–Ω—è –Ω–µ –ø—É–≥–∞—é—Ç —Ç—Ä—É–¥–Ω–æ—Å—Ç–∏",
                "–Ø –∏–Ω—Ç–µ—Ä–µ—Å—É—é—Å—å —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—è–º–∏ –≤ –º–µ–¥–∏—Ü–∏–Ω–µ",
                "–Ø –≥–æ—Ç–æ–≤ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ —É—á–∏—Ç—å—Å—è",
                "–ú–Ω–µ –Ω—Ä–∞–≤–∏—Ç—Å—è —Ä–∞–±–æ—Ç–∞—Ç—å –≤ –∫–æ–º–∞–Ω–¥–µ",
                "–Ø –∞–∫–∫—É—Ä–∞—Ç–µ–Ω –∏ —Ç–æ—á–µ–Ω",
                "–ú–µ–Ω—è –ø—Ä–∏–≤–ª–µ–∫–∞–µ—Ç –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–∞—è —Ä–∞–±–æ—Ç–∞",
                "–Ø —Ö–æ—Ä–æ—à–æ –ø–µ—Ä–µ–Ω–æ—à—É —Ñ–∏–∑–∏—á–µ—Å–∫–∏–µ –Ω–∞–≥—Ä—É–∑–∫–∏",
                "–ú–Ω–µ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–∞ –ø—Å–∏—Ö–æ–ª–æ–≥–∏—è",
                "–Ø —É–º–µ—é –±—ã—Å—Ç—Ä–æ –ø—Ä–∏–Ω–∏–º–∞—Ç—å —Ä–µ—à–µ–Ω–∏—è",
                "–ú–Ω–µ –Ω—Ä–∞–≤–∏—Ç—Å—è –æ–±—â–∞—Ç—å—Å—è —Å —Ä–∞–∑–Ω—ã–º–∏ –ª—é–¥—å–º–∏",
                "–Ø –Ω–∞–±–ª—é–¥–∞—Ç–µ–ª–µ–Ω",
                "–ú–µ–Ω—è –∏–Ω—Ç–µ—Ä–µ—Å—É–µ—Ç –ø—Ä–æ—Ñ–∏–ª–∞–∫—Ç–∏–∫–∞ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–π",
                "–Ø –≥–æ—Ç–æ–≤ –±—Ä–∞—Ç—å –Ω–∞ —Å–µ–±—è –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å",
                "–ú–Ω–µ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–∞ —Ñ–∞—Ä–º–∞–∫–æ–ª–æ–≥–∏—è",
                "–Ø —É–º–µ—é —Å–æ—Ö—Ä–∞–Ω—è—Ç—å —Å–ø–æ–∫–æ–π—Å—Ç–≤–∏–µ",
                "–ú–Ω–µ –Ω—Ä–∞–≤–∏—Ç—Å—è –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å",
                "–Ø –≥–æ—Ç–æ–≤ —Ä–∞–±–æ—Ç–∞—Ç—å —Å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–µ–π",
                "–ú–µ–Ω—è –ø—Ä–∏–≤–ª–µ–∫–∞–µ—Ç —Ö–∏—Ä—É—Ä–≥–∏—è",
                "–Ø –∏–Ω—Ç–µ—Ä–µ—Å—É—é—Å—å –≥–µ–Ω–µ—Ç–∏–∫–æ–π",
                "–ú–Ω–µ –Ω—Ä–∞–≤–∏—Ç—Å—è –æ–±—É—á–∞—Ç—å –¥—Ä—É–≥–∏—Ö",
                "–Ø —Ö–æ—Ä–æ—à–æ –≤–ª–∞–¥–µ—é —Ä—É–∫–∞–º–∏",
                "–ú–µ–Ω—è –∏–Ω—Ç–µ—Ä–µ—Å—É–µ—Ç –Ω–µ–æ—Ç–ª–æ–∂–Ω–∞—è –ø–æ–º–æ—â—å",
                "–Ø –≥–æ—Ç–æ–≤ —Ä–∞–±–æ—Ç–∞—Ç—å –≤ –ª—é–±—ã—Ö —É—Å–ª–æ–≤–∏—è—Ö",
                "–ú–Ω–µ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–∞ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞",
                "–Ø —Å—Ç—Ä–µ–º–ª—é—Å—å –∫ —Å–æ–≤–µ—Ä—à–µ–Ω—Å—Ç–≤—É"
            ];
            
            // –°–æ–∑–¥–∞–µ–º –≤–∞—Ä–∏–∞—Ü–∏–∏ –≤–æ–ø—Ä–æ—Å–æ–≤
            const questionVariations = [
                "–æ—á–µ–Ω—å ", "–æ—Å–æ–±–µ–Ω–Ω–æ ", "–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ ", "–±–µ–∑—É—Å–ª–æ–≤–Ω–æ ", "–Ω–µ—Å–æ–º–Ω–µ–Ω–Ω–æ ",
                "–≤—Å–µ–≥–¥–∞ ", "—á–∞—Å—Ç–æ ", "–æ–±—ã—á–Ω–æ ", "–∏–Ω–æ–≥–¥–∞ ", "—Ä–µ–¥–∫–æ "
            ];
            
            const questionEndings = [
                "", " –∏ —ç—Ç–æ –º–µ–Ω—è —É–≤–ª–µ–∫–∞–µ—Ç", " —ç—Ç–æ –º–æ–µ –ø—Ä–∏–∑–≤–∞–Ω–∏–µ", " —ç—Ç–æ –º–æ—è —Å—Ç—Ä–∞—Å—Ç—å",
                " –∏ –≥–æ—Ç–æ–≤ —ç—Ç–∏–º –∑–∞–Ω–∏–º–∞—Ç—å—Å—è", " –∏ —Ö–æ—á—É —Ä–∞–∑–≤–∏–≤–∞—Ç—å—Å—è –≤ —ç—Ç–æ–º –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–∏"
            ];
            
            // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º 100+ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –≤–æ–ø—Ä–æ—Å–æ–≤
            for (let i = 0; i < 100; i++) {
                const baseText = baseQuestionTexts[i % baseQuestionTexts.length];
                const variation = questionVariations[i % questionVariations.length];
                const ending = questionEndings[i % questionEndings.length];
                
                // –°–æ–∑–¥–∞–µ–º –≤–∞—Ä–∏–∞—Ü–∏—é –≤–æ–ø—Ä–æ—Å–∞
                let questionText = baseText;
                
                // –î–æ–±–∞–≤–ª—è–µ–º –≤–∞—Ä–∏–∞—Ü–∏–∏ –∫ –Ω–∞—á–∞–ª—É –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –≤–æ–ø—Ä–æ—Å–æ–≤
                if (i % 3 === 0) {
                    questionText = "–Ø " + variation + questionText.toLowerCase();
                } else if (i % 5 === 0) {
                    questionText = "–ú–æ–≥—É —Å–∫–∞–∑–∞—Ç—å, —á—Ç–æ " + questionText.toLowerCase();
                }
                
                // –î–æ–±–∞–≤–ª—è–µ–º –æ–∫–æ–Ω—á–∞–Ω–∏—è –∫ –Ω–µ–∫–æ—Ç–æ—Ä—ã–º –≤–æ–ø—Ä–æ—Å–∞–º
                if (i % 4 === 0 && ending) {
                    questionText += ending;
                }
                
                questions.push({
                    id: `prof-${i}`,
                    question: questionText,
                    options: [
                        "–ü–æ–ª–Ω–æ—Å—Ç—å—é —Å–æ–≥–ª–∞—Å–µ–Ω",
                        "–°–∫–æ—Ä–µ–µ —Å–æ–≥–ª–∞—Å–µ–Ω", 
                        "–ó–∞—Ç—Ä—É–¥–Ω—è—é—Å—å –æ—Ç–≤–µ—Ç–∏—Ç—å",
                        "–°–∫–æ—Ä–µ–µ –Ω–µ —Å–æ–≥–ª–∞—Å–µ–Ω",
                        "–ü–æ–ª–Ω–æ—Å—Ç—å—é –Ω–µ —Å–æ–≥–ª–∞—Å–µ–Ω"
                    ],
                    correct: 0, // –î–ª—è –ø—Ä–æ—Ñ–æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏–∏ –Ω–µ—Ç "–ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ" –æ—Ç–≤–µ—Ç–∞
                    difficulty: Math.ceil((i + 1) / 25), // –ì—Ä—É–ø–ø–∏—Ä—É–µ–º –ø–æ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏
                    explanation: "–≠—Ç–æ—Ç –≤–æ–ø—Ä–æ—Å –ø–æ–º–æ–∂–µ—Ç –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –≤–∞—à–∏ –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏—è –≤ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–∏."
                });
            }
            
            // –ì—Ä—É–ø–ø–∏—Ä—É–µ–º –≤–æ–ø—Ä–æ—Å—ã –ø–æ —É—Ä–æ–≤–Ω—è–º —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ –¥–ª—è profession
            const groupedQuestions = {};
            questions.forEach(question => {
                const level = question.difficulty;
                if (!groupedQuestions[level]) {
                    groupedQuestions[level] = [];
                }
                groupedQuestions[level].push(question);
            });
            
            return groupedQuestions;
        }

        // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è 100+ –≤–æ–ø—Ä–æ—Å–æ–≤ –¥–ª—è —Ç–µ—Å—Ç–∞ –ø–æ —Ö–∏–º–∏–∏
        function generateChemistryQuestions() {
            const questions = [];
            
            const baseQuestionData = [
                { text: "–ß—Ç–æ —Ç–∞–∫–æ–µ pH?", options: ["–ú–µ—Ä–∞ –∫–∏—Å–ª–æ—Ç–Ω–æ—Å—Ç–∏", "–ú–µ—Ä–∞ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã", "–ú–µ—Ä–∞ –¥–∞–≤–ª–µ–Ω–∏—è", "–ú–µ—Ä–∞ –æ–±—ä–µ–º–∞"], correct: 0 },
                { text: "–§–æ—Ä–º—É–ª–∞ –≤–æ–¥—ã?", options: ["H‚ÇÇO", "CO‚ÇÇ", "NaCl", "O‚ÇÇ"], correct: 0 },
                { text: "–ö–∞–∫–æ–π –≥–∞–∑ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≥–æ—Ä–µ–Ω–∏–µ?", options: ["–ö–∏—Å–ª–æ—Ä–æ–¥", "–ê–∑–æ—Ç", "–£–≥–ª–µ–∫–∏—Å–ª—ã–π –≥–∞–∑", "–í–æ–¥–æ—Ä–æ–¥"], correct: 0 },
                { text: "–°–∞–º—ã–π –ª–µ–≥–∫–∏–π —ç–ª–µ–º–µ–Ω—Ç?", options: ["–í–æ–¥–æ—Ä–æ–¥", "–ì–µ–ª–∏–π", "–õ–∏—Ç–∏–π", "–ö–∏—Å–ª–æ—Ä–æ–¥"], correct: 0 },
                { text: "–ß—Ç–æ —Ç–∞–∫–æ–µ –∫–∞—Ç–∞–ª–∏–∑–∞—Ç–æ—Ä?", options: ["–£—Å–∫–æ—Ä–∏—Ç–µ–ª—å —Ä–µ–∞–∫—Ü–∏–∏", "–ó–∞–º–µ–¥–ª–∏—Ç–µ–ª—å —Ä–µ–∞–∫—Ü–∏–∏", "–ü—Ä–æ–¥—É–∫—Ç —Ä–µ–∞–∫—Ü–∏–∏", "–ò—Å—Ö–æ–¥–Ω–æ–µ –≤–µ—â–µ—Å—Ç–≤–æ"], correct: 0 },
                { text: "–§–æ—Ä–º—É–ª–∞ –ø–æ–≤–∞—Ä–µ–Ω–Ω–æ–π —Å–æ–ª–∏?", options: ["NaCl", "KCl", "CaCl‚ÇÇ", "MgCl‚ÇÇ"], correct: 0 },
                { text: "–ö–∞–∫–æ–π —ç–ª–µ–º–µ–Ω—Ç –æ–±–æ–∑–Ω–∞—á–∞–µ—Ç—Å—è —Å–∏–º–≤–æ–ª–æ–º 'Fe'?", options: ["–ñ–µ–ª–µ–∑–æ", "–ó–æ–ª–æ—Ç–æ", "–°–µ—Ä–µ–±—Ä–æ", "–ú–µ–¥—å"], correct: 0 },
                { text: "–ß—Ç–æ —Ç–∞–∫–æ–µ –∏–∑–æ—Ç–æ–ø—ã?", options: ["–ê—Ç–æ–º—ã –æ–¥–Ω–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ —Å —Ä–∞–∑–Ω—ã–º —á–∏—Å–ª–æ–º –Ω–µ–π—Ç—Ä–æ–Ω–æ–≤", "–†–∞–∑–Ω—ã–µ —Ö–∏–º–∏—á–µ—Å–∫–∏–µ —ç–ª–µ–º–µ–Ω—Ç—ã", "–°–æ–µ–¥–∏–Ω–µ–Ω–∏—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤", "–ò–æ–Ω—ã —ç–ª–µ–º–µ–Ω—Ç–æ–≤"], correct: 0 },
                { text: "–ö–∞–∫–æ–π –º–µ—Ç–∞–ª–ª –∂–∏–¥–∫–∏–π –ø—Ä–∏ –∫–æ–º–Ω–∞—Ç–Ω–æ–π —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–µ?", options: ["–†—Ç—É—Ç—å", "–ù–∞—Ç—Ä–∏–π", "–ö–∞–ª–∏–π", "–°–≤–∏–Ω–µ—Ü"], correct: 0 },
                { text: "–ß—Ç–æ —Ç–∞–∫–æ–µ –∞–ª–ª–æ—Ç—Ä–æ–ø–∏—è?", options: ["–°—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–∞ –≤ —Ä–∞–∑–Ω—ã—Ö —Ñ–æ—Ä–º–∞—Ö", "–°–º–µ—à–µ–Ω–∏–µ –≤–µ—â–µ—Å—Ç–≤", "–†–∞—Å—Ç–≤–æ—Ä–µ–Ω–∏–µ –≤–µ—â–µ—Å—Ç–≤", "–í—ã–ø–∞–¥–µ–Ω–∏–µ –æ—Å–∞–¥–∫–∞"], correct: 0 },
                { text: "–§–æ—Ä–º—É–ª–∞ —É–≥–ª–µ–∫–∏—Å–ª–æ–≥–æ –≥–∞–∑–∞?", options: ["CO‚ÇÇ", "CO", "CH‚ÇÑ", "C‚ÇÇH‚ÇÖOH"], correct: 0 },
                { text: "–ß—Ç–æ —Ç–∞–∫–æ–µ —ç–ª–µ–∫—Ç—Ä–æ–ª–∏–∑?", options: ["–†–∞–∑–ª–æ–∂–µ–Ω–∏–µ –≤–µ—â–µ—Å—Ç–≤–∞ —ç–ª–µ–∫—Ç—Ä–∏—á–µ—Å–∫–∏–º —Ç–æ–∫–æ–º", "–ù–∞–≥—Ä–µ–≤–∞–Ω–∏–µ –≤–µ—â–µ—Å—Ç–≤–∞", "–û—Ö–ª–∞–∂–¥–µ–Ω–∏–µ –≤–µ—â–µ—Å—Ç–≤–∞", "–°–º–µ—à–µ–Ω–∏–µ –≤–µ—â–µ—Å—Ç–≤"], correct: 0 },
                { text: "–ö–∞–∫–æ–π —ç–ª–µ–º–µ–Ω—Ç —è–≤–ª—è–µ—Ç—Å—è –æ—Å–Ω–æ–≤–æ–π –æ—Ä–≥–∞–Ω–∏—á–µ—Å–∫–æ–π —Ö–∏–º–∏–∏?", options: ["–£–≥–ª–µ—Ä–æ–¥", "–í–æ–¥–æ—Ä–æ–¥", "–ö–∏—Å–ª–æ—Ä–æ–¥", "–ê–∑–æ—Ç"], correct: 0 },
                { text: "–ß—Ç–æ —Ç–∞–∫–æ–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä?", options: ["–í–µ—â–µ—Å—Ç–≤–æ, –º–µ–Ω—è—é—â–µ–µ —Ü–≤–µ—Ç –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç pH", "–í–µ—â–µ—Å—Ç–≤–æ –¥–ª—è –æ—á–∏—Å—Ç–∫–∏", "–í–µ—â–µ—Å—Ç–≤–æ –¥–ª—è –Ω–∞–≥—Ä–µ–≤–∞–Ω–∏—è", "–í–µ—â–µ—Å—Ç–≤–æ –¥–ª—è –æ—Ö–ª–∞–∂–¥–µ–Ω–∏—è"], correct: 0 },
                { text: "–ö–∞–∫–æ–π –≥–∞–∑ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –¥–ª—è –≥–∞–∑–∏—Ä–æ–≤–∫–∏?", options: ["CO‚ÇÇ", "O‚ÇÇ", "N‚ÇÇ", "H‚ÇÇ"], correct: 0 },
                { text: "–ß—Ç–æ —Ç–∞–∫–æ–µ –ø–æ–ª–∏–º–µ—Ä—ã?", options: ["–ú–æ–ª–µ–∫—É–ª—ã —Å –ø–æ–≤—Ç–æ—Ä—è—é—â–∏–º–∏—Å—è –∑–≤–µ–Ω—å—è–º–∏", "–ü—Ä–æ—Å—Ç—ã–µ –≤–µ—â–µ—Å—Ç–≤–∞", "–ú–µ—Ç–∞–ª–ª—ã", "–ì–∞–∑—ã"], correct: 0 },
                { text: "–ö–∞–∫–æ–π —ç–ª–µ–º–µ–Ω—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º –¥–ª—è –¥—ã—Ö–∞–Ω–∏—è?", options: ["–ö–∏—Å–ª–æ—Ä–æ–¥", "–ê–∑–æ—Ç", "–£–≥–ª–µ—Ä–æ–¥", "–í–æ–¥–æ—Ä–æ–¥"], correct: 0 },
                { text: "–ß—Ç–æ —Ç–∞–∫–æ–µ –∞–ª–∫–∞–Ω—ã?", options: ["–ü—Ä–µ–¥–µ–ª—å–Ω—ã–µ —É–≥–ª–µ–≤–æ–¥–æ—Ä–æ–¥—ã", "–ù–µ–ø—Ä–µ–¥–µ–ª—å–Ω—ã–µ —É–≥–ª–µ–≤–æ–¥–æ—Ä–æ–¥—ã", "–ê—Ä–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è", "–°–ø–∏—Ä—Ç—ã"], correct: 0 },
                { text: "–ö–∞–∫–æ–π –º–µ—Ç–∞–ª–ª —Å–∞–º—ã–π –ø–ª–∞—Å—Ç–∏—á–Ω—ã–π?", options: ["–ó–æ–ª–æ—Ç–æ", "–°–µ—Ä–µ–±—Ä–æ", "–ú–µ–¥—å", "–ê–ª—é–º–∏–Ω–∏–π"], correct: 0 },
                { text: "–ß—Ç–æ —Ç–∞–∫–æ–µ —ç—Ñ–∏—Ä?", options: ["–û—Ä–≥–∞–Ω–∏—á–µ—Å–∫–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Å –≥—Ä—É–ø–ø–æ–π R-O-R'", "–°–ø–∏—Ä—Ç", "–ö–∏—Å–ª–æ—Ç–∞", "–ê–ª—å–¥–µ–≥–∏–¥"], correct: 0 },
                { text: "–ö–∞–∫–æ–π —ç–ª–µ–º–µ–Ω—Ç –æ–±–æ–∑–Ω–∞—á–∞–µ—Ç—Å—è 'Au'?", options: ["–ó–æ–ª–æ—Ç–æ", "–°–µ—Ä–µ–±—Ä–æ", "–ü–ª–∞—Ç–∏–Ω–∞", "–ú–µ–¥—å"], correct: 0 },
                { text: "–ß—Ç–æ —Ç–∞–∫–æ–µ –∫–∞—Ç–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–π –∫–æ–Ω–≤–µ—Ä—Ç–µ—Ä?", options: ["–£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –¥–ª—è –æ—á–∏—Å—Ç–∫–∏ –≤—ã—Ö–ª–æ–ø–Ω—ã—Ö –≥–∞–∑–æ–≤", "–ü—Ä–∏–±–æ—Ä –¥–ª—è –Ω–∞–≥—Ä–µ–≤–∞–Ω–∏—è", "–°–æ—Å—É–¥ –¥–ª—è —Ä–µ–∞–∫—Ü–∏–π", "–ò–∑–º–µ—Ä–∏—Ç–µ–ª—å–Ω—ã–π –ø—Ä–∏–±–æ—Ä"], correct: 0 },
                { text: "–ö–∞–∫–æ–π —ç–ª–µ–º–µ–Ω—Ç —è–≤–ª—è–µ—Ç—Å—è –≥–∞–ª–æ–≥–µ–Ω–æ–º?", options: ["–•–ª–æ—Ä", "–ö–∏—Å–ª–æ—Ä–æ–¥", "–ê–∑–æ—Ç", "–£–≥–ª–µ—Ä–æ–¥"], correct: 0 },
                { text: "–ß—Ç–æ —Ç–∞–∫–æ–µ –∞–º–∏–Ω–æ–∫–∏—Å–ª–æ—Ç–∞?", options: ["–°—Ç—Ä–æ–∏—Ç–µ–ª—å–Ω—ã–π –±–ª–æ–∫ –±–µ–ª–∫–æ–≤", "–£–≥–ª–µ–≤–æ–¥", "–õ–∏–ø–∏–¥", "–ù—É–∫–ª–µ–∏–Ω–æ–≤–∞—è –∫–∏—Å–ª–æ—Ç–∞"], correct: 0 },
                { text: "–ö–∞–∫–æ–π —ç–ª–µ–º–µ–Ω—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º –¥–ª—è —Ñ–æ—Ç–æ—Å–∏–Ω—Ç–µ–∑–∞?", options: ["–£–≥–ª–µ—Ä–æ–¥", "–ö–∏—Å–ª–æ—Ä–æ–¥", "–ê–∑–æ—Ç", "–í–æ–¥–æ—Ä–æ–¥"], correct: 0 },
                { text: "–ß—Ç–æ —Ç–∞–∫–æ–µ –∏–∑–æ–º–µ—Ä–∏—è?", options: ["–°—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π —Å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º —Å–æ—Å—Ç–∞–≤–æ–º, –Ω–æ —Ä–∞–∑–Ω—ã–º —Å—Ç—Ä–æ–µ–Ω–∏–µ–º", "–°–º–µ—à–µ–Ω–∏–µ –≤–µ—â–µ—Å—Ç–≤", "–†–∞—Å—Ç–≤–æ—Ä–µ–Ω–∏–µ –≤–µ—â–µ—Å—Ç–≤", "–†–∞–∑–ª–æ–∂–µ–Ω–∏–µ –≤–µ—â–µ—Å—Ç–≤"], correct: 0 },
                { text: "–ö–∞–∫–æ–π –º–µ—Ç–∞–ª–ª –∏—Å–ø–æ–ª—å–∑—É—é—Ç –≤ —Ç–µ—Ä–º–æ–º–µ—Ç—Ä–∞—Ö?", options: ["–†—Ç—É—Ç—å", "–ù–∞—Ç—Ä–∏–π", "–ö–∞–ª–∏–π", "–°–≤–∏–Ω–µ—Ü"], correct: 0 },
                { text: "–ß—Ç–æ —Ç–∞–∫–æ–µ —Ñ–µ—Ä–º–µ–Ω—Ç?", options: ["–ë–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π –∫–∞—Ç–∞–ª–∏–∑–∞—Ç–æ—Ä", "–•–∏–º–∏—á–µ—Å–∫–∏–π —Ä–µ–∞–≥–µ–Ω—Ç", "–õ–µ–∫–∞—Ä—Å—Ç–≤–æ", "–ü–∏—â–µ–≤–∞—è –¥–æ–±–∞–≤–∫–∞"], correct: 0 },
                { text: "–ö–∞–∫–æ–π —ç–ª–µ–º–µ–Ω—Ç —è–≤–ª—è–µ—Ç—Å—è —â–µ–ª–æ—á–Ω—ã–º –º–µ—Ç–∞–ª–ª–æ–º?", options: ["–ù–∞—Ç—Ä–∏–π", "–ö–∞–ª—å—Ü–∏–π", "–ú–∞–≥–Ω–∏–π", "–ê–ª—é–º–∏–Ω–∏–π"], correct: 0 },
                { text: "–ß—Ç–æ —Ç–∞–∫–æ–µ –¥–∏—Å—Ç–∏–ª–ª—è—Ü–∏—è?", options: ["–†–∞–∑–¥–µ–ª–µ–Ω–∏–µ —Å–º–µ—Å–µ–π –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–∞–∑–Ω–∏—Ü—ã —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä –∫–∏–ø–µ–Ω–∏—è", "–°–º–µ—à–µ–Ω–∏–µ –≤–µ—â–µ—Å—Ç–≤", "–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è", "–ö—Ä–∏—Å—Ç–∞–ª–ª–∏–∑–∞—Ü–∏—è"], correct: 0 },
                { text: "–ö–∞–∫–æ–π —ç–ª–µ–º–µ–Ω—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º –¥–ª—è –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –±–µ–ª–∫–∞?", options: ["–ê–∑–æ—Ç", "–ö–∏—Å–ª–æ—Ä–æ–¥", "–£–≥–ª–µ—Ä–æ–¥", "–í–æ–¥–æ—Ä–æ–¥"], correct: 0 },
                { text: "–ß—Ç–æ —Ç–∞–∫–æ–µ –æ–∫—Å–∏–¥?", options: ["–°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–∞ —Å –∫–∏—Å–ª–æ—Ä–æ–¥–æ–º", "–°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Å –≤–æ–¥–æ—Ä–æ–¥–æ–º", "–°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Å —É–≥–ª–µ—Ä–æ–¥–æ–º", "–°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Å –∞–∑–æ—Ç–æ–º"], correct: 0 },
                { text: "–ö–∞–∫–æ–π —ç–ª–µ–º–µ–Ω—Ç —è–≤–ª—è–µ—Ç—Å—è –∏–Ω–µ—Ä—Ç–Ω—ã–º –≥–∞–∑–æ–º?", options: ["–ê—Ä–≥–æ–Ω", "–ö–∏—Å–ª–æ—Ä–æ–¥", "–ê–∑–æ—Ç", "–í–æ–¥–æ—Ä–æ–¥"], correct: 0 },
                { text: "–ß—Ç–æ —Ç–∞–∫–æ–µ –≥–∏–¥—Ä–æ–ª–∏–∑?", options: ["–†–µ–∞–∫—Ü–∏—è —Å –≤–æ–¥–æ–π", "–†–µ–∞–∫—Ü–∏—è —Å –∫–∏—Å–ª–æ—Ç–æ–π", "–†–µ–∞–∫—Ü–∏—è —Å–æ —â–µ–ª–æ—á—å—é", "–†–µ–∞–∫—Ü–∏—è —Å –∫–∏—Å–ª–æ—Ä–æ–¥–æ–º"], correct: 0 },
                { text: "–ö–∞–∫–æ–π –º–µ—Ç–∞–ª–ª –∏—Å–ø–æ–ª—å–∑—É—é—Ç –≤ –∞–∫–∫—É–º—É–ª—è—Ç–æ—Ä–∞—Ö?", options: ["–°–≤–∏–Ω–µ—Ü", "–ñ–µ–ª–µ–∑–æ", "–ú–µ–¥—å", "–ê–ª—é–º–∏–Ω–∏–π"], correct: 0 },
                { text: "–ß—Ç–æ —Ç–∞–∫–æ–µ —Å—É–±–ª–∏–º–∞—Ü–∏—è?", options: ["–ü–µ—Ä–µ—Ö–æ–¥ –∏–∑ —Ç–≤–µ—Ä–¥–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è –≤ –≥–∞–∑–æ–æ–±—Ä–∞–∑–Ω–æ–µ", "–ü–ª–∞–≤–ª–µ–Ω–∏–µ", "–ò—Å–ø–∞—Ä–µ–Ω–∏–µ", "–ö—Ä–∏—Å—Ç–∞–ª–ª–∏–∑–∞—Ü–∏—è"], correct: 0 },
                { text: "–ö–∞–∫–æ–π —ç–ª–µ–º–µ–Ω—Ç –æ–±–æ–∑–Ω–∞—á–∞–µ—Ç—Å—è 'Ag'?", options: ["–°–µ—Ä–µ–±—Ä–æ", "–ó–æ–ª–æ—Ç–æ", "–ü–ª–∞—Ç–∏–Ω–∞", "–ú–µ–¥—å"], correct: 0 },
                { text: "–ß—Ç–æ —Ç–∞–∫–æ–µ —Ä–∞–¥–∏–∫–∞–ª –≤ —Ö–∏–º–∏–∏?", options: ["–ê—Ç–æ–º –∏–ª–∏ –≥—Ä—É–ø–ø–∞ –∞—Ç–æ–º–æ–≤ —Å –Ω–µ—Å–ø–∞—Ä–µ–Ω–Ω—ã–º —ç–ª–µ–∫—Ç—Ä–æ–Ω–æ–º", "–ú–æ–ª–µ–∫—É–ª–∞", "–ò–æ–Ω", "–≠–ª–µ–º–µ–Ω—Ç"], correct: 0 },
                { text: "–ö–∞–∫–æ–π —ç–ª–µ–º–µ–Ω—Ç —è–≤–ª—è–µ—Ç—Å—è –æ—Å–Ω–æ–≤–æ–π –∂–∏–∑–Ω–∏?", options: ["–£–≥–ª–µ—Ä–æ–¥", "–ö–∏—Å–ª–æ—Ä–æ–¥", "–í–æ–¥–æ—Ä–æ–¥", "–ê–∑–æ—Ç"], correct: 0 },
                { text: "–ß—Ç–æ —Ç–∞–∫–æ–µ —ç–Ω–¥–æ—Ç–µ—Ä–º–∏—á–µ—Å–∫–∞—è —Ä–µ–∞–∫—Ü–∏—è?", options: ["–†–µ–∞–∫—Ü–∏—è —Å –ø–æ–≥–ª–æ—â–µ–Ω–∏–µ–º —Ç–µ–ø–ª–∞", "–†–µ–∞–∫—Ü–∏—è —Å –≤—ã–¥–µ–ª–µ–Ω–∏–µ–º —Ç–µ–ø–ª–∞", "–ù–µ–π—Ç—Ä–∞–ª—å–Ω–∞—è —Ä–µ–∞–∫—Ü–∏—è", "–ö–∞—Ç–∞–ª–∏—Ç–∏—á–µ—Å–∫–∞—è —Ä–µ–∞–∫—Ü–∏—è"], correct: 0 }
            ];
            
            // –°–æ–∑–¥–∞–µ–º –≤–∞—Ä–∏–∞—Ü–∏–∏ –≤–æ–ø—Ä–æ—Å–æ–≤
            const questionPrefixes = [
                "–í —Ö–∏–º–∏–∏ ", "–ö–∞–∫ –∏–∑–≤–µ—Å—Ç–Ω–æ, ", "–ò–∑ –∫—É—Ä—Å–∞ —Ö–∏–º–∏–∏: ", "–û—Å–Ω–æ–≤—ã —Ö–∏–º–∏–∏: ",
                "–•–∏–º–∏—á–µ—Å–∫–∏–π –≤–æ–ø—Ä–æ—Å: ", "–í–æ–ø—Ä–æ—Å –ø–æ —Ö–∏–º–∏–∏: "
            ];
            
            // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º 100+ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –≤–æ–ø—Ä–æ—Å–æ–≤
            for (let i = 0; i < 100; i++) {
                const baseData = baseQuestionData[i % baseQuestionData.length];
                const prefix = questionPrefixes[i % questionPrefixes.length];
                
                // –°–æ–∑–¥–∞–µ–º –≤–∞—Ä–∏–∞—Ü–∏—é –≤–æ–ø—Ä–æ—Å–∞
                let questionText = prefix + baseData.text.toLowerCase();
                
                questionText = questionText.charAt(0).toUpperCase() + questionText.slice(1);
                
                // –ü–µ—Ä–µ–º–µ—à–∏–≤–∞–µ–º –≤–∞—Ä–∏–∞–Ω—Ç—ã –æ—Ç–≤–µ—Ç–æ–≤
                const shuffledOptions = shuffleArray([...baseData.options]);
                const correctIndex = shuffledOptions.indexOf(baseData.options[baseData.correct]);
                
                questions.push({
                    id: `chem-${i}`,
                    question: questionText,
                    options: shuffledOptions,
                    correct: correctIndex,
                    difficulty: Math.ceil((i + 1) / 25),
                    explanation: "–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–≤–æ–∏ –∑–Ω–∞–Ω–∏—è –≤ –æ–±–ª–∞—Å—Ç–∏ —Ö–∏–º–∏–∏."
                });
            }
            
            // –ì—Ä—É–ø–ø–∏—Ä—É–µ–º –≤–æ–ø—Ä–æ—Å—ã –ø–æ —É—Ä–æ–≤–Ω—è–º —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ –¥–ª—è chemistry
            const groupedQuestions = {};
            questions.forEach(question => {
                const level = question.difficulty;
                if (!groupedQuestions[level]) {
                    groupedQuestions[level] = [];
                }
                groupedQuestions[level].push(question);
            });
            
            return groupedQuestions;
        }

        // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è 100+ –≤–æ–ø—Ä–æ—Å–æ–≤ –¥–ª—è —Ç–µ—Å—Ç–∞ –ø–æ –±–∏–æ–ª–æ–≥–∏–∏
        function generateBiologyQuestions() {
            const questions = [];
            
            const baseQuestionData = [
                { text: "–ß—Ç–æ —Ç–∞–∫–æ–µ –î–ù–ö?", options: ["–ì–µ–Ω–µ—Ç–∏—á–µ—Å–∫–∏–π –º–∞—Ç–µ—Ä–∏–∞–ª", "–ë–µ–ª–æ–∫", "–£–≥–ª–µ–≤–æ–¥", "–ñ–∏—Ä"], correct: 0 },
                { text: "–°–∫–æ–ª—å–∫–æ —Ö—Ä–æ–º–æ—Å–æ–º —É —á–µ–ª–æ–≤–µ–∫–∞?", options: ["46", "23", "48", "24"], correct: 0 },
                { text: "–û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –º–∏—Ç–æ—Ö–æ–Ω–¥—Ä–∏–π?", options: ["–í—ã—Ä–∞–±–æ—Ç–∫–∞ —ç–Ω–µ—Ä–≥–∏–∏", "–°–∏–Ω—Ç–µ–∑ –±–µ–ª–∫–æ–≤", "–§–æ—Ç–æ—Å–∏–Ω—Ç–µ–∑", "–•—Ä–∞–Ω–µ–Ω–∏–µ –î–ù–ö"], correct: 0 },
                { text: "–ß—Ç–æ —Ç–∞–∫–æ–µ —Ñ–æ—Ç–æ—Å–∏–Ω—Ç–µ–∑?", options: ["–û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –æ—Ä–≥–∞–Ω–∏—á–µ—Å–∫–∏—Ö –≤–µ—â–µ—Å—Ç–≤ –Ω–∞ —Å–≤–µ—Ç—É", "–î—ã—Ö–∞–Ω–∏–µ —Ä–∞—Å—Ç–µ–Ω–∏–π", "–î–µ–ª–µ–Ω–∏–µ –∫–ª–µ—Ç–æ–∫", "–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç –≤–æ–¥—ã"], correct: 0 },
                { text: "–ö–∞–∫–æ–π –æ—Ä–≥–∞–Ω –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é –∫—Ä–æ–≤–∏?", options: ["–ü–æ—á–∫–∏", "–ü–µ—á–µ–Ω—å", "–°–µ—Ä–¥—Ü–µ", "–õ–µ–≥–∫–∏–µ"], correct: 0 },
                { text: "–ß—Ç–æ —Ç–∞–∫–æ–µ –Ω–µ–π—Ä–æ–Ω?", options: ["–ù–µ—Ä–≤–Ω–∞—è –∫–ª–µ—Ç–∫–∞", "–ú—ã—à–µ—á–Ω–∞—è –∫–ª–µ—Ç–∫–∞", "–ö—Ä–æ–≤—è–Ω–∞—è –∫–ª–µ—Ç–∫–∞", "–ö–æ—Å—Ç–Ω–∞—è –∫–ª–µ—Ç–∫–∞"], correct: 0 },
                { text: "–ö–∞–∫–∞—è —Å–∏—Å—Ç–µ–º–∞ –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ –∏–º–º—É–Ω–∏—Ç–µ—Ç?", options: ["–ò–º–º—É–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞", "–ü–∏—â–µ–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞", "–î—ã—Ö–∞—Ç–µ–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞", "–ù–µ—Ä–≤–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞"], correct: 0 },
                { text: "–ß—Ç–æ —Ç–∞–∫–æ–µ —Ñ–µ—Ä–º–µ–Ω—Ç—ã?", options: ["–ë–µ–ª–∫–∏-–∫–∞—Ç–∞–ª–∏–∑–∞—Ç–æ—Ä—ã", "–£–≥–ª–µ–≤–æ–¥—ã", "–õ–∏–ø–∏–¥—ã", "–ù—É–∫–ª–µ–∏–Ω–æ–≤—ã–µ –∫–∏—Å–ª–æ—Ç—ã"], correct: 0 },
                { text: "–ö–∞–∫ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è –ø—Ä–æ—Ü–µ—Å—Å –¥–µ–ª–µ–Ω–∏—è –∫–ª–µ—Ç–∫–∏?", options: ["–ú–∏—Ç–æ–∑", "–§–æ—Ç–æ—Å–∏–Ω—Ç–µ–∑", "–î—ã—Ö–∞–Ω–∏–µ", "–ü–∏—â–µ–≤–∞—Ä–µ–Ω–∏–µ"], correct: 0 },
                { text: "–ß—Ç–æ —Ç–∞–∫–æ–µ –∞–Ω—Ç–∏—Ç–µ–ª–∞?", options: ["–ë–µ–ª–∫–∏ –∏–º–º—É–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã", "–ì–æ—Ä–º–æ–Ω—ã", "–§–µ—Ä–º–µ–Ω—Ç—ã", "–í–∏—Ç–∞–º–∏–Ω—ã"], correct: 0 },
                { text: "–ö–∞–∫–æ–π –≤–∏—Ç–∞–º–∏–Ω –≤—ã—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è –ø–æ–¥ –¥–µ–π—Å—Ç–≤–∏–µ–º —Å–æ–ª–Ω—Ü–∞?", options: ["–í–∏—Ç–∞–º–∏–Ω D", "–í–∏—Ç–∞–º–∏–Ω C", "–í–∏—Ç–∞–º–∏–Ω A", "–í–∏—Ç–∞–º–∏–Ω B12"], correct: 0 },
                { text: "–ß—Ç–æ —Ç–∞–∫–æ–µ –≥–æ—Ä–º–æ–Ω—ã?", options: ["–•–∏–º–∏—á–µ—Å–∫–∏–µ –ø–æ—Å—Ä–µ–¥–Ω–∏–∫–∏", "–§–µ—Ä–º–µ–Ω—Ç—ã", "–ê–Ω—Ç–∏—Ç–µ–ª–∞", "–í–∏—Ç–∞–º–∏–Ω—ã"], correct: 0 },
                { text: "–ö–∞–∫–æ–π –æ—Ä–≥–∞–Ω –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç –∏–Ω—Å—É–ª–∏–Ω?", options: ["–ü–æ–¥–∂–µ–ª—É–¥–æ—á–Ω–∞—è –∂–µ–ª–µ–∑–∞", "–ü–µ—á–µ–Ω—å", "–ü–æ—á–∫–∏", "–°–µ—Ä–¥—Ü–µ"], correct: 0 },
                { text: "–ß—Ç–æ —Ç–∞–∫–æ–µ —ç–≤–æ–ª—é—Ü–∏—è?", options: ["–ò–∑–º–µ–Ω–µ–Ω–∏–µ –≤–∏–¥–æ–≤ –≤–æ –≤—Ä–µ–º–µ–Ω–∏", "–†–æ—Å—Ç –æ—Ä–≥–∞–Ω–∏–∑–º–∞", "–†–∞–∑–º–Ω–æ–∂–µ–Ω–∏–µ", "–ü–∏—Ç–∞–Ω–∏–µ"], correct: 0 },
                { text: "–ö–∞–∫ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è –Ω–∞—É–∫–∞ –æ –Ω–∞—Å–ª–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏?", options: ["–ì–µ–Ω–µ—Ç–∏–∫–∞", "–≠–∫–æ–ª–æ–≥–∏—è", "–§–∏–∑–∏–æ–ª–æ–≥–∏—è", "–ê–Ω–∞—Ç–æ–º–∏—è"], correct: 0 },
                { text: "–ß—Ç–æ —Ç–∞–∫–æ–µ —ç–∫–æ—Å–∏—Å—Ç–µ–º–∞?", options: ["–°–æ–æ–±—â–µ—Å—Ç–≤–æ –æ—Ä–≥–∞–Ω–∏–∑–º–æ–≤ –∏ —Å—Ä–µ–¥–∞ –æ–±–∏—Ç–∞–Ω–∏—è", "–û—Ç–¥–µ–ª—å–Ω—ã–π –æ—Ä–≥–∞–Ω–∏–∑–º", "–ì—Ä—É–ø–ø–∞ –∫–ª–µ—Ç–æ–∫", "–û—Ä–≥–∞–Ω"], correct: 0 },
                { text: "–ö–∞–∫–æ–π –≥–∞–∑ —Ä–∞—Å—Ç–µ–Ω–∏—è –ø–æ–≥–ª–æ—â–∞—é—Ç –ø—Ä–∏ —Ñ–æ—Ç–æ—Å–∏–Ω—Ç–µ–∑–µ?", options: ["CO‚ÇÇ", "O‚ÇÇ", "N‚ÇÇ", "H‚ÇÇ"], correct: 0 },
                { text: "–ß—Ç–æ —Ç–∞–∫–æ–µ –±–∏–æ—Å—Ñ–µ—Ä–∞?", options: ["–û–±–ª–∞—Å—Ç—å –∂–∏–∑–Ω–∏ –Ω–∞ –ó–µ–º–ª–µ", "–ê—Ç–º–æ—Å—Ñ–µ—Ä–∞", "–ì–∏–¥—Ä–æ—Å—Ñ–µ—Ä–∞", "–õ–∏—Ç–æ—Å—Ñ–µ—Ä–∞"], correct: 0 },
                { text: "–ö–∞–∫ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è –ø—Ä–æ—Ü–µ—Å—Å –ø–æ–ª—É—á–µ–Ω–∏—è —ç–Ω–µ—Ä–≥–∏–∏ –∏–∑ –ø–∏—â–∏?", options: ["–ö–ª–µ—Ç–æ—á–Ω–æ–µ –¥—ã—Ö–∞–Ω–∏–µ", "–§–æ—Ç–æ—Å–∏–Ω—Ç–µ–∑", "–§–µ—Ä–º–µ–Ω—Ç–∞—Ü–∏—è", "–î–∏—Ñ—Ñ—É–∑–∏—è"], correct: 0 },
                { text: "–ß—Ç–æ —Ç–∞–∫–æ–µ –≤–∏—Ä—É—Å?", options: ["–ù–µ–∫–ª–µ—Ç–æ—á–Ω–∞—è —Ñ–æ—Ä–º–∞ –∂–∏–∑–Ω–∏", "–ë–∞–∫—Ç–µ—Ä–∏—è", "–ì—Ä–∏–±", "–†–∞—Å—Ç–µ–Ω–∏–µ"], correct: 0 },
                { text: "–ö–∞–∫–æ–π –æ—Ä–≥–∞–Ω —è–≤–ª—è–µ—Ç—Å—è —Å–∞–º—ã–º –±–æ–ª—å—à–∏–º –≤ –æ—Ä–≥–∞–Ω–∏–∑–º–µ —á–µ–ª–æ–≤–µ–∫–∞?", options: ["–ö–æ–∂–∞", "–ü–µ—á–µ–Ω—å", "–°–µ—Ä–¥–µ", "–ú–æ–∑–≥"], correct: 0 },
                { text: "–ß—Ç–æ —Ç–∞–∫–æ–µ —Ä–µ—Ñ–ª–µ–∫—Å?", options: ["–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ä–µ–∞–∫—Ü–∏—è –Ω–∞ —Ä–∞–∑–¥—Ä–∞–∂–∏—Ç–µ–ª—å", "–°–æ–∑–Ω–∞—Ç–µ–ª—å–Ω–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ", "–ú—ã—Å–ª—å", "–≠–º–æ—Ü–∏—è"], correct: 0 },
                { text: "–ö–∞–∫ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è –æ—Å–Ω–æ–≤–Ω–æ–π –∑–∞–∫–æ–Ω –≥–µ–Ω–µ—Ç–∏–∫–∏?", options: ["–ó–∞–∫–æ–Ω—ã –ú–µ–Ω–¥–µ–ª—è", "–¢–µ–æ—Ä–∏—è –î–∞—Ä–≤–∏–Ω–∞", "–ó–∞–∫–æ–Ω –ì–∞—Ä–¥–∏-–í–∞–π–Ω–±–µ—Ä–≥–∞", "–ü—Ä–∞–≤–∏–ª–æ –ë–µ—Ä–≥–º–∞–Ω–∞"], correct: 0 },
                { text: "–ß—Ç–æ —Ç–∞–∫–æ–µ –≥–æ–º–µ–æ—Å—Ç–∞–∑?", options: ["–ü–æ–¥–¥–µ—Ä–∂–∞–Ω–∏–µ –ø–æ—Å—Ç–æ—è–Ω—Å—Ç–≤–∞ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–π —Å—Ä–µ–¥—ã", "–†–æ—Å—Ç –æ—Ä–≥–∞–Ω–∏–∑–º–∞", "–†–∞–∑–º–Ω–æ–∂–µ–Ω–∏–µ", "–≠–≤–æ–ª—é—Ü–∏—è"], correct: 0 },
                { text: "–ö–∞–∫–æ–π –≤–∏—Ç–∞–º–∏–Ω –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç —Ü–∏–Ω–≥—É?", options: ["–í–∏—Ç–∞–º–∏–Ω C", "–í–∏—Ç–∞–º–∏–Ω D", "–í–∏—Ç–∞–º–∏–Ω A", "–í–∏—Ç–∞–º–∏–Ω K"], correct: 0 },
                { text: "–ß—Ç–æ —Ç–∞–∫–æ–µ —Ç–∞–∫—Å–æ–Ω–æ–º–∏—è?", options: ["–ù–∞—É–∫–∞ –æ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –æ—Ä–≥–∞–Ω–∏–∑–º–æ–≤", "–ù–∞—É–∫–∞ –æ –∫–ª–µ—Ç–∫–∞—Ö", "–ù–∞—É–∫–∞ –æ —Ç–∫–∞–Ω—è—Ö", "–ù–∞—É–∫–∞ –æ–± –æ—Ä–≥–∞–Ω–∞—Ö"], correct: 0 },
                { text: "–ö–∞–∫ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è –ø—Ä–æ—Ü–µ—Å—Å –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –ø–æ–ª–æ–≤—ã—Ö –∫–ª–µ—Ç–æ–∫?", options: ["–ú–µ–π–æ–∑", "–ú–∏—Ç–æ–∑", "–ê–º–∏—Ç–æ–∑", "–≠–Ω–¥–æ–º–∏—Ç–æ–∑"], correct: 0 },
                { text: "–ß—Ç–æ —Ç–∞–∫–æ–µ –†–ù–ö?", options: ["–†–∏–±–æ–Ω—É–∫–ª–µ–∏–Ω–æ–≤–∞—è –∫–∏—Å–ª–æ—Ç–∞", "–î–µ–∑–æ–∫—Å–∏—Ä–∏–±–æ–Ω—É–∫–ª–µ–∏–Ω–æ–≤–∞—è –∫–∏—Å–ª–æ—Ç–∞", "–ë–µ–ª–æ–∫", "–£–≥–ª–µ–≤–æ–¥"], correct: 0 },
                { text: "–ö–∞–∫–æ–π –æ—Ä–≥–∞–Ω –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ —Ä–∞–≤–Ω–æ–≤–µ—Å–∏–µ?", options: ["–í–µ—Å—Ç–∏–±—É–ª—è—Ä–Ω—ã–π –∞–ø–ø–∞—Ä–∞—Ç", "–ì–ª–∞–∑–∞", "–£—à–∏", "–ú–æ–∑–≥"], correct: 0 },
                { text: "–ß—Ç–æ —Ç–∞–∫–æ–µ –ø–æ–ø—É–ª—è—Ü–∏—è?", options: ["–ì—Ä—É–ø–ø–∞ –æ—Å–æ–±–µ–π –æ–¥–Ω–æ–≥–æ –≤–∏–¥–∞", "–†–∞–∑–Ω—ã–µ –≤–∏–¥—ã –≤ –æ–¥–Ω–æ–π –º–µ—Å—Ç–Ω–æ—Å—Ç–∏", "–û–¥–∏–Ω –æ—Ä–≥–∞–Ω–∏–∑–º", "–ö–ª–µ—Ç–∫–∏ –æ–¥–Ω–æ–≥–æ —Ç–∏–ø–∞"], correct: 0 },
                { text: "–ö–∞–∫ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è —Å–∏–º–±–∏–æ–∑, –≤—ã–≥–æ–¥–Ω—ã–π –æ–±–æ–∏–º –æ—Ä–≥–∞–Ω–∏–∑–º–∞–º?", options: ["–ú—É—Ç—É–∞–ª–∏–∑–º", "–ü–∞—Ä–∞–∑–∏—Ç–∏–∑–º", "–ö–æ–º–º–µ–Ω—Å–∞–ª–∏–∑–º", "–ö–æ–Ω–∫—É—Ä–µ–Ω—Ü–∏—è"], correct: 0 },
                { text: "–ß—Ç–æ —Ç–∞–∫–æ–µ —Ñ–µ–Ω–æ—Ç–∏–ø?", options: ["–í–Ω–µ—à–Ω–µ–µ –ø—Ä–æ—è–≤–ª–µ–Ω–∏–µ –≥–µ–Ω–æ—Ç–∏–ø–∞", "–ù–∞–±–æ—Ä –≥–µ–Ω–æ–≤", "–•—Ä–æ–º–æ—Å–æ–º—ã", "–î–ù–ö"], correct: 0 },
                { text: "–ö–∞–∫–æ–π –≥–æ—Ä–º–æ–Ω –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ —Å—Ç—Ä–µ—Å—Å?", options: ["–ö–æ—Ä—Ç–∏–∑–æ–ª", "–ò–Ω—Å—É–ª–∏–Ω", "–¢–µ—Å—Ç–æ—Å—Ç–µ—Ä–æ–Ω", "–≠—Å—Ç—Ä–æ–≥–µ–Ω"], correct: 0 },
                { text: "–ß—Ç–æ —Ç–∞–∫–æ–µ –±–∏–æ—Ä–∏—Ç–º—ã?", options: ["–¶–∏–∫–ª–∏—á–µ—Å–∫–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –æ—Ä–≥–∞–Ω–∏–∑–º–∞", "–ü—É–ª—å—Å", "–î—ã—Ö–∞–Ω–∏–µ", "–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ —Ç–µ–ª–∞"], correct: 0 },
                { text: "–ö–∞–∫ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è –Ω–∞—É–∫–∞ –æ –ø–æ–≤–µ–¥–µ–Ω–∏–∏ –∂–∏–≤–æ—Ç–Ω—ã—Ö?", options: ["–≠—Ç–æ–ª–æ–≥–∏—è", "–≠–∫–æ–ª–æ–≥–∏—è", "–ì–µ–Ω–µ—Ç–∏–∫–∞", "–§–∏–∑–∏–æ–ª–æ–≥–∏—è"], correct: 0 },
                { text: "–ß—Ç–æ —Ç–∞–∫–æ–µ –ø–ª–∞–∑–º–∏–¥–∞?", options: ["–ö–æ–ª—å—Ü–µ–≤–∞—è –î–ù–ö —É –±–∞–∫—Ç–µ—Ä–∏–π", "–ë–µ–ª–æ–∫", "–í–∏—Ä—É—Å", "–ö–ª–µ—Ç–æ—á–Ω–∞—è —Å—Ç–µ–Ω–∫–∞"], correct: 0 },
                { text: "–ö–∞–∫–æ–π –≤–∏—Ç–∞–º–∏–Ω –Ω–µ–æ–±—Ö–æ–¥–∏–º –¥–ª—è —Å–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è –∫—Ä–æ–≤–∏?", options: ["–í–∏—Ç–∞–º–∏–Ω K", "–í–∏—Ç–∞–º–∏–Ω C", "–í–∏—Ç–∞–º–∏–Ω D", "–í–∏—Ç–∞–º–∏–Ω A"], correct: 0 },
                { text: "–ß—Ç–æ —Ç–∞–∫–æ–µ —Ç—Ä–æ—Ñ–∏—á–µ—Å–∫–∞—è —Ü–µ–ø—å?", options: ["–¶–µ–ø—å –ø–∏—Ç–∞–Ω–∏—è", "–¶–µ–ø—å –î–ù–ö", "–¶–µ–ø—å –Ω–µ–π—Ä–æ–Ω–æ–≤", "–¶–µ–ø—å –∫—Ä–æ–≤–æ–æ–±—Ä–∞—â–µ–Ω–∏—è"], correct: 0 },
                { text: "–ö–∞–∫ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è –ø—Ä–æ—Ü–µ—Å—Å —Ä–∞—Å—â–µ–ø–ª–µ–Ω–∏—è –≥–ª—é–∫–æ–∑—ã?", options: ["–ì–ª–∏–∫–æ–ª–∏–∑", "–§–æ—Ç–æ—Å–∏–Ω—Ç–µ–∑", "–î—ã—Ö–∞–Ω–∏–µ", "–§–µ—Ä–º–µ–Ω—Ç–∞—Ü–∏—è"], correct: 0 },
                { text: "–ß—Ç–æ —Ç–∞–∫–æ–µ –±–∏–æ—Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏–µ?", options: ["–†–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏–µ –∂–∏–≤—ã—Ö –æ—Ä–≥–∞–Ω–∏–∑–º–æ–≤", "–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—Å–æ–±–µ–π", "–†–∞–∑–º–µ—Ä –æ—Ä–≥–∞–Ω–∏–∑–º–æ–≤", "–°–∫–æ—Ä–æ—Å—Ç—å —Ä–∞–∑–º–Ω–æ–∂–µ–Ω–∏—è"], correct: 0 }
            ];
            
            // –°–æ–∑–¥–∞–µ–º –≤–∞—Ä–∏–∞—Ü–∏–∏ –≤–æ–ø—Ä–æ—Å–æ–≤
            const questionPrefixes = [
                "–í –±–∏–æ–ª–æ–≥–∏–∏ ", "–ö–∞–∫ –∏–∑–≤–µ—Å—Ç–Ω–æ, ", "–ò–∑ –∫—É—Ä—Å–∞ –±–∏–æ–ª–æ–≥–∏–∏: ", "–û—Å–Ω–æ–≤—ã –±–∏–æ–ª–æ–≥–∏–∏: ",
                "–ë–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π –≤–æ–ø—Ä–æ—Å: ", "–í–æ–ø—Ä–æ—Å –ø–æ –±–∏–æ–ª–æ–≥–∏–∏: "
            ];
            
            // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º 100+ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –≤–æ–ø—Ä–æ—Å–æ–≤
            for (let i = 0; i < 100; i++) {
                const baseData = baseQuestionData[i % baseQuestionData.length];
                const prefix = questionPrefixes[i % questionPrefixes.length];
                
                // –°–æ–∑–¥–∞–µ–º –≤–∞—Ä–∏–∞—Ü–∏—é –≤–æ–ø—Ä–æ—Å–∞
                let questionText = prefix + baseData.text.toLowerCase();
                
                questionText = questionText.charAt(0).toUpperCase() + questionText.slice(1);
                
                // –ü–µ—Ä–µ–º–µ—à–∏–≤–∞–µ–º –≤–∞—Ä–∏–∞–Ω—Ç—ã –æ—Ç–≤–µ—Ç–æ–≤
                const shuffledOptions = shuffleArray([...baseData.options]);
                const correctIndex = shuffledOptions.indexOf(baseData.options[baseData.correct]);
                
                questions.push({
                    id: `bio-${i}`,
                    question: questionText,
                    options: shuffledOptions,
                    correct: correctIndex,
                    difficulty: Math.ceil((i + 1) / 25),
                    explanation: "–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–≤–æ–∏ –∑–Ω–∞–Ω–∏—è –≤ –æ–±–ª–∞—Å—Ç–∏ –±–∏–æ–ª–æ–≥–∏–∏."
                });
            }
            
            // –ì—Ä—É–ø–ø–∏—Ä—É–µ–º –≤–æ–ø—Ä–æ—Å—ã –ø–æ —É—Ä–æ–≤–Ω—è–º —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ –¥–ª—è biology
            const groupedQuestions = {};
            questions.forEach(question => {
                const level = question.difficulty;
                if (!groupedQuestions[level]) {
                    groupedQuestions[level] = [];
                }
                groupedQuestions[level].push(question);
            });
            
            return groupedQuestions;
        }

        // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è 100+ –≤–æ–ø—Ä–æ—Å–æ–≤ –¥–ª—è —Ç–µ—Å—Ç–∞ –ø–æ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏
        function generateSpecialtyQuestions() {
            const questions = [];
            
            const baseQuestionTexts = [
                "–ú–Ω–µ –Ω—Ä–∞–≤–∏—Ç—Å—è —Ä–∞–±–æ—Ç–∞—Ç—å —Å –¥–µ—Ç—å–º–∏",
                "–Ø –Ω–µ –±–æ—é—Å—å –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏ –∑–∞ –∂–∏–∑–Ω—å –ø–∞—Ü–∏–µ–Ω—Ç–∞",
                "–ú–Ω–µ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–∞ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–π",
                "–Ø –≥–æ—Ç–æ–≤ –∫ –¥–ª–∏—Ç–µ–ª—å–Ω—ã–º –æ–ø–µ—Ä–∞—Ü–∏—è–º",
                "–ú–Ω–µ –Ω—Ä–∞–≤–∏—Ç—Å—è —Ä–∞–±–æ—Ç–∞—Ç—å —Å –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω—ã–º –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ–º",
                "–Ø —Ö–æ—á—É –∑–∞–Ω–∏–º–∞—Ç—å—Å—è –Ω–∞—É—á–Ω—ã–º–∏ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è–º–∏",
                "–ú–Ω–µ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–∞ –ø—Å–∏—Ö–æ–ª–æ–≥–∏—è –∏ –ø—Å–∏—Ö–∏–∞—Ç—Ä–∏—è",
                "–Ø –≥–æ—Ç–æ–≤ —Ä–∞–±–æ—Ç–∞—Ç—å –≤ —ç–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω—ã—Ö —É—Å–ª–æ–≤–∏—è—Ö",
                "–ú–Ω–µ –Ω—Ä–∞–≤–∏—Ç—Å—è –æ–±—â–∞—Ç—å—Å—è —Å –ø–∞—Ü–∏–µ–Ω—Ç–∞–º–∏",
                "–Ø –≤–Ω–∏–º–∞—Ç–µ–ª–µ–Ω –∫ –º–µ–ª—å—á–∞–π—à–∏–º –¥–µ—Ç–∞–ª—è–º",
                "–ú–µ–Ω—è –ø—Ä–∏–≤–ª–µ–∫–∞–µ—Ç –Ω–µ–æ—Ç–ª–æ–∂–Ω–∞—è –ø–æ–º–æ—â—å",
                "–Ø —Ö–æ—á—É —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å—Å—è –Ω–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–º –æ—Ä–≥–∞–Ω–µ",
                "–ú–Ω–µ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–∞ –ø—Ä–æ—Ñ–∏–ª–∞–∫—Ç–∏—á–µ—Å–∫–∞—è –º–µ–¥–∏—Ü–∏–Ω–∞",
                "–Ø –≥–æ—Ç–æ–≤ –∫ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–º—É –æ–±—É—á–µ–Ω–∏—é",
                "–ú–Ω–µ –Ω—Ä–∞–≤–∏—Ç—Å—è —Ä–∞–±–æ—Ç–∞—Ç—å –≤ –∫–æ–º–∞–Ω–¥–µ",
                "–Ø —Ö–æ—á—É –∑–∞–Ω–∏–º–∞—Ç—å—Å—è —Ä–µ–∞–±–∏–ª–∏—Ç–∞—Ü–∏–µ–π –ø–∞—Ü–∏–µ–Ω—Ç–æ–≤",
                "–ú–µ–Ω—è –ø—Ä–∏–≤–ª–µ–∫–∞–µ—Ç —ç—Å—Ç–µ—Ç–∏—á–µ—Å–∫–∞—è —Å—Ç–æ—Ä–æ–Ω–∞ –º–µ–¥–∏—Ü–∏–Ω—ã",
                "–Ø –≥–æ—Ç–æ–≤ —Ä–∞–±–æ—Ç–∞—Ç—å —Å —Ç—è–∂–µ–ª—ã–º–∏ –±–æ–ª—å–Ω—ã–º–∏",
                "–ú–Ω–µ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–∞ –≥–µ–Ω–µ—Ç–∏–∫–∞ –∏ –Ω–∞—Å–ª–µ–¥—Å—Ç–≤–µ–Ω–Ω—ã–µ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è",
                "–Ø —Ö–æ—á—É —Ä–∞–±–æ—Ç–∞—Ç—å –≤ —Å–µ–ª—å—Å–∫–æ–π –º–µ—Å—Ç–Ω–æ—Å—Ç–∏",
                "–ú–Ω–µ –Ω—Ä–∞–≤–∏—Ç—Å—è –æ–±—É—á–∞—Ç—å –¥—Ä—É–≥–∏—Ö",
                "–Ø –≥–æ—Ç–æ–≤ –∫ –Ω–µ–Ω–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–Ω–æ–º—É —Ä–∞–±–æ—á–µ–º—É –¥–Ω—é",
                "–ú–µ–Ω—è –ø—Ä–∏–≤–ª–µ–∫–∞–µ—Ç –≤—ã—Å–æ–∫–æ—Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—á–Ω–∞—è –º–µ–¥–∏—Ü–∏–Ω–∞",
                "–Ø —Ö–æ—á—É –ø–æ–º–æ–≥–∞—Ç—å –ª—é–¥—è–º —Å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏",
                "–ú–Ω–µ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–∞ —Å–ø–æ—Ä—Ç–∏–≤–Ω–∞—è –º–µ–¥–∏—Ü–∏–Ω–∞",
                "–Ø –≥–æ—Ç–æ–≤ —Ä–∞–±–æ—Ç–∞—Ç—å —Å –∏–Ω—Ñ–µ–∫—Ü–∏–æ–Ω–Ω—ã–º–∏ –±–æ–ª—å–Ω—ã–º–∏",
                "–ú–µ–Ω—è –ø—Ä–∏–≤–ª–µ–∫–∞–µ—Ç —Ö–∏—Ä—É—Ä–≥–∏—è",
                "–Ø —Ö–æ—á—É –∑–∞–Ω–∏–º–∞—Ç—å—Å—è –≤–æ–ø—Ä–æ—Å–∞–º–∏ –ø–∏—Ç–∞–Ω–∏—è",
                "–ú–Ω–µ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–∞ –≥–µ—Ä–∏–∞—Ç—Ä–∏—è (–º–µ–¥–∏—Ü–∏–Ω–∞ –ø–æ–∂–∏–ª—ã—Ö)",
                "–Ø –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ —Å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–µ–π",
                "–ú–Ω–µ –Ω—Ä–∞–≤–∏—Ç—Å—è —Ä–µ—à–∞—Ç—å —Å–ª–æ–∂–Ω—ã–µ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∏–µ –∑–∞–¥–∞—á–∏",
                "–Ø —Ö–æ—á—É —Ä–∞–±–æ—Ç–∞—Ç—å –≤ –º–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω—ã—Ö –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è—Ö",
                "–ú–µ–Ω—è –ø—Ä–∏–≤–ª–µ–∫–∞–µ—Ç –≤–æ–µ–Ω–Ω–∞—è –º–µ–¥–∏—Ü–∏–Ω–∞",
                "–Ø –≥–æ—Ç–æ–≤ –∫ –∫–æ–º–∞–Ω–¥–∏—Ä–æ–≤–∫–∞–º",
                "–ú–Ω–µ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–∞ –æ–Ω–∫–æ–ª–æ–≥–∏—è",
                "–Ø —Ö–æ—á—É –ø–æ–º–æ–≥–∞—Ç—å –∂–µ–Ω—â–∏–Ω–∞–º –∏ –¥–µ—Ç—è–º",
                "–ú–µ–Ω—è –ø—Ä–∏–≤–ª–µ–∫–∞–µ—Ç –Ω–µ–≤—Ä–æ–ª–æ–≥–∏—è",
                "–Ø –≥–æ—Ç–æ–≤ —Ä–∞–±–æ—Ç–∞—Ç—å –≤ –ø–æ–ª–∏–∫–ª–∏–Ω–∏–∫–µ",
                "–ú–Ω–µ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–∞ –∫–∞—Ä–¥–∏–æ–ª–æ–≥–∏—è",
                "–Ø —Ö–æ—á—É –≤–Ω–µ–¥—Ä—è—Ç—å –Ω–æ–≤—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ –≤ –º–µ–¥–∏—Ü–∏–Ω—É"
            ];
            
            // –°–æ–∑–¥–∞–µ–º –≤–∞—Ä–∏–∞—Ü–∏–∏ –≤–æ–ø—Ä–æ—Å–æ–≤
            const questionVariations = [
                "–æ—á–µ–Ω—å ", "–æ—Å–æ–±–µ–Ω–Ω–æ ", "–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ ", "–±–µ–∑—É—Å–ª–æ–≤–Ω–æ ", "–Ω–µ—Å–æ–º–Ω–µ–Ω–Ω–æ ",
                "–≤—Å–µ–≥–¥–∞ ", "—á–∞—Å—Ç–æ ", "–æ–±—ã—á–Ω–æ ", "–∏–Ω–æ–≥–¥–∞ ", "—Ä–µ–¥–∫–æ "
            ];
            
            const questionEndings = [
                "", " –∏ —ç—Ç–æ –º–µ–Ω—è —É–≤–ª–µ–∫–∞–µ—Ç", " —ç—Ç–æ –º–æ–µ –ø—Ä–∏–∑–≤–∞–Ω–∏–µ", " —ç—Ç–æ –º–æ—è —Å—Ç—Ä–∞—Å—Ç—å",
                " –∏ –≥–æ—Ç–æ–≤ —ç—Ç–∏–º –∑–∞–Ω–∏–º–∞—Ç—å—Å—è", " –∏ —Ö–æ—á—É —Ä–∞–∑–≤–∏–≤–∞—Ç—å—Å—è –≤ —ç—Ç–æ–º –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–∏"
            ];
            
            const specialties = [
                "—Ç–µ—Ä–∞–ø–µ–≤—Ç", "—Ö–∏—Ä—É—Ä–≥", "–ø–µ–¥–∏–∞—Ç—Ä", "–∫–∞—Ä–¥–∏–æ–ª–æ–≥", "–Ω–µ–≤—Ä–æ–ª–æ–≥", "–æ—Ñ—Ç–∞–ª—å–º–æ–ª–æ–≥",
                "—Å—Ç–æ–º–∞—Ç–æ–ª–æ–≥", "–ø—Å–∏—Ö–∏–∞—Ç—Ä", "–¥–µ—Ä–º–∞—Ç–æ–ª–æ–≥", "–≥–∏–Ω–µ–∫–æ–ª–æ–≥", "—É—Ä–æ–ª–æ–≥", "–æ—Ä—Ç–æ–ø–µ–¥",
                "–∞–Ω–µ—Å—Ç–µ–∑–∏–æ–ª–æ–≥", "—Ä–µ–∞–Ω–∏–º–∞—Ç–æ–ª–æ–≥", "–∏–Ω—Ñ–µ–∫—Ü–∏–æ–Ω–∏—Å—Ç", "–æ–Ω–∫–æ–ª–æ–≥", "—ç–Ω–¥–æ–∫—Ä–∏–Ω–æ–ª–æ–≥"
            ];
            
            // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º 100+ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –≤–æ–ø—Ä–æ—Å–æ–≤
            for (let i = 0; i < 100; i++) {
                let questionText;
                
                // –ß–µ—Ä–µ–¥—É–µ–º —Ç–∏–ø—ã –≤–æ–ø—Ä–æ—Å–æ–≤
                if (i % 4 === 0) {
                    // –í–æ–ø—Ä–æ—Å—ã –æ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ—Å—Ç—è—Ö
                    const specialty = specialties[i % specialties.length];
                    questionText = `–ú–µ–Ω—è –ø—Ä–∏–≤–ª–µ–∫–∞–µ—Ç —Ä–∞–±–æ—Ç–∞ ${specialty}–∞`;
                } else if (i % 4 === 1) {
                    // –í–æ–ø—Ä–æ—Å—ã –æ –Ω–∞–≤—ã–∫–∞—Ö
                    const skill = ["–∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏", "–∞–Ω–∞–ª–∏–∑–µ", "–ø—Ä–∏–Ω—è—Ç–∏–∏ —Ä–µ—à–µ–Ω–∏–π", "—Ä—É—á–Ω–æ–π —Ä–∞–±–æ—Ç–µ", "–Ω–∞–±–ª—é–¥–µ–Ω–∏–∏"][i % 5];
                    questionText = `–Ø —Ö–æ—Ä–æ—à –≤ ${skill}`;
                } else if (i % 4 === 2) {
                    // –ë–∞–∑–æ–≤—ã–µ –≤–æ–ø—Ä–æ—Å—ã —Å –≤–∞—Ä–∏–∞—Ü–∏—è–º–∏
                    const baseText = baseQuestionTexts[i % baseQuestionTexts.length];
                    const variation = questionVariations[i % questionVariations.length];
                    questionText = "–Ø " + variation + baseText.toLowerCase();
                } else {
                    // –í–æ–ø—Ä–æ—Å—ã –æ–± —É—Å–ª–æ–≤–∏—è—Ö —Ä–∞–±–æ—Ç—ã
                    const condition = ["–Ω–æ—á–Ω—ã–µ –¥–µ–∂—É—Ä—Å—Ç–≤–∞", "—ç–∫—Å—Ç—Ä–µ–Ω–Ω—ã–µ –≤—ã–∑–æ–≤—ã", "—Ä–∞–±–æ—Ç–∞ –≤ –∫–æ–º–∞–Ω–¥–µ", "–¥–ª–∏—Ç–µ–ª—å–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏", "–æ–±—â–µ–Ω–∏–µ —Å –ø–∞—Ü–∏–µ–Ω—Ç–∞–º–∏"][i % 5];
                    questionText = `–Ø –≥–æ—Ç–æ–≤ –∫ ${condition}`;
                }
                
                // –î–æ–±–∞–≤–ª—è–µ–º –æ–∫–æ–Ω—á–∞–Ω–∏—è –∫ –Ω–µ–∫–æ—Ç–æ—Ä—ã–º –≤–æ–ø—Ä–æ—Å–∞–º
                if (i % 3 === 0 && questionEndings[i % questionEndings.length]) {
                    questionText += questionEndings[i % questionEndings.length];
                }
                
                questions.push({
                    id: `spec-${i}`,
                    question: questionText,
                    options: [
                        "–ü–æ–ª–Ω–æ—Å—Ç—å—é —Å–æ–≥–ª–∞—Å–µ–Ω",
                        "–°–∫–æ—Ä–µ–µ —Å–æ–≥–ª–∞—Å–µ–Ω", 
                        "–ó–∞—Ç—Ä—É–¥–Ω—è—é—Å—å –æ—Ç–≤–µ—Ç–∏—Ç—å",
                        "–°–∫–æ—Ä–µ–µ –Ω–µ —Å–æ–≥–ª–∞—Å–µ–Ω",
                        "–ü–æ–ª–Ω–æ—Å—Ç—å—é –Ω–µ —Å–æ–≥–ª–∞—Å–µ–Ω"
                    ],
                    correct: 0, // –î–ª—è –ø—Ä–æ—Ñ–æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏–∏ –Ω–µ—Ç "–ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ" –æ—Ç–≤–µ—Ç–∞, –Ω–æ —Å–∏—Å—Ç–µ–º–∞ —Ç—Ä–µ–±—É–µ—Ç —ç—Ç–æ –ø–æ–ª–µ
                    difficulty: Math.ceil((i + 1) / 20), // –ì—Ä—É–ø–ø–∏—Ä—É–µ–º –ø–æ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏
                    explanation: "–≠—Ç–æ—Ç –≤–æ–ø—Ä–æ—Å –ø–æ–º–æ–∂–µ—Ç –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –≤–∞—à–∏ –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏—è –≤ –≤—ã–±–æ—Ä–µ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–æ–π —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏."
                });
            }
            
            // –í–æ–∑–≤—Ä–∞—â–∞–µ–º –≤ —Ñ–æ—Ä–º–∞—Ç–µ, –∫–æ—Ç–æ—Ä—ã–π –æ–∂–∏–¥–∞–µ—Ç AdaptiveTestSystem
            // –ì—Ä—É–ø–ø–∏—Ä—É–µ–º –≤–æ–ø—Ä–æ—Å—ã –ø–æ —É—Ä–æ–≤–Ω—è–º —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ (–∫–∞–∫ –≤ biology, chemistry)
            const groupedQuestions = {};
            questions.forEach(question => {
                const level = question.difficulty;
                if (!groupedQuestions[level]) {
                    groupedQuestions[level] = [];
                }
                groupedQuestions[level].push(question);
            });
            
            return groupedQuestions;
        }

        // –ù–∞—á–∞—Ç—å —Ç–µ—Å—Ç - –ò–°–ü–†–ê–í–õ–ï–ù–û: –ë–ï–†–ï–ú –°–õ–£–ß–ê–ô–ù–´–ï 40 –í–û–ü–†–û–°–û–í
        // –°—Ç–∞—Ä–∞—è —Ñ—É–Ω–∫—Ü–∏—è startTest —É–¥–∞–ª–µ–Ω–∞ - –∏—Å–ø–æ–ª—å–∑—É–µ–º –Ω–æ–≤—É—é –∞–¥–∞–ø—Ç–∏–≤–Ω—É—é —Å–∏—Å—Ç–µ–º—É

        // –ó–∞–≥—Ä—É–∑–∏—Ç—å –≤–æ–ø—Ä–æ—Å
        function loadQuestion() {
            const question = currentTestQuestions[currentQuestionIndex];
            
            // –û–±–Ω–æ–≤–∏—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å
            const progress = ((currentQuestionIndex + 1) / 40) * 100;
            document.getElementById('test-progress').style.width = `${progress}%`;
            document.getElementById('progress-text').textContent = `–í–æ–ø—Ä–æ—Å ${currentQuestionIndex + 1} –∏–∑ 40`;
            
            // –û–±–Ω–æ–≤–∏—Ç—å –ø–∞–Ω–µ–ª—å –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
            updateQuestionNav();
            
            // –°–æ–∑–¥–∞—Ç—å HTML –¥–ª—è –≤–æ–ø—Ä–æ—Å–∞
            let html = `
                <div class="question-container">
                    <div class="question-header">
                        <div class="question-number">–í–æ–ø—Ä–æ—Å ${currentQuestionIndex + 1} –∏–∑ 40</div>
                        <div class="question-actions">
                            <button class="question-action-btn mark" onclick="markQuestion()" id="mark-question-btn">
                                ${markedQuestions[currentQuestionIndex] ? '‚òÖ –°–Ω—è—Ç—å –æ—Ç–º–µ—Ç–∫—É' : '‚òÜ –û—Ç–º–µ—Ç–∏—Ç—å –≤–æ–ø—Ä–æ—Å'}
                            </button>
                        </div>
                    </div>
                    <div class="question-text">${question.text}</div>
                    <div class="options">
            `;
            
            // –î–æ–±–∞–≤–∏—Ç—å –≤–∞—Ä–∏–∞–Ω—Ç—ã –æ—Ç–≤–µ—Ç–æ–≤
            question.options.forEach((option, index) => {
                const isSelected = testAnswers[currentQuestionIndex] === option.id;
                html += `
                    <div class="option ${isSelected ? 'selected' : ''}" onclick="selectAnswer(${index})">
                        <input type="radio" name="question-${currentQuestionIndex}" value="${option.id}" ${isSelected ? 'checked' : ''}>
                        ${option.text}
                    </div>
                `;
            });
            
            html += `</div></div>`;
            
            document.getElementById('questions-container').innerHTML = html;
            
            // –û–±–Ω–æ–≤–∏—Ç—å –∫–Ω–æ–ø–∫–∏
            document.getElementById('prev-btn').style.display = currentQuestionIndex > 0 ? 'flex' : 'none';
            document.getElementById('next-btn').style.display = currentQuestionIndex < 39 ? 'flex' : 'none';
            document.getElementById('check-btn').style.display = currentQuestionIndex === 39 ? 'flex' : 'none';
            
            // –û–±–Ω–æ–≤–∏—Ç—å –∫–Ω–æ–ø–∫—É –æ—Ç–º–µ—Ç–∫–∏
            const markBtn = document.getElementById('mark-question-btn');
            if (markBtn) {
                markBtn.textContent = markedQuestions[currentQuestionIndex] ? '‚òÖ –°–Ω—è—Ç—å –æ—Ç–º–µ—Ç–∫—É' : '‚òÜ –û—Ç–º–µ—Ç–∏—Ç—å –≤–æ–ø—Ä–æ—Å';
                markBtn.style.backgroundColor = markedQuestions[currentQuestionIndex] ? '#9c27b0' : '#f0f0f0';
                markBtn.style.color = markedQuestions[currentQuestionIndex] ? 'white' : '#333';
            }
            
            // –£–±–∏—Ä–∞–µ–º –∞–≤—Ç–æ–ø—Ä–æ–∫—Ä—É—Ç–∫—É, —á—Ç–æ–±—ã –Ω–µ –±—ã–ª–æ –¥—Ä–æ–∂–∞–Ω–∏—è –ø—Ä–∏ —Å–∫—Ä–æ–ª–ª–µ
        }

        // –û–±–Ω–æ–≤–∏—Ç—å –ø–∞–Ω–µ–ª—å –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ –ø–æ –≤–æ–ø—Ä–æ—Å–∞–º
        function updateQuestionNav() {
            const navContainer = document.getElementById('question-nav');
            if (!navContainer) return;
            
            navContainer.innerHTML = '';
            
            for (let i = 0; i < 40; i++) {
                const btn = document.createElement('button');
                btn.className = 'question-nav-btn';
                btn.textContent = i + 1;
                
                // –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –≤–æ–ø—Ä–æ—Å–∞
                if (i === currentQuestionIndex) {
                    btn.classList.add('current');
                } else if (markedQuestions[i]) {
                    btn.classList.add('marked');
                } else if (testAnswers[i] !== undefined) {
                    btn.classList.add('answered');
                } else {
                    btn.classList.add('empty');
                }
                
                btn.addEventListener('click', () => {
                    currentQuestionIndex = i;
                    loadQuestion();
                });
                
                navContainer.appendChild(btn);
            }
        }

        // –û—Ç–º–µ—Ç–∏—Ç—å –≤–æ–ø—Ä–æ—Å
        function markQuestion() {
            markedQuestions[currentQuestionIndex] = !markedQuestions[currentQuestionIndex];
            
            // –û–±–Ω–æ–≤–∏—Ç—å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ
            const markBtn = document.getElementById('mark-question-btn');
            if (markBtn) {
                markBtn.textContent = markedQuestions[currentQuestionIndex] ? '‚òÖ –°–Ω—è—Ç—å –æ—Ç–º–µ—Ç–∫—É' : '‚òÜ –û—Ç–º–µ—Ç–∏—Ç—å –≤–æ–ø—Ä–æ—Å';
                markBtn.style.backgroundColor = markedQuestions[currentQuestionIndex] ? '#9c27b0' : '#f0f0f0';
                markBtn.style.color = markedQuestions[currentQuestionIndex] ? 'white' : '#333';
                
                // –ê–Ω–∏–º–∞—Ü–∏—è
                markBtn.style.animation = 'pulse 0.5s';
                setTimeout(() => {
                    markBtn.style.animation = '';
                }, 500);
            }
            
            // –û–±–Ω–æ–≤–∏—Ç—å –ø–∞–Ω–µ–ª—å –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
            updateQuestionNav();
            
            // –ü–æ–∫–∞–∑–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
            if (markedQuestions[currentQuestionIndex]) {
                showNotification('–í–æ–ø—Ä–æ—Å –æ—Ç–º–µ—á–µ–Ω!', 'success');
            } else {
                showNotification('–û—Ç–º–µ—Ç–∫–∞ —Å–Ω—è—Ç–∞', 'info');
            }
        }

        // –û—á–∏—Å—Ç–∏—Ç—å —Ç–µ–∫—É—â–∏–π –æ—Ç–≤–µ—Ç
        function clearCurrentAnswer() {
            if (testAnswers[currentQuestionIndex] !== undefined) {
                delete testAnswers[currentQuestionIndex];
                
                // –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å –≤–æ–ø—Ä–æ—Å
                loadQuestion();
                
                // –ü–æ–∫–∞–∑–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
                showNotification('–û—Ç–≤–µ—Ç –æ—á–∏—â–µ–Ω', 'warning');
            } else {
                showNotification('–ù–µ—Ç –æ—Ç–≤–µ—Ç–∞ –¥–ª—è –æ—á–∏—Å—Ç–∫–∏', 'info');
            }
        }

        // –ü–µ—Ä–µ–π—Ç–∏ –∫ –ø–µ—Ä–≤–æ–º—É –ø—Ä–æ–ø—É—â–µ–Ω–Ω–æ–º—É –≤–æ–ø—Ä–æ—Å—É
        function goToFirstSkipped() {
            // –ò—â–µ–º –ø–µ—Ä–≤—ã–π –≤–æ–ø—Ä–æ—Å –±–µ–∑ –æ—Ç–≤–µ—Ç–∞
            for (let i = 0; i < 40; i++) {
                if (testAnswers[i] === undefined) {
                    currentQuestionIndex = i;
                    loadQuestion();
                    
                    // –ü–æ–∫–∞–∑–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
                    showNotification(`–ü–µ—Ä–µ—Ö–æ–¥ –∫ –ø—Ä–æ–ø—É—â–µ–Ω–Ω–æ–º—É –≤–æ–ø—Ä–æ—Å—É ${i + 1}`, 'info');
                    return;
                }
            }
            
            // –ï—Å–ª–∏ –≤—Å–µ –≤–æ–ø—Ä–æ—Å—ã –æ—Ç–≤–µ—á–µ–Ω—ã, –∏—â–µ–º –ø–µ—Ä–≤—ã–π –æ—Ç–º–µ—á–µ–Ω–Ω—ã–π
            for (let i = 0; i < 40; i++) {
                if (markedQuestions[i]) {
                    currentQuestionIndex = i;
                    loadQuestion();
                    
                    // –ü–æ–∫–∞–∑–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
                    showNotification(`–ü–µ—Ä–µ—Ö–æ–¥ –∫ –æ—Ç–º–µ—á–µ–Ω–Ω–æ–º—É –≤–æ–ø—Ä–æ—Å—É ${i + 1}`, 'info');
                    return;
                }
            }
            
            // –ï—Å–ª–∏ –≤—Å–µ –≤–æ–ø—Ä–æ—Å—ã –æ—Ç–≤–µ—á–µ–Ω—ã –∏ –Ω–µ –æ—Ç–º–µ—á–µ–Ω—ã
            showNotification('–í—Å–µ –≤–æ–ø—Ä–æ—Å—ã –æ—Ç–≤–µ—á–µ–Ω—ã!', 'success');
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
        function showNotification(message, type) {
            // –°–æ–∑–¥–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
            const notification = document.createElement('div');
            notification.textContent = message;
            notification.style.position = 'fixed';
            notification.style.top = '20px';
            notification.style.right = '20px';
            notification.style.padding = '15px 20px';
            notification.style.borderRadius = '10px';
            notification.style.color = 'white';
            notification.style.fontWeight = '600';
            notification.style.zIndex = '1000';
            notification.style.boxShadow = '0 5px 15px rgba(0,0,0,0.2)';
            notification.style.animation = 'fadeIn 0.3s, slideIn 0.3s';
            
            // –¶–≤–µ—Ç –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–∏–ø–∞
            switch(type) {
                case 'success':
                    notification.style.background = 'linear-gradient(90deg, #4CAF50, #8BC34A)';
                    break;
                case 'warning':
                    notification.style.background = 'linear-gradient(90deg, #ff9800, #ffc107)';
                    break;
                case 'danger':
                    notification.style.background = 'linear-gradient(90deg, #ff6b6b, #ff5252)';
                    break;
                case 'info':
                default:
                    notification.style.background = 'linear-gradient(90deg, #667eea, #764ba2)';
            }
            
            document.body.appendChild(notification);
            
            // –£–¥–∞–ª—è–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã
            setTimeout(() => {
                notification.style.animation = 'fadeIn 0.3s reverse';
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.parentNode.removeChild(notification);
                    }
                }, 300);
            }, 3000);
        }

        // –í—ã–±—Ä–∞—Ç—å –æ—Ç–≤–µ—Ç
        function selectAnswer(optionIndex) {
            const question = currentTestQuestions[currentQuestionIndex];
            const option = question.options[optionIndex];
            
            // –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –æ—Ç–≤–µ—Ç
            testAnswers[currentQuestionIndex] = option.id;
            
            // –ê–Ω–∏–º–∞—Ü–∏—è –≤—ã–±–æ—Ä–∞
            const selectedOption = document.querySelectorAll('.option')[optionIndex];
            selectedOption.style.animation = 'pulse 0.3s';
            setTimeout(() => {
                selectedOption.style.animation = '';
            }, 300);
            
            // –û–±–Ω–æ–≤–∏—Ç—å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ
            document.querySelectorAll('.option').forEach((opt, idx) => {
                if (idx === optionIndex) {
                    opt.classList.add('selected');
                    opt.querySelector('input').checked = true;
                } else {
                    opt.classList.remove('selected');
                    opt.querySelector('input').checked = false;
                }
            });
            
            // –û–±–Ω–æ–≤–∏—Ç—å –ø–∞–Ω–µ–ª—å –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
            updateQuestionNav();
        }

        // –°–ª–µ–¥—É—é—â–∏–π –≤–æ–ø—Ä–æ—Å
        function nextQuestion() {
            if (currentQuestionIndex < 39) {
                currentQuestionIndex++;
                loadQuestion();
            }
        }

        // –ü—Ä–µ–¥—ã–¥—É—â–∏–π –≤–æ–ø—Ä–æ—Å
        function prevQuestion() {
            if (currentQuestionIndex > 0) {
                currentQuestionIndex--;
                loadQuestion();
            }
        }

        // –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∞
        function checkTestResults() {
            // –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, –≤—Å–µ –ª–∏ –≤–æ–ø—Ä–æ—Å—ã –æ—Ç–≤–µ—á–µ–Ω—ã
            const answeredCount = Object.keys(testAnswers).length;
            
            if (answeredCount < 40) {
                const confirmSkip = confirm(`–í—ã –æ—Ç–≤–µ—Ç–∏–ª–∏ —Ç–æ–ª—å–∫–æ –Ω–∞ ${answeredCount} –∏–∑ 40 –≤–æ–ø—Ä–æ—Å–æ–≤. ${40 - answeredCount} –≤–æ–ø—Ä–æ—Å–æ–≤ –æ—Å—Ç–∞–ª–∏—Å—å –±–µ–∑ –æ—Ç–≤–µ—Ç–∞. –•–æ—Ç–∏—Ç–µ –≤—Å–µ —Ä–∞–≤–Ω–æ –∑–∞–≤–µ—Ä—à–∏—Ç—å —Ç–µ—Å—Ç?`);
                if (!confirmSkip) {
                    // –ü–µ—Ä–µ—Ö–æ–¥–∏–º –∫ –ø–µ—Ä–≤–æ–º—É –ø—Ä–æ–ø—É—â–µ–Ω–Ω–æ–º—É –≤–æ–ø—Ä–æ—Å—É
                    goToFirstSkipped();
                    return;
                }
            }
            
            let score = 0;
            let maxScore = 0;
            
            // –ü–æ–¥—Å—á–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–∏–ø–∞ —Ç–µ—Å—Ç–∞
            if (currentTestType === 'profession' || currentTestType === 'specialty') {
                // –¢–µ—Å—Ç—ã —Å –æ—Ü–µ–Ω–∫–æ–π –æ—Ç 1 –¥–æ 5
                currentTestQuestions.forEach((question, index) => {
                    const answerId = testAnswers[index];
                    const selectedOption = question.options.find(opt => opt.id === answerId);
                    if (selectedOption) {
                        score += selectedOption.value;
                    }
                    maxScore += 5; // –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –±–∞–ª–ª –∑–∞ –≤–æ–ø—Ä–æ—Å
                });
                
                const percentage = Math.round((score / maxScore) * 100);
                
                // –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç
                let title, message;
                if (percentage >= 80) {
                    title = "–û—Ç–ª–∏—á–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç! üéâ";
                    message = "–£ –≤–∞—Å —è–≤–Ω–∞—è —Å–∫–ª–æ–Ω–Ω–æ—Å—Ç—å –∫ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–æ–π –ø—Ä–æ—Ñ–µ—Å—Å–∏–∏. –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º —Ä–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å –ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏–µ –≤ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–π –≤—É–∑. –í–∞—à–∏ —Å–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã: –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å, —ç–º–ø–∞—Ç–∏—è, –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ –æ–±—É—á–µ–Ω–∏—é.";
                } else if (percentage >= 60) {
                    title = "–•–æ—Ä–æ—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç! üëç";
                    message = "–í—ã –ø—Ä–æ—è–≤–ª—è–µ—Ç–µ –∏–Ω—Ç–µ—Ä–µ—Å –∫ –º–µ–¥–∏—Ü–∏–Ω–µ. –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –∏–∑—É—á–∏—Ç—å –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–µ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏, –ø—Ä–æ–π—Ç–∏ –ø—Ä–∞–∫—Ç–∏–∫—É –≤ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–æ–º —É—á—Ä–µ–∂–¥–µ–Ω–∏–∏ –¥–ª—è –±–æ–ª–µ–µ –æ—Å–æ–∑–Ω–∞–Ω–Ω–æ–≥–æ –≤—ã–±–æ—Ä–∞.";
                } else if (percentage >= 40) {
                    title = "–°—Ä–µ–¥–Ω–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç ü§î";
                    message = "–í–∞—à–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç —É–º–µ—Ä–µ–Ω–Ω—ã–π –∏–Ω—Ç–µ—Ä–µ—Å –∫ –º–µ–¥–∏—Ü–∏–Ω–µ. –†–∞—Å—Å–º–æ—Ç—Ä–∏—Ç–µ —Å–º–µ–∂–Ω—ã–µ –ø—Ä–æ—Ñ–µ—Å—Å–∏–∏ (–º–µ–¥–∏—Ü–∏–Ω—Å–∫–∞—è –æ–ø—Ç–∏–∫–∞, —Ñ–∞—Ä–º–∞—Ü–∏—è, –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∞—è —Ç–µ—Ö–Ω–∏–∫–∞) –∏–ª–∏ –ø—Ä–æ–π–¥–∏—Ç–µ –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—é —É –∫–∞—Ä—å–µ—Ä–Ω–æ–≥–æ –ø—Å–∏—Ö–æ–ª–æ–≥–∞.";
                } else {
                    title = "–ù–∏–∑–∫–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç üí≠";
                    message = "–í–æ–∑–º–æ–∂–Ω–æ, –º–µ–¥–∏—Ü–∏–Ω–∞ - –Ω–µ –≤–∞—à –ø—Ä–æ—Ñ–∏–ª—å. –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º –ø—Ä–æ–π—Ç–∏ –¥—Ä—É–≥–∏–µ —Ç–µ—Å—Ç—ã –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã—Ö —Å–∫–ª–æ–Ω–Ω–æ—Å—Ç–µ–π –∏ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å –¥—Ä—É–≥–∏–µ –æ–±–ª–∞—Å—Ç–∏ (–∏–Ω–∂–µ–Ω–µ—Ä–∏—è, IT, –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –Ω–∞—É–∫–∏).";
                }
                
                document.getElementById('result-score').textContent = `${percentage}%`;
                document.getElementById('result-title').textContent = title;
                document.getElementById('result-message').textContent = message;
                
            } else if (currentTestType === 'chemistry' || currentTestType === 'biology') {
                // –¢–µ—Å—Ç—ã —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏/–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –æ—Ç–≤–µ—Ç–∞–º–∏
                let correctAnswers = 0;
                
                currentTestQuestions.forEach((question, index) => {
                    const answerId = testAnswers[index];
                    const selectedOption = question.options.find(opt => opt.id === answerId);
                    if (selectedOption && selectedOption.value === question.correct) {
                        correctAnswers++;
                    }
                });
                
                const percentage = Math.round((correctAnswers / 40) * 100);
                
                // –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç
                let title, message;
                if (percentage >= 80) {
                    title = "–û—Ç–ª–∏—á–Ω—ã–µ –∑–Ω–∞–Ω–∏—è! üéâ";
                    message = `–í—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ—Ç–≤–µ—Ç–∏–ª–∏ –Ω–∞ ${correctAnswers} –∏–∑ 40 –≤–æ–ø—Ä–æ—Å–æ–≤. –í–∞—à–∏ –∑–Ω–∞–Ω–∏—è –¥–æ—Å—Ç–∞—Ç–æ—á–Ω—ã –¥–ª—è –ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏—è –≤ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–π –≤—É–∑. –ü—Ä–æ–¥–æ–ª–∂–∞–π—Ç–µ —É–≥–ª—É–±–ª—è—Ç—å –∑–Ω–∞–Ω–∏—è –ø–æ –ø—Ä–µ–¥–º–µ—Ç—É.`;
                } else if (percentage >= 60) {
                    title = "–•–æ—Ä–æ—à–∏–µ –∑–Ω–∞–Ω–∏—è! üëç";
                    message = `–í—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ—Ç–≤–µ—Ç–∏–ª–∏ –Ω–∞ ${correctAnswers} –∏–∑ 40 –≤–æ–ø—Ä–æ—Å–æ–≤. –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º –ø–æ–¥—Ç—è–Ω—É—Ç—å –∑–Ω–∞–Ω–∏—è –¥–ª—è —É—Å–ø–µ—à–Ω–æ–π —Å–¥–∞—á–∏ —ç–∫–∑–∞–º–µ–Ω–æ–≤. –û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ —Ç–µ–º—ã, –∫–æ—Ç–æ—Ä—ã–µ –≤—ã–∑–≤–∞–ª–∏ –∑–∞—Ç—Ä—É–¥–Ω–µ–Ω–∏—è.`;
                } else if (percentage >= 40) {
                    title = "–°—Ä–µ–¥–Ω–∏–π —É—Ä–æ–≤–µ–Ω—å üìö";
                    message = `–í—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ—Ç–≤–µ—Ç–∏–ª–∏ –Ω–∞ ${correctAnswers} –∏–∑ 40 –≤–æ–ø—Ä–æ—Å–æ–≤. –ù–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–µ—Ä—å–µ–∑–Ω–æ –∑–∞–Ω—è—Ç—å—Å—è –ø–æ–¥–≥–æ—Ç–æ–≤–∫–æ–π. –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º –Ω–∞—á–∞—Ç—å —Å –±–∞–∑–æ–≤—ã—Ö –ø–æ–Ω—è—Ç–∏–π –∏ –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç—å –∫ –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω—ã–º —Ç–µ–º–∞–º.`;
                } else {
                    title = "–ù–∏–∑–∫–∏–π —É—Ä–æ–≤–µ–Ω—å üí≠";
                    message = `–í—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ—Ç–≤–µ—Ç–∏–ª–∏ –Ω–∞ ${correctAnswers} –∏–∑ 40 –≤–æ–ø—Ä–æ—Å–æ–≤. –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º –Ω–∞—á–∞—Ç—å –∏–∑—É—á–µ–Ω–∏–µ –ø—Ä–µ–¥–º–µ—Ç–∞ —Å –æ—Å–Ω–æ–≤. –í–æ–∑–º–æ–∂–Ω–æ, –≤–∞–º —Å—Ç–æ–∏—Ç —Ä–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å —Ä–µ–ø–µ—Ç–∏—Ç–æ—Ä–∞ –∏–ª–∏ –æ–Ω–ª–∞–π–Ω-–∫—É—Ä—Å—ã –¥–ª—è —Å–∏—Å—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏.`;
                }
                
                document.getElementById('result-score').textContent = `${percentage}%`;
                document.getElementById('result-title').textContent = title;
                document.getElementById('result-message').textContent = message;
            }
            
            // –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –¥–ª—è —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            const currentUser = JSON.parse(localStorage.getItem(CURRENT_USER_KEY));
            if (currentUser) {
                if (!currentUser.testResults) {
                    currentUser.testResults = {};
                }
                
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã –¥–ª—è –∏—Å—Ç–æ—Ä–∏–∏
                const usedQuestions = currentTestQuestions.map(q => q.id);
                
                currentUser.testResults[currentTestType + '_' + Date.now()] = {
                    date: new Date().toISOString(),
                    score: score,
                    maxScore: maxScore,
                    answers: testAnswers,
                    markedQuestions: markedQuestions,
                    usedQuestions: usedQuestions,
                    testType: currentTestType
                };
                
                // –û–±–Ω–æ–≤–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ localStorage
                localStorage.setItem(CURRENT_USER_KEY, JSON.stringify(currentUser));
                
                // –û–±–Ω–æ–≤–∏—Ç—å –≤ –æ–±—â–µ–º —Å–ø–∏—Å–∫–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
                const users = JSON.parse(localStorage.getItem(USERS_KEY));
                const userIndex = users.findIndex(u => u.id === currentUser.id);
                if (userIndex !== -1) {
                    users[userIndex] = currentUser;
                    localStorage.setItem(USERS_KEY, JSON.stringify(users));
                }
                
                // –û–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –≤ –ø—Ä–æ—Ñ–∏–ª–µ
                updateUserStats(currentUser);
                loadTestHistory(currentUser);
            }
            
            // –ü–æ–∫–∞–∑–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
            document.getElementById('test-questions-container').classList.remove('active');
            document.getElementById('test-results').classList.add('show');
            
            // –ü–ª–∞–≤–Ω–∞—è –ø—Ä–æ–∫—Ä—É—Ç–∫–∞ –∫ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º
            setTimeout(() => {
                document.getElementById('test-results').scrollIntoView({ behavior: 'smooth' });
            }, 100);
            
            // –ü–æ–∫–∞–∑–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
            showNotification('–¢–µ—Å—Ç –∑–∞–≤–µ—Ä—à–µ–Ω! –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã.', 'success');
        }

        // –ü–æ–º–æ—â—å —Å –≤–≤–æ–¥–æ–º –∫–æ–¥–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è
        function moveToNext(input, nextIndex) {
            if (input.value.length === 1) {
                const inputs = document.querySelectorAll('.code-inputs input');
                if (nextIndex < inputs.length) {
                    inputs[nextIndex].focus();
                }
            }
        }

        function moveOnBackspace(input, prevIndex) {
            if (input.value.length === 0 && event.key === 'Backspace') {
                const inputs = document.querySelectorAll('.code-inputs input');
                if (prevIndex >= 0) {
                    inputs[prevIndex].focus();
                }
            }
        }

        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        window.addEventListener('DOMContentLoaded', () => {
            console.log('DOMContentLoaded fired');
            
            // –ó–∞–≥—Ä—É–∑–∫–∞ —Ç–µ–º—ã
            loadTheme();
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–ª–∞–≤–∞—é—â–∏—Ö —Ü–≤–µ—Ç–æ–≤
            initFloatingFlowers();
            
            try {
                const currentUser = JSON.parse(localStorage.getItem(CURRENT_USER_KEY));
                console.log('Current user:', currentUser);
                
                if (currentUser) {
                    console.log('User found, showing main content');
                    showMainContent(currentUser);
                } else {
                    console.log('No current user found, showing auth');
                    document.getElementById('auth-container').style.display = 'flex';
                    document.getElementById('main-content').style.display = 'none';
                }
            } catch (e) {
                console.error('Error loading user data:', e);
                document.getElementById('auth-container').style.display = 'flex';
                document.getElementById('main-content').style.display = 'none';
            }
        });
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–ª–∞–≤–∞—é—â–∏—Ö —Ü–≤–µ—Ç–æ–≤
        function initFloatingFlowers() {
            const container = document.getElementById('floatingFlowers');
            if (!container) return;
            
            // –î–æ–±–∞–≤–ª—è–µ–º —Å–ª—É—á–∞–π–Ω—ã–µ –ø–æ–∑–∏—Ü–∏–∏ –¥–ª—è —Ü–≤–µ—Ç–æ–≤
            const flowers = container.querySelectorAll('.flower');
            flowers.forEach((flower, i) => {
                flower.style.animationDuration = `${15 + Math.random() * 20}s`;
                flower.style.animationDelay = `${Math.random() * 10}s`;
                flower.style.left = `${(i * 10) + Math.random() * 5}%`;
            });
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ç–µ—Å—Ç–æ–≤ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        window.addEventListener('load', () => {
            initializeTests();
        });

        // –ö–Ω–æ–ø–∫–∞ "–ù–∞–≤–µ—Ä—Ö"
        const backToTopBtn = document.createElement('button');
        backToTopBtn.innerHTML = '<i class="fas fa-chevron-up"></i>';
        backToTopBtn.className = 'back-to-top';
        backToTopBtn.title = '–ù–∞–≤–µ—Ä—Ö';
        document.body.appendChild(backToTopBtn);

        window.addEventListener('scroll', () => {
            if (window.pageYOffset > 300) {
                backToTopBtn.classList.add('visible');
            } else {
                backToTopBtn.classList.remove('visible');
            }
        });

        backToTopBtn.addEventListener('click', () => {
            window.scrollTo({
                top: 0,
                behavior: 'smooth'
            });
        });

        // ==============================
        // –ë–ê–ù–ö –í–û–ü–†–û–°–û–í (–ü–û –ö–õ–ê–°–°–ê–ú)
        // –¢–æ–ª—å–∫–æ 4 —Ä–∞–∑–¥–µ–ª–∞: –ø—Ä–æ—Ñ–æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏—è, –º–µ–¥.–ø—Ä–æ—Ñ–æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏—è, —Ö–∏–º–∏—è, –±–∏–æ–ª–æ–≥–∏—è
        // ==============================

        const LIKERT_5 = [
            '–°–æ–≤—Å–µ–º –Ω–µ –ø—Ä–æ –º–µ–Ω—è',
            '–°–∫–æ—Ä–µ–µ –Ω–µ—Ç',
            '–ù–µ–π—Ç—Ä–∞–ª—å–Ω–æ',
            '–°–∫–æ—Ä–µ–µ –¥–∞',
            '–û—á–µ–Ω—å –ø–æ—Ö–æ–∂–µ –Ω–∞ –º–µ–Ω—è'
        ];

        function clamp(n, min, max) {
            return Math.max(min, Math.min(max, n));
        }

        function stableId(prefix, idx) {
            return `${prefix}_${idx}`;
        }

        function normalizeBandLabel(bandStartGrade) {
            const g = parseInt(bandStartGrade, 10);
            if (g <= 4) return '1-4';
            if (g <= 6) return '5-6';
            if (g <= 8) return '7-8';
            if (g === 9) return '9';
            return '10-11';
        }

        function isOrientationSubjectId(subjectId) {
            if (!subjectId) return false;
            return (
                subjectId === 'profession' ||
                subjectId.startsWith('profession_general_') ||
                subjectId.startsWith('profession_med_')
            );
        }

        function makeLikertQuestion({ id, question, dimension, gradeBand, subject = 'profession' }) {
            return {
                id,
                kind: 'likert',
                question,
                options: LIKERT_5,
                // –î–ª—è –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –∞–¥–∞–ø—Ç–∏–≤–Ω–æ–π —Å–ª–æ–∂–Ω–æ—Å—Ç–∏
                difficulty: gradeBand === '1-4' ? 1 : gradeBand === '5-6' ? 1 : gradeBand === '7-8' ? 2 : gradeBand === '9' ? 3 : 4,
                dimension,
                gradeBand,
                subject,
                explanation: '–í –ø—Ä–æ—Ñ–æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏–æ–Ω–Ω—ã—Ö –≤–æ–ø—Ä–æ—Å–∞—Ö –Ω–µ—Ç ¬´–ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö¬ª –æ—Ç–≤–µ—Ç–æ–≤ ‚Äî –≤–∞–∂–Ω–æ –æ—Ç–≤–µ—á–∞—Ç—å —á–µ—Å—Ç–Ω–æ.'
            };
        }

        function generateProfessionGeneralQuestions(bandStartGrade, desiredCount = 64) {
            const band = normalizeBandLabel(bandStartGrade);
            const dims = {
                people: '–û–±—â–µ–Ω–∏–µ –∏ –ø–æ–º–æ—â—å –ª—é–¥—è–º',
                analysis: '–ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –∏ —Å–∏—Å—Ç–µ–º–Ω–æ–µ –º—ã—à–ª–µ–Ω–∏–µ',
                creativity: '–¢–≤–æ—Ä—á–µ—Å—Ç–≤–æ –∏ –∏–¥–µ–∏',
                practice: '–ü—Ä–∞–∫—Ç–∏–∫–∞ –∏ ¬´–¥–µ–ª–∞—Ç—å —Ä—É–∫–∞–º–∏¬ª',
                leadership: '–û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è –∏ –ª–∏–¥–µ—Ä—Å—Ç–≤–æ',
                responsibility: '–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å –∏ –¥–∏—Å—Ü–∏–ø–ª–∏–Ω–∞'
            };

            const statementsByBand = {
                '1-4': [
                    ['people', '–ú–Ω–µ –Ω—Ä–∞–≤–∏—Ç—Å—è –ø–æ–º–æ–≥–∞—Ç—å –æ–¥–Ω–æ–∫–ª–∞—Å—Å–Ω–∏–∫–∞–º –∏ –¥—Ä—É–∑—å—è–º.'],
                    ['people', '–ú–Ω–µ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ —Å–ª—É—à–∞—Ç—å –ª—é–¥–µ–π –∏ –ø–æ–Ω–∏–º–∞—Ç—å –∏—Ö –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ.'],
                    ['practice', '–ú–Ω–µ –Ω—Ä–∞–≤–∏—Ç—Å—è —á—Ç–æ-—Ç–æ —Å–æ–±–∏—Ä–∞—Ç—å, –º–∞—Å—Ç–µ—Ä–∏—Ç—å –∏–ª–∏ —á–∏–Ω–∏—Ç—å.'],
                    ['creativity', '–ú–Ω–µ –Ω—Ä–∞–≤–∏—Ç—Å—è –ø—Ä–∏–¥—É–º—ã–≤–∞—Ç—å –∏—Å—Ç–æ—Ä–∏–∏, –∏–≥—Ä—ã –∏–ª–∏ —Ä–∏—Å—É–Ω–∫–∏.'],
                    ['analysis', '–ú–Ω–µ –Ω—Ä–∞–≤–∏—Ç—Å—è –Ω–∞—Ö–æ–¥–∏—Ç—å –∑–∞–∫–æ–Ω–æ–º–µ—Ä–Ω–æ—Å—Ç–∏ –∏ ¬´–ø–æ—á–µ–º—É —Ç–∞–∫¬ª.'],
                    ['responsibility', '–Ø —Å—Ç–∞—Ä–∞—é—Å—å –¥–µ–ª–∞—Ç—å –∑–∞–¥–∞–Ω–∏—è –∞–∫–∫—É—Ä–∞—Ç–Ω–æ –∏ –¥–æ –∫–æ–Ω—Ü–∞.'],
                    ['leadership', '–ú–Ω–µ –Ω—Ä–∞–≤–∏—Ç—Å—è –±—ã—Ç—å –æ—Ä–≥–∞–Ω–∏–∑–∞—Ç–æ—Ä–æ–º –≤ –∏–≥—Ä–∞—Ö –∏–ª–∏ –ø—Ä–æ–µ–∫—Ç–∞—Ö.'],
                    ['practice', '–ú–Ω–µ –Ω—Ä–∞–≤–∏—Ç—Å—è –≤—ã–ø–æ–ª–Ω—è—Ç—å –∑–∞–¥–∞–Ω–∏—è –ø–æ —à–∞–≥–∞–º (–∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º).'],
                    ['analysis', '–ú–Ω–µ –Ω—Ä–∞–≤–∏—Ç—Å—è —Ä–µ—à–∞—Ç—å –∑–∞–¥–∞—á–∫–∏ –∏ –≥–æ–ª–æ–≤–æ–ª–æ–º–∫–∏.'],
                    ['responsibility', '–ú–Ω–µ –≤–∞–∂–Ω–æ, —á—Ç–æ–±—ã –º–µ–Ω—è –º–æ–∂–Ω–æ –±—ã–ª–æ –¥–æ–≤–µ—Ä—è—Ç—å.']
                ],
                '5-6': [
                    ['people', '–ú–Ω–µ –ª–µ–≥–∫–æ –Ω–∞—Ö–æ–¥–∏—Ç—å –æ–±—â–∏–π —è–∑—ã–∫ —Å —Ä–∞–∑–Ω—ã–º–∏ –ª—é–¥—å–º–∏.'],
                    ['people', '–ú–Ω–µ –Ω—Ä–∞–≤–∏—Ç—Å—è –æ–±—ä—è—Å–Ω—è—Ç—å –¥—Ä—É–≥–∏–º —Ç–æ, —á—Ç–æ —è –ø–æ–Ω—è–ª(–∞).'],
                    ['analysis', '–ú–Ω–µ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ —Å—Ä–∞–≤–Ω–∏–≤–∞—Ç—å —Ñ–∞–∫—Ç—ã –∏ –¥–µ–ª–∞—Ç—å –≤—ã–≤–æ–¥—ã.'],
                    ['analysis', '–ú–Ω–µ –Ω—Ä–∞–≤–∏—Ç—Å—è —Ä–∞–±–æ—Ç–∞—Ç—å —Å —Ç–∞–±–ª–∏—Ü–∞–º–∏, —Å—Ö–µ–º–∞–º–∏, –¥–∞–Ω–Ω—ã–º–∏.'],
                    ['practice', '–ú–Ω–µ –Ω—Ä–∞–≤–∏—Ç—Å—è –¥–µ–ª–∞—Ç—å –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Ä–∞–±–æ—Ç—ã –∏ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã.'],
                    ['practice', '–ú–Ω–µ –Ω—Ä–∞–≤–∏—Ç—Å—è —Ä–∞–±–æ—Ç–∞—Ç—å —Å –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º–∏/–æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ–º (–∞–∫–∫—É—Ä–∞—Ç–Ω–æ).'],
                    ['creativity', '–ú–Ω–µ –Ω—Ä–∞–≤–∏—Ç—Å—è –ø—Ä–∏–¥—É–º—ã–≤–∞—Ç—å –Ω–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è.'],
                    ['creativity', '–ú–Ω–µ –Ω—Ä–∞–≤–∏—Ç—Å—è –¥–µ–ª–∞—Ç—å –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏–∏, –ø—Ä–æ–µ–∫—Ç—ã, –æ—Ñ–æ—Ä–º–ª—è—Ç—å.'],
                    ['leadership', '–ú–Ω–µ –Ω—Ä–∞–≤–∏—Ç—Å—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—è—Ç—å –∑–∞–¥–∞—á–∏ –≤ –≥—Ä—É–ø–ø–µ.'],
                    ['responsibility', '–ú–Ω–µ –≤–∞–∂–Ω—ã –ø—Ä–∞–≤–∏–ª–∞ –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ.']
                ],
                '7-8': [
                    ['analysis', '–ú–Ω–µ –Ω—Ä–∞–≤–∏—Ç—Å—è —Ä–∞–∑–±–∏—Ä–∞—Ç—å—Å—è –≤ –ø—Ä–∏—á–∏–Ω–∞—Ö –∏ —Å–ª–µ–¥—Å—Ç–≤–∏—è—Ö.'],
                    ['analysis', '–ú–Ω–µ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ –∏–∑—É—á–∞—Ç—å —Å–ª–æ–∂–Ω—ã–µ —Ç–µ–º—ã —à–∞–≥ –∑–∞ —à–∞–≥–æ–º.'],
                    ['people', '–ú–Ω–µ –≤–∞–∂–Ω–æ, —á—Ç–æ–±—ã –º–æ—è —Ä–∞–±–æ—Ç–∞ –ø—Ä–∏–Ω–æ—Å–∏–ª–∞ –ø–æ–ª—å–∑—É –ª—é–¥—è–º.'],
                    ['people', '–ú–Ω–µ –∫–æ–º—Ñ–æ—Ä—Ç–Ω–æ –æ–±—â–∞—Ç—å—Å—è –∏ –∑–∞–¥–∞–≤–∞—Ç—å —É—Ç–æ—á–Ω—è—é—â–∏–µ –≤–æ–ø—Ä–æ—Å—ã.'],
                    ['practice', '–ú–Ω–µ –Ω—Ä–∞–≤–∏—Ç—Å—è –ø—Ä–∞–∫—Ç–∏–∫–æ–≤–∞—Ç—å—Å—è –∏ —É–ª—É—á—à–∞—Ç—å –Ω–∞–≤—ã–∫.'],
                    ['practice', '–ú–Ω–µ –Ω—Ä–∞–≤–∏—Ç—Å—è —Ç–æ—á–Ω–æ—Å—Ç—å: –∏–∑–º–µ—Ä—è—Ç—å, –ø—Ä–æ–≤–µ—Ä—è—Ç—å, –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å.'],
                    ['responsibility', '–Ø —É–º–µ—é –¥–µ—Ä–∂–∞—Ç—å –æ–±–µ—â–∞–Ω–∏—è –∏ —Å—Ä–æ–∫–∏.'],
                    ['responsibility', '–ú–Ω–µ –ø–æ–¥—Ö–æ–¥–∏—Ç —Ä–∞–±–æ—Ç–∞, –≥–¥–µ –Ω–µ–ª—å–∑—è –æ—à–∏–±–∞—Ç—å—Å—è –ø–æ –º–µ–ª–æ—á–∞–º.'],
                    ['leadership', '–ú–Ω–µ –Ω—Ä–∞–≤–∏—Ç—Å—è –≤–µ—Å—Ç–∏ –ø—Ä–æ–µ–∫—Ç –∏ –æ—Ç–≤–µ—á–∞—Ç—å –∑–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç.'],
                    ['creativity', '–ú–Ω–µ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ —Å–æ–∑–¥–∞–≤–∞—Ç—å –Ω–æ–≤–æ–µ (–∏–¥–µ–∏, –¥–∏–∑–∞–π–Ω, –ø–æ–¥—Ö–æ–¥—ã).']
                ],
                '9': [
                    ['analysis', '–ú–Ω–µ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ –ø—Ä–∏–Ω–∏–º–∞—Ç—å —Ä–µ—à–µ–Ω–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–∞–Ω–Ω—ã—Ö –∏ —Ñ–∞–∫—Ç–æ–≤.'],
                    ['analysis', '–ú–Ω–µ –Ω—Ä–∞–≤–∏—Ç—Å—è –∏–∑—É—á–∞—Ç—å –ø—Ä–∏—á–∏–Ω—ã –æ—à–∏–±–æ–∫ –∏ —É–ª—É—á—à–∞—Ç—å –ø—Ä–æ—Ü–µ—Å—Å.'],
                    ['people', '–ú–Ω–µ –∫–æ–º—Ñ–æ—Ä—Ç–Ω–æ –≤–µ—Å—Ç–∏ –¥–∏–∞–ª–æ–≥ –∏ –∑–∞–¥–∞–≤–∞—Ç—å –Ω–µ—É–¥–æ–±–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã –ø–æ –¥–µ–ª—É.'],
                    ['people', '–ú–Ω–µ –≤–∞–∂–Ω–∞ —Ä–∞–±–æ—Ç–∞, –≥–¥–µ –Ω—É–∂–Ω–æ –ø–æ–Ω–∏–º–∞—Ç—å –ª—é–¥–µ–π.'],
                    ['responsibility', '–ú–Ω–µ –ø–æ–¥—Ö–æ–¥–∏—Ç —Ä–∞–±–æ—Ç–∞ —Å –≤—ã—Å–æ–∫–æ–π –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å—é.'],
                    ['responsibility', '–Ø –≤—ã–¥–µ—Ä–∂–∏–≤–∞—é –¥–ª–∏—Ç–µ–ª—å–Ω—É—é –ø–æ–¥–≥–æ—Ç–æ–≤–∫—É —Ä–∞–¥–∏ —Ü–µ–ª–∏.'],
                    ['practice', '–ú–Ω–µ –Ω—Ä–∞–≤–∏—Ç—Å—è —Ä–∞–±–æ—Ç–∞—Ç—å —Ä—É–∫–∞–º–∏ –∏ –≤–∏–¥–µ—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç.'],
                    ['practice', '–ú–Ω–µ –≤–∞–∂–Ω–∞ –∞–∫–∫—É—Ä–∞—Ç–Ω–æ—Å—Ç—å –∏ ¬´—á–∏—Å—Ç–æ—Ç–∞¬ª –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è.'],
                    ['leadership', '–ú–Ω–µ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ –æ—Ä–≥–∞–Ω–∏–∑–æ–≤—ã–≤–∞—Ç—å –ª—é–¥–µ–π –∏ –ø—Ä–æ—Ü–µ—Å—Å—ã.'],
                    ['creativity', '–ú–Ω–µ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ –∏—Å–∫–∞—Ç—å –Ω–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –ø—É—Ç–∏ –∏ —Ä–µ—à–µ–Ω–∏—è.']
                ],
                '10-11': [
                    ['analysis', '–ú–Ω–µ –Ω—Ä–∞–≤–∏—Ç—Å—è –≥–ª—É–±–æ–∫–æ —Ä–∞–∑–±–∏—Ä–∞—Ç—å—Å—è –≤ —Ç–µ–º–µ –∏ —Å—Ç—Ä–æ–∏—Ç—å —Å–∏—Å—Ç–µ–º—É –∑–Ω–∞–Ω–∏–π.'],
                    ['analysis', '–ú–Ω–µ –∫–æ–º—Ñ–æ—Ä—Ç–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å —Å –±–æ–ª—å—à–∏–º –æ–±—ä—ë–º–æ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏.'],
                    ['responsibility', '–Ø –≥–æ—Ç–æ–≤(–∞) –æ—Ç–≤–µ—á–∞—Ç—å –∑–∞ –ø–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è —Å–≤–æ–∏—Ö —Ä–µ—à–µ–Ω–∏–π.'],
                    ['responsibility', '–Ø —É–º–µ—é —Ä–∞–±–æ—Ç–∞—Ç—å –≤ —Ä–µ–∂–∏–º–µ –¥–µ–¥–ª–∞–π–Ω–æ–≤.'],
                    ['people', '–ú–Ω–µ –≤–∞–∂–Ω–æ –ø–æ–º–æ–≥–∞—Ç—å –ª—é–¥—è–º –∏ —É–ª—É—á—à–∞—Ç—å –∫–∞—á–µ—Å—Ç–≤–æ –∏—Ö –∂–∏–∑–Ω–∏.'],
                    ['people', '–ú–Ω–µ –ø–æ–¥—Ö–æ–¥–∏—Ç —Ä–∞–±–æ—Ç–∞, –≥–¥–µ –Ω—É–∂–Ω–æ –æ–±—ä—è—Å–Ω—è—Ç—å —Å–ª–æ–∂–Ω–æ–µ –ø—Ä–æ—Å—Ç—ã–º–∏ —Å–ª–æ–≤–∞–º–∏.'],
                    ['practice', '–ú–Ω–µ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–∞ —Ä–∞–±–æ—Ç–∞ —Å –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ–º/–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º–∏.'],
                    ['practice', '–ú–Ω–µ –≤–∞–∂–Ω—ã —Ç–æ—á–Ω–æ—Å—Ç—å –∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç—ã –∫–∞—á–µ—Å—Ç–≤–∞.'],
                    ['leadership', '–ú–Ω–µ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ —É–ø—Ä–∞–≤–ª—è—Ç—å –ø—Ä–æ–µ–∫—Ç–∞–º–∏/–∫–æ–º–∞–Ω–¥–∞–º–∏.'],
                    ['creativity', '–ú–Ω–µ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ —Å–æ–∑–¥–∞–≤–∞—Ç—å –Ω–æ–≤—ã–µ –ø—Ä–æ–¥—É–∫—Ç—ã/–º–µ—Ç–æ–¥–∏–∫–∏/–ø–æ–¥—Ö–æ–¥—ã.']
                ]
            };

            const base = statementsByBand[band] || statementsByBand['9'];

            // –†–∞–∑–¥—É–≤–∞–µ–º –±–∞–Ω–∫ –¥–æ 50+ –≤–æ–ø—Ä–æ—Å–æ–≤, –ø–æ–≤—Ç–æ—Ä—è—è —Å–º—ã—Å–ª –≤ —Ä–∞–∑–Ω—ã—Ö —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∞—Ö
            const variants = [
                (t) => t,
                (t) => t.replace('–ú–Ω–µ –Ω—Ä–∞–≤–∏—Ç—Å—è', '–ú–Ω–µ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ'),
                (t) => t.replace('–ú–Ω–µ –Ω—Ä–∞–≤–∏—Ç—Å—è', '–ú–Ω–µ –ø–æ –¥—É—à–µ'),
                (t) => t.replace('–ú–Ω–µ –Ω—Ä–∞–≤–∏—Ç—Å—è', '–ú–Ω–µ –ø—Ä–∏—è—Ç–Ω–æ'),
                (t) => t.replace('–ú–Ω–µ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ', '–ú–Ω–µ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ'),
                (t) => t.replace('–ú–Ω–µ –≤–∞–∂–Ω–æ', '–î–ª—è –º–µ–Ω—è –≤–∞–∂–Ω–æ'),
                (t) => t.replace('–ú–Ω–µ –≤–∞–∂–Ω–æ', '–ú–Ω–µ –æ—Å–æ–±–µ–Ω–Ω–æ –≤–∞–∂–Ω–æ'),
                (t) => t.replace('–ú–Ω–µ –ø–æ–¥—Ö–æ–¥–∏—Ç', '–ú–Ω–µ —Å–∫–æ—Ä–µ–µ –ø–æ–¥—Ö–æ–¥–∏—Ç'),
                (t) => t.replace('–ú–Ω–µ –ø–æ–¥—Ö–æ–¥–∏—Ç', '–ú–Ω–µ –æ–±—ã—á–Ω–æ –ø–æ–¥—Ö–æ–¥–∏—Ç')
            ];

            const questions = [];
            let idx = 0;
            // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –±–µ–∑ –ø–æ–≤—Ç–æ—Ä–æ–≤: –∫–∞–∂–¥–∞—è –ø–∞—Ä–∞ (variant,text) –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –º–∞–∫—Å–∏–º—É–º 1 —Ä–∞–∑
            outer: for (let pass = 0; pass < variants.length; pass++) {
                const v = variants[pass];
                for (const [dim, text] of base) {
                    idx++;
                    questions.push(
                        makeLikertQuestion({
                            id: stableId(`profession_general_${band}`, idx),
                            question: v(text),
                            dimension: dim,
                            gradeBand: band
                        })
                    );
                    if (questions.length >= desiredCount) break outer;
                }
            }

            // –î–æ–±–∞–≤–∏–º –æ–ø–∏—Å–∞–Ω–∏—è –∏–∑–º–µ—Ä–µ–Ω–∏–π (—Å–ª—É–∂–µ–±–Ω—ã–µ) —á–µ—Ä–µ–∑ explanation –≤ –Ω–∞—á–∞–ª–µ
            if (questions.length > 0) {
                questions[0].explanation = `–û—Ü–µ–Ω–∏–≤–∞–π—Ç–µ —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –ø–æ —à–∫–∞–ª–µ. –ú—ã —Å—Ñ–æ—Ä–º–∏—Ä—É–µ–º –ø—Ä–æ—Ñ–∏–ª—å –∏–Ω—Ç–µ—Ä–µ—Å–æ–≤: ${Object.values(dims).join(', ')}.`;
            }

            return questions;
        }

        function generateMedicalProfessionQuestions(bandStartGrade, desiredCount = 64) {
            const band = normalizeBandLabel(bandStartGrade);
            const statements = {
                empathy: '–≠–º–ø–∞—Ç–∏—è –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∞',
                stress: '–°—Ç—Ä–µ—Å—Å–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å',
                accuracy: '–¢–æ—á–Ω–æ—Å—Ç—å –∏ –≤–Ω–∏–º–∞–Ω–∏–µ –∫ –¥–µ—Ç–∞–ª—è–º',
                science: '–ò–Ω—Ç–µ—Ä–µ—Å –∫ –Ω–∞—É–∫–µ (–±–∏–æ/—Ö–∏–º)',
                teamwork: '–ö–æ–º–∞–Ω–¥–Ω–∞—è —Ä–∞–±–æ—Ç–∞',
                responsibility: '–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å'
            };

            const base = {
                '1-4': [
                    ['empathy', '–ú–Ω–µ –≤–∞–∂–Ω–æ, —á—Ç–æ–±—ã –ª—é–¥—è–º —Ä—è–¥–æ–º –±—ã–ª–æ —Å–ø–æ–∫–æ–π–Ω–µ–µ.'],
                    ['empathy', '–Ø —Å—Ç–∞—Ä–∞—é—Å—å –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å —Ç–µ—Ö, –∫—Ç–æ —Ä–∞—Å—Å—Ç—Ä–æ–µ–Ω.'],
                    ['accuracy', '–Ø –ª—é–±–ª—é, –∫–æ–≥–¥–∞ –≤—Å—ë –∞–∫–∫—É—Ä–∞—Ç–Ω–æ –∏ —á–∏—Å—Ç–æ.'],
                    ['responsibility', '–Ø –≤—ã–ø–æ–ª–Ω—è—é –æ–±–µ—â–∞–Ω–∏—è –∏ –ø—Ä–∞–≤–∏–ª–∞.'],
                    ['science', '–ú–Ω–µ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ —É–∑–Ω–∞–≤–∞—Ç—å, –∫–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–µ–ª–æ —á–µ–ª–æ–≤–µ–∫–∞.'],
                    ['teamwork', '–ú–Ω–µ –Ω—Ä–∞–≤–∏—Ç—Å—è —Ä–∞–±–æ—Ç–∞—Ç—å –≤–º–µ—Å—Ç–µ –∏ –ø–æ–º–æ–≥–∞—Ç—å –∫–æ–º–∞–Ω–¥–µ.'],
                    ['stress', '–Ø –º–æ–≥—É —Å–æ—Ö—Ä–∞–Ω—è—Ç—å —Å–ø–æ–∫–æ–π—Å—Ç–≤–∏–µ, –∫–æ–≥–¥–∞ –∫—Ç–æ-—Ç–æ –≤–æ–ª–Ω—É–µ—Ç—Å—è.'],
                    ['accuracy', '–ú–Ω–µ –Ω—Ä–∞–≤–∏—Ç—Å—è –¥–µ–ª–∞—Ç—å –≤—Å—ë –ø–æ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏.'],
                    ['science', '–ú–Ω–µ –Ω—Ä–∞–≤–∏—Ç—Å—è —É–∑–Ω–∞–≤–∞—Ç—å –ø—Ä–æ –∂–∏–≤–æ—Ç–Ω—ã—Ö/—Ä–∞—Å—Ç–µ–Ω–∏—è/—á–µ–ª–æ–≤–µ–∫–∞.'],
                    ['responsibility', '–Ø —Å—Ç–∞—Ä–∞—é—Å—å –Ω–µ –∑–∞–±—ã–≤–∞—Ç—å –≤–∞–∂–Ω—ã–µ –≤–µ—â–∏.']
                ],
                '5-6': [
                    ['science', '–ú–Ω–µ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ, –ø–æ—á–µ–º—É –≤–æ–∑–Ω–∏–∫–∞—é—Ç –±–æ–ª–µ–∑–Ω–∏ –∏ –∫–∞–∫ –∏—Ö –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞—é—Ç.'],
                    ['science', '–ú–Ω–µ –Ω—Ä–∞–≤—è—Ç—Å—è —É—Ä–æ–∫–∏, –≥–¥–µ –º–Ω–æ–≥–æ –æ–±—ä—è—Å–Ω–µ–Ω–∏–π –ø—Ä–æ –æ—Ä–≥–∞–Ω–∏–∑–º.'],
                    ['accuracy', '–ú–Ω–µ –≤–∞–∂–Ω—ã —Ç–æ—á–Ω–æ—Å—Ç—å –∏ –ø–æ—Ä—è–¥–æ–∫ –≤ —Ä–∞–±–æ—Ç–µ.'],
                    ['accuracy', '–ú–Ω–µ –Ω—Ä–∞–≤–∏—Ç—Å—è –∑–∞–º–µ—á–∞—Ç—å –º–µ–ª–∫–∏–µ –¥–µ—Ç–∞–ª–∏.'],
                    ['empathy', '–ú–Ω–µ –∫–æ–º—Ñ–æ—Ä—Ç–Ω–æ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å —á–µ–ª–æ–≤–µ–∫–∞, –µ—Å–ª–∏ –µ–º—É –ø–ª–æ—Ö–æ.'],
                    ['teamwork', '–ú–Ω–µ –Ω—Ä–∞–≤–∏—Ç—Å—è —Ä–∞–±–æ—Ç–∞—Ç—å –≤ –≥—Ä—É–ø–ø–µ –∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—è—Ç—å —Ä–æ–ª–∏.'],
                    ['responsibility', '–Ø –ø–æ–Ω–∏–º–∞—é, —á—Ç–æ –æ—à–∏–±–∫–∏ –º–æ–≥—É—Ç –±—ã—Ç—å –æ–ø–∞—Å–Ω—ã.'],
                    ['stress', '–í —Å–ª–æ–∂–Ω—ã—Ö —Å–∏—Ç—É–∞—Ü–∏—è—Ö —è –¥–µ–π—Å—Ç–≤—É—é —Å–ø–æ–∫–æ–π–Ω–æ.'],
                    ['responsibility', '–ú–Ω–µ –≤–∞–∂–Ω–æ —Å–æ–±–ª—é–¥–∞—Ç—å –ø—Ä–∞–≤–∏–ª–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏.'],
                    ['teamwork', '–ú–Ω–µ –ª–µ–≥—á–µ, –∫–æ–≥–¥–∞ –µ—Å—Ç—å –æ–±—â–∏–π –ø–ª–∞–Ω –∫–æ–º–∞–Ω–¥—ã.']
                ],
                '7-8': [
                    ['science', '–ú–Ω–µ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ –∏–∑—É—á–∞—Ç—å –∞–Ω–∞—Ç–æ–º–∏—é –∏ —Ñ–∏–∑–∏–æ–ª–æ–≥–∏—é —á–µ–ª–æ–≤–µ–∫–∞.'],
                    ['science', '–ú–Ω–µ –Ω—Ä–∞–≤–∏—Ç—Å—è —Ä–∞–∑–±–∏—Ä–∞—Ç—å—Å—è –≤ –ø—Ä–∏—á–∏–Ω–∞—Ö —Å–∏–º–ø—Ç–æ–º–æ–≤ –∏ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤.'],
                    ['empathy', '–Ø —É–º–µ—é —Å–ª—É—à–∞—Ç—å –∏ –Ω–µ –æ–±–µ—Å—Ü–µ–Ω–∏–≤–∞—Ç—å —ç–º–æ—Ü–∏–∏ —á–µ–ª–æ–≤–µ–∫–∞.'],
                    ['stress', '–í –Ω–∞–ø—Ä—è–∂—ë–Ω–Ω–æ–π –æ–±—Å—Ç–∞–Ω–æ–≤–∫–µ —è —Å–æ—Ö—Ä–∞–Ω—è—é –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏—é.'],
                    ['accuracy', '–ú–Ω–µ –ø–æ–¥—Ö–æ–¥–∏—Ç —Ä–∞–±–æ—Ç–∞, –≥–¥–µ –Ω—É–∂–Ω–∞ —Å—Ç–µ—Ä–∏–ª—å–Ω–æ—Å—Ç—å –∏ —Ç–æ—á–Ω–æ—Å—Ç—å.'],
                    ['accuracy', '–Ø –ø—Ä–µ–¥–ø–æ—á–∏—Ç–∞—é –ø—Ä–æ–≤–µ—Ä—è—Ç—å —Å–µ–±—è, –∞ –Ω–µ ¬´–¥–µ–ª–∞—Ç—å –Ω–∞ –≥–ª–∞–∑¬ª.'],
                    ['teamwork', '–ú–Ω–µ –∫–æ–º—Ñ–æ—Ä—Ç–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å –ø–æ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞–º –∫–æ–º–∞–Ω–¥—ã.'],
                    ['teamwork', '–ú–Ω–µ –≤–∞–∂–Ω–æ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å —Å —Ä–∞–∑–Ω—ã–º–∏ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–∞–º–∏.'],
                    ['responsibility', '–Ø –≥–æ—Ç–æ–≤(–∞) —É—á–∏—Ç—å—Å—è –¥–æ–ª–≥–æ –∏ —Ä–µ–≥—É–ª—è—Ä–Ω–æ.'],
                    ['responsibility', '–ú–Ω–µ –ø–æ–¥—Ö–æ–¥–∏—Ç —Ä–∞–±–æ—Ç–∞, –≥–¥–µ –≤–∞–∂–Ω–æ –Ω–µ –Ω–∞–≤—Ä–µ–¥–∏—Ç—å.']
                ],
                '9': [
                    ['science', '–ú–Ω–µ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ —Å–≤—è–∑—ã–≤–∞—Ç—å –±–∏–æ–ª–æ–≥–∏—é –∏ —Ö–∏–º–∏—é —Å –º–µ–¥–∏—Ü–∏–Ω–æ–π.'],
                    ['science', '–ú–Ω–µ –Ω—Ä–∞–≤–∏—Ç—Å—è —Ä–µ—à–∞—Ç—å –∑–∞–¥–∞—á–∏ –∏ —Ä–∞–∑–±–∏—Ä–∞—Ç—å –∫–ª–∏–Ω–∏—á–µ—Å–∫–∏–µ —Å–ª—É—á–∞–∏ (–Ω–∞ —Å–≤–æ—ë–º —É—Ä–æ–≤–Ω–µ).'],
                    ['accuracy', '–ú–Ω–µ –≤–∞–∂–Ω–æ —Å–æ–±–ª—é–¥–∞—Ç—å –∞–ª–≥–æ—Ä–∏—Ç–º—ã –∏ –ø–æ—Ä—è–¥–æ–∫ –¥–µ–π—Å—Ç–≤–∏–π.'],
                    ['accuracy', '–ú–Ω–µ –∫–æ–º—Ñ–æ—Ä—Ç–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å —Å –∏–∑–º–µ—Ä–µ–Ω–∏—è–º–∏, –¥–æ–∑–∏—Ä–æ–≤–∫–∞–º–∏, —Ä–∞—Å—á—ë—Ç–∞–º–∏.'],
                    ['empathy', '–ú–Ω–µ –≤–∞–∂–Ω–æ –ø–æ–º–æ–≥–∞—Ç—å –ª—é–¥—è–º –¥–∞–∂–µ –≤ —Å–ª–æ–∂–Ω—ã—Ö —Å–∏—Ç—É–∞—Ü–∏—è—Ö.'],
                    ['stress', '–Ø —Å–ø–æ—Å–æ–±–µ–Ω(–Ω–∞) —Å–æ—Ö—Ä–∞–Ω—è—Ç—å —Å–ø–æ–∫–æ–π—Å—Ç–≤–∏–µ –≤ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π –º–æ–º–µ–Ω—Ç.'],
                    ['teamwork', '–ú–Ω–µ –Ω—Ä–∞–≤–∏—Ç—Å—è —Ä–∞–±–æ—Ç–∞, –≥–¥–µ –Ω—É–∂–Ω–∞ –∫–æ–º–∞–Ω–¥–∞ –∏ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏—è.'],
                    ['responsibility', '–Ø –≥–æ—Ç–æ–≤(–∞) –Ω–µ—Å—Ç–∏ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å –∑–∞ —Ä–µ—à–µ–Ω–∏–µ –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç.'],
                    ['responsibility', '–Ø –≥–æ—Ç–æ–≤(–∞) —É—á–∏—Ç—å—Å—è 6+ –ª–µ—Ç —Ä–∞–¥–∏ –ø—Ä–æ—Ñ–µ—Å—Å–∏–∏.'],
                    ['stress', '–Ø –º–æ–≥—É —Ä–∞–±–æ—Ç–∞—Ç—å, –∫–æ–≥–¥–∞ –µ—Å—Ç—å –¥–∞–≤–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏.']
                ],
                '10-11': [
                    ['science', '–ú–Ω–µ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ —É–≥–ª—É–±–ª—ë–Ω–Ω–æ –∏–∑—É—á–∞—Ç—å –±–∏–æ–ª–æ–≥–∏—é/—Ö–∏–º–∏—é/–∞–Ω–∞—Ç–æ–º–∏—é.'],
                    ['science', '–ú–Ω–µ –∫–æ–º—Ñ–æ—Ä—Ç–Ω–æ —É—á–∏—Ç—å—Å—è —á–µ—Ä–µ–∑ –ø—Ä–∞–∫—Ç–∏–∫—É –∏ —Ä–∞–∑–±–æ—Ä –æ—à–∏–±–æ–∫.'],
                    ['accuracy', '–Ø –≤–Ω–∏–º–∞—Ç–µ–ª–µ–Ω(–Ω–∞) –∫ –¥–µ—Ç–∞–ª—è–º –∏ –ø–æ–Ω–∏–º–∞—é —Ü–µ–Ω—É –æ—à–∏–±–∫–∏.'],
                    ['accuracy', '–ú–Ω–µ –ø–æ–¥—Ö–æ–¥–∏—Ç —Ä–∞–±–æ—Ç–∞ –ø–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞–º –∏ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞–º.'],
                    ['empathy', '–Ø —É–º–µ—é –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å —á–µ–ª–æ–≤–µ–∫–∞ –∏ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å —É–≤–∞–∂–µ–Ω–∏–µ.'],
                    ['stress', '–Ø —Å–æ—Ö—Ä–∞–Ω—è—é —Å–ø–æ–∫–æ–π—Å—Ç–≤–∏–µ –∏ —è—Å–Ω–æ—Å—Ç—å –º—ã—à–ª–µ–Ω–∏—è –ø–æ–¥ –Ω–∞–≥—Ä—É–∑–∫–æ–π.'],
                    ['teamwork', '–ú–Ω–µ –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã —Ä–æ–ª–∏ –≤ –∫–æ–º–∞–Ω–¥–µ: –≤—Ä–∞—á, –º–µ–¥—Å–µ—Å—Ç—Ä–∞, –ª–∞–±–æ—Ä–∞–Ω—Ç, —Ñ–∞—Ä–º–∞—Ü–µ–≤—Ç.'],
                    ['responsibility', '–ú–Ω–µ –≤–∞–∂–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å —ç—Ç–∏—á–Ω–æ –∏ —á–µ—Å—Ç–Ω–æ.'],
                    ['responsibility', '–Ø –≥–æ—Ç–æ–≤(–∞) –∫ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–º—É –æ–±—É—á–µ–Ω–∏—é –≤ –ø—Ä–æ—Ñ–µ—Å—Å–∏–∏.'],
                    ['teamwork', '–ú–Ω–µ –≤–∞–∂–Ω–æ —É–º–µ—Ç—å –¥–æ–≥–æ–≤–∞—Ä–∏–≤–∞—Ç—å—Å—è –∏ –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å —Å–º–µ–Ω—É/–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é.']
                ]
            };

            const baseList = base[band] || base['9'];
            const variants = [
                (t) => t,
                (t) => t.replace('–ú–Ω–µ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ', '–ú–Ω–µ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ'),
                (t) => t.replace('–ú–Ω–µ –≤–∞–∂–Ω–æ', '–î–ª—è –º–µ–Ω—è –≤–∞–∂–Ω–æ'),
                (t) => t.replace('–ú–Ω–µ –ø–æ–¥—Ö–æ–¥–∏—Ç', '–ú–Ω–µ —Å–∫–æ—Ä–µ–µ –ø–æ–¥—Ö–æ–¥–∏—Ç'),
                (t) => t.replace('–ú–Ω–µ –ø–æ–¥—Ö–æ–¥–∏—Ç', '–ú–Ω–µ –æ–±—ã—á–Ω–æ –ø–æ–¥—Ö–æ–¥–∏—Ç'),
                (t) => t.replace('–ú–Ω–µ –≤–∞–∂–Ω–æ', '–ú–Ω–µ –æ—Å–æ–±–µ–Ω–Ω–æ –≤–∞–∂–Ω–æ')
            ];

            const questions = [];
            let idx = 0;
            outer: for (let pass = 0; pass < variants.length; pass++) {
                const v = variants[pass];
                for (const [dim, text] of baseList) {
                    idx++;
                    questions.push(
                        makeLikertQuestion({
                            id: stableId(`profession_med_${band}`, idx),
                            question: v(text),
                            dimension: dim,
                            gradeBand: band
                        })
                    );
                    if (questions.length >= desiredCount) break outer;
                }
            }
            if (questions.length > 0) {
                questions[0].explanation = `–≠—Ç–æ –º–µ–¥.–ø—Ä–æ—Ñ–æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏—è. –ü—Ä–æ—Ñ–∏–ª—å —Å—Ç—Ä–æ–∏—Ç—Å—è –ø–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º: ${Object.values(statements).join(', ')}.`;
            }
            return questions;
        }

        function makeMcq({ id, question, options, correct, explanation, topic, difficulty, subject, gradeBand }) {
            return {
                id,
                kind: 'mcq',
                question,
                options,
                correct,
                explanation,
                topic,
                difficulty,
                subject,
                gradeBand
            };
        }

        function inferBandStartFromTestId(testId) {
            if (!testId || typeof testId !== 'string') return null;
            const m = testId.match(/_(1|5|7|9|10)$/);
            if (!m) return null;
            const n = parseInt(m[1], 10);
            return Number.isFinite(n) ? n : null;
        }

        function inferCategoryFromTestId(testId) {
            if (!testId || typeof testId !== 'string') return null;
            if (testId === 'biology' || testId.startsWith('biology_')) return 'biology';
            if (testId === 'chemistry' || testId.startsWith('chemistry_')) return 'chemistry';
            if (testId === 'profession' || testId.startsWith('profession_general_') || testId.startsWith('profession_med_')) return 'profession';
            return null;
        }

        // –î–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ–º–æ—â–Ω–∏–∫–∏ (—á—Ç–æ–±—ã –≤–∞—Ä–∏–∞–Ω—Ç—ã –≤—Å–µ–≥–¥–∞ –±—ã–ª–∏ —Å—Ç–∞–±–∏–ª—å–Ω—ã–µ)
        function seededRand(seed) {
            let s = (seed >>> 0) || 1;
            return () => {
                // LCG
                s = (s * 1664525 + 1013904223) >>> 0;
                return s / 4294967296;
            };
        }

        function shuffleWithSeed(arr, seed) {
            const out = [...arr];
            const rnd = seededRand(seed);
            for (let i = out.length - 1; i > 0; i--) {
                const j = Math.floor(rnd() * (i + 1));
                [out[i], out[j]] = [out[j], out[i]];
            }
            return out;
        }

        function pickDistractors(values, correctValue, count, seed) {
            const pool = values.filter(v => v !== correctValue);
            const shuffled = shuffleWithSeed(pool, seed);
            return shuffled.slice(0, count);
        }

        function difficultyByBand(band) {
            if (band === '1-4') return 1;
            if (band === '5-6') return 2;
            if (band === '7-8') return 3;
            if (band === '9') return 3;
            return 4;
        }

        function buildMcqFromPairs({ prefix, pairs, questionText, optionsFromKeys, correctIndexFn, topic, difficulty, explanationFn, seedBase = 1 }) {
            const keys = pairs.map(p => p.key);
            const byKey = Object.fromEntries(pairs.map(p => [p.key, p.value]));
            const out = [];
            let i = 0;

            pairs.forEach((p, idx) => {
                const seed = seedBase + idx * 997;
                const distract = pickDistractors(keys, p.key, 3, seed);
                const optionKeys = shuffleWithSeed([p.key, ...distract], seed + 13);
                const options = optionsFromKeys(optionKeys, byKey);
                const correct = correctIndexFn(optionKeys, p.key);
                out.push(
                    makeMcq({
                        id: stableId(prefix, ++i),
                        topic,
                        difficulty,
                        question: typeof questionText === 'function' ? questionText(p, byKey) : String(questionText),
                        options,
                        correct,
                        explanation: explanationFn ? explanationFn(p, byKey) : ''
                    })
                );
            });

            return out;
        }

        function generateBiologyByGrade(bandStartGrade, desiredCount = 64) {
            const band = normalizeBandLabel(bandStartGrade);
            const prefix = `biology_${band}`;
            const diff = difficultyByBand(band);
            const out = [];

            const addTwoWayDefinitions = ({ suffix, pairs, topic, difficulty, seedBase }) => {
                // 2 –≤–∞—Ä–∏–∞–Ω—Ç–∞ —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∏ –≤ –∫–∞–∂–¥—É—é —Å—Ç–æ—Ä–æ–Ω—É => –±–æ–ª—å—à–µ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –≤–æ–ø—Ä–æ—Å–æ–≤ –±–µ–∑ ¬´–¥–µ—Ç—Å–∫–∏—Ö¬ª —Ç–µ–º
                const defPrompts = [
                    (p) => `–í—ã–±–µ—Ä–∏—Ç–µ –≤–µ—Ä–Ω–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–µ—Ä–º–∏–Ω–∞: ¬´${p.key}¬ª.`,
                    (p) => `–ß—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç —Ç–µ—Ä–º–∏–Ω ¬´${p.key}¬ª?`
                ];
                defPrompts.forEach((qText, i) => {
                    out.push(
                        ...buildMcqFromPairs({
                            prefix: `${prefix}_${suffix}_def${i + 1}`,
                            pairs,
                            topic,
                            difficulty,
                            seedBase: seedBase + i * 13,
                            questionText: (p) => qText(p),
                            optionsFromKeys: (keys, byKey) => keys.map(k => byKey[k]),
                            correctIndexFn: (keys, correctKey) => keys.indexOf(correctKey),
                            explanationFn: (p) => `–ü—Ä–∞–≤–∏–ª—å–Ω–æ: ${p.value}.`
                        })
                    );
                });

                const inverted = pairs.map(p => ({ key: p.value, value: p.key }));
                const invPrompts = [
                    (p) => `–ö–∞–∫–æ–π —Ç–µ—Ä–º–∏–Ω —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—é: ¬´${p.key}¬ª?`,
                    (p) => `–í—ã–±–µ—Ä–∏—Ç–µ —Ç–µ—Ä–º–∏–Ω –ø–æ –æ–ø–∏—Å–∞–Ω–∏—é: ¬´${p.key}¬ª.`
                ];
                invPrompts.forEach((qText, i) => {
                    out.push(
                        ...buildMcqFromPairs({
                            prefix: `${prefix}_${suffix}_inv${i + 1}`,
                            pairs: inverted,
                            topic,
                            difficulty,
                            seedBase: seedBase + 97 + i * 17,
                            questionText: (p) => qText(p),
                            optionsFromKeys: (keys, byKey) => keys.map(k => byKey[k]),
                            correctIndexFn: (keys, correctKey) => keys.indexOf(correctKey),
                            explanationFn: (p) => `–ü—Ä–∞–≤–∏–ª—å–Ω–æ: ${p.value}.`
                        })
                    );
                });
            };

            const isSenior = band === '10-11';
            const isJunior = band === '1-4' || band === '5-6';
            const isMiddle = band === '7-8';
            const isGrade9 = band === '9';

            if (isSenior) {
                const molBio = [
                    { key: '–†–µ–ø–ª–∏–∫–∞—Ü–∏—è', value: '–£–¥–≤–æ–µ–Ω–∏–µ –î–ù–ö –ø–µ—Ä–µ–¥ –¥–µ–ª–µ–Ω–∏–µ–º –∫–ª–µ—Ç–∫–∏' },
                    { key: '–¢—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏—è', value: '–°–∏–Ω—Ç–µ–∑ –†–ù–ö –Ω–∞ –º–∞—Ç—Ä–∏—Ü–µ –î–ù–ö' },
                    { key: '–¢—Ä–∞–Ω—Å–ª—è—Ü–∏—è', value: '–°–∏–Ω—Ç–µ–∑ –±–µ–ª–∫–∞ –Ω–∞ —Ä–∏–±–æ—Å–æ–º–∞—Ö –ø–æ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –º–†–ù–ö' },
                    { key: '–ö–æ–¥–æ–Ω', value: '–¢—Ä–∏–ø–ª–µ—Ç –Ω—É–∫–ª–µ–æ—Ç–∏–¥–æ–≤ –º–†–ù–ö, –∫–æ–¥–∏—Ä—É—é—â–∏–π –∞–º–∏–Ω–æ–∫–∏—Å–ª–æ—Ç—É' },
                    { key: '–ê–Ω—Ç–∏–∫–æ–¥–æ–Ω', value: '–¢—Ä–∏–ø–ª–µ—Ç —Ç–†–ù–ö, –∫–æ–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ä–Ω—ã–π –∫–æ–¥–æ–Ω—É –º–†–ù–ö' },
                    { key: '–ì–µ–Ω–µ—Ç–∏—á–µ—Å–∫–∏–π –∫–æ–¥', value: '–°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –º–µ–∂–¥—É –∫–æ–¥–æ–Ω–∞–º–∏ –∏ –∞–º–∏–Ω–æ–∫–∏—Å–ª–æ—Ç–∞–º–∏' },
                    { key: '–ê–ø–æ–ø—Ç–æ–∑', value: '–ü—Ä–æ–≥—Ä–∞–º–º–∏—Ä—É–µ–º–∞—è –≥–∏–±–µ–ª—å –∫–ª–µ—Ç–∫–∏' },
                    { key: '–ú—É—Ç–∞—Ü–∏—è', value: '–°—Ç–æ–π–∫–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –≥–µ–Ω–µ—Ç–∏—á–µ—Å–∫–æ–≥–æ –º–∞—Ç–µ—Ä–∏–∞–ª–∞' },
                    { key: '–ê–ª–ª–µ–ª—å', value: '–û–¥–Ω–∞ –∏–∑ —Ñ–æ—Ä–º –≥–µ–Ω–∞' },
                    { key: '–ì–µ–Ω–æ–º', value: '–°–æ–≤–æ–∫—É–ø–Ω–æ—Å—Ç—å –≥–µ–Ω–µ—Ç–∏—á–µ—Å–∫–æ–≥–æ –º–∞—Ç–µ—Ä–∏–∞–ª–∞ –æ—Ä–≥–∞–Ω–∏–∑–º–∞' },
                    { key: '–ö—Ä–æ—Å—Å–∏–Ω–≥–æ–≤–µ—Ä', value: '–û–±–º–µ–Ω —É—á–∞—Å—Ç–∫–∞–º–∏ –º–µ–∂–¥—É –≥–æ–º–æ–ª–æ–≥–∏—á–Ω—ã–º–∏ —Ö—Ä–æ–º–æ—Å–æ–º–∞–º–∏ –≤ –º–µ–π–æ–∑–µ' },
                    { key: '–ú–µ–π–æ–∑', value: '–î–µ–ª–µ–Ω–∏–µ, —É–º–µ–Ω—å—à–∞—é—â–µ–µ –Ω–∞–±–æ—Ä —Ö—Ä–æ–º–æ—Å–æ–º –≤–¥–≤–æ–µ (–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –≥–∞–º–µ—Ç)' },
                    { key: '–ú–∏—Ç–æ–∑', value: '–î–µ–ª–µ–Ω–∏–µ –∫–ª–µ—Ç–∫–∏ —Å –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ–º –≥–µ–Ω–µ—Ç–∏—á–µ—Å–∫–∏ –∏–¥–µ–Ω—Ç–∏—á–Ω—ã—Ö –∫–ª–µ—Ç–æ–∫' },
                    { key: '–ö–∞—Ä–∏–æ—Ç–∏–ø', value: '–ù–∞–±–æ—Ä —Ö—Ä–æ–º–æ—Å–æ–º –≤–∏–¥–∞ (—á–∏—Å–ª–æ, —Ñ–æ—Ä–º–∞, —Ä–∞–∑–º–µ—Ä—ã)' },
                    { key: '–ü–ª–∞–∑–º–∏–¥–∞', value: '–ù–µ–±–æ–ª—å—à–∞—è –∫–æ–ª—å—Ü–µ–≤–∞—è –î–ù–ö –±–∞–∫—Ç–µ—Ä–∏–π, –Ω–µ—Å—É—â–∞—è –¥–æ–ø. –≥–µ–Ω—ã' }
                ];

                const phys = [
                    { key: '–ì–æ–º–µ–æ—Å—Ç–∞–∑', value: '–ü–æ–¥–¥–µ—Ä–∂–∞–Ω–∏–µ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ–≥–æ –ø–æ—Å—Ç–æ—è–Ω—Å—Ç–≤–∞ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–π —Å—Ä–µ–¥—ã' },
                    { key: '–û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–∞—è –æ–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å', value: '–ú–µ—Ö–∞–Ω–∏–∑–º —Ä–µ–≥—É–ª—è—Ü–∏–∏, —É–º–µ–Ω—å—à–∞—é—â–∏–π –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞' },
                    { key: '–ù–µ—Ä–≤–Ω—ã–π –∏–º–ø—É–ª—å—Å', value: '–≠–ª–µ–∫—Ç—Ä–æ—Ö–∏–º–∏—á–µ—Å–∫–∏–π —Å–∏–≥–Ω–∞–ª –≤ –Ω–µ—Ä–≤–Ω–æ–π —Ç–∫–∞–Ω–∏' },
                    { key: '–°–∏–Ω–∞–ø—Å', value: '–ö–æ–Ω—Ç–∞–∫—Ç –º–µ–∂–¥—É –Ω–µ–π—Ä–æ–Ω–∞–º–∏ (–∏–ª–∏ –Ω–µ–π—Ä–æ–Ω–æ–º –∏ –∫–ª–µ—Ç–∫–æ–π-–º–∏—à–µ–Ω—å—é)' },
                    { key: '–§–µ—Ä–º–µ–Ω—Ç', value: '–ë–µ–ª–æ–∫-–∫–∞—Ç–∞–ª–∏–∑–∞—Ç–æ—Ä, —É—Å–∫–æ—Ä—è—é—â–∏–π –±–∏–æ—Ö–∏–º–∏—á–µ—Å–∫–∏–µ —Ä–µ–∞–∫—Ü–∏–∏' },
                    { key: '–ì–æ—Ä–º–æ–Ω', value: '–°–∏–≥–Ω–∞–ª—å–Ω–æ–µ –≤–µ—â–µ—Å—Ç–≤–æ, —Ä–µ–≥—É–ª–∏—Ä—É—é—â–µ–µ —Ñ—É–Ω–∫—Ü–∏–∏ –æ—Ä–≥–∞–Ω–æ–≤' },
                    { key: '–ò–º–º—É–Ω–∏—Ç–µ—Ç', value: '–°–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –æ—Ä–≥–∞–Ω–∏–∑–º–∞ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞—Ç—å –∏ —É—Å—Ç—Ä–∞–Ω—è—Ç—å —á—É–∂–µ—Ä–æ–¥–Ω—ã–µ –∞–≥–µ–Ω—Ç—ã' },
                    { key: '–ê–Ω—Ç–∏—Ç–µ–ª–æ', value: '–ë–µ–ª–æ–∫ –∏–º–º—É–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã, —Å–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏ —Å–≤—è–∑—ã–≤–∞—é—â–∏–π –∞–Ω—Ç–∏–≥–µ–Ω' },
                    { key: '–ê–Ω—Ç–∏–≥–µ–Ω', value: '–ß—É–∂–µ—Ä–æ–¥–Ω–∞—è –º–æ–ª–µ–∫—É–ª–∞, –≤—ã–∑—ã–≤–∞—é—â–∞—è –∏–º–º—É–Ω–Ω—ã–π –æ—Ç–≤–µ—Ç' },
                    { key: '–î—ã—Ö–∞—Ç–µ–ª—å–Ω–∞—è —Ü–µ–ø—å', value: '–°–∏—Å—Ç–µ–º–∞ –ø–µ—Ä–µ–Ω–æ—Å–∞ —ç–ª–µ–∫—Ç—Ä–æ–Ω–æ–≤ –≤ –º–∏—Ç–æ—Ö–æ–Ω–¥—Ä–∏—è—Ö –¥–ª—è —Å–∏–Ω—Ç–µ–∑–∞ –ê–¢–§' },
                    { key: '–ê–¢–§', value: '–£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è –º–æ–ª–µ–∫—É–ª–∞-–Ω–æ—Å–∏—Ç–µ–ª—å —ç–Ω–µ—Ä–≥–∏–∏ –≤ –∫–ª–µ—Ç–∫–µ' },
                    { key: '–û—Å–º–æ—Å', value: '–î–∏—Ñ—Ñ—É–∑–∏—è –≤–æ–¥—ã —á–µ—Ä–µ–∑ –ø–æ–ª—É–ø—Ä–æ–Ω–∏—Ü–∞–µ–º—É—é –º–µ–º–±—Ä–∞–Ω—É' },
                    { key: '–î–∏—Ñ—Ñ—É–∑–∏—è', value: '–°–∞–º–æ–ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–µ –ø–µ—Ä–µ–º–µ—à–∏–≤–∞–Ω–∏–µ —á–∞—Å—Ç–∏—Ü –∏–∑-–∑–∞ —Ç–µ–ø–ª–æ–≤–æ–≥–æ –¥–≤–∏–∂–µ–Ω–∏—è' }
                ];

                const ecologyEvolution = [
                    { key: '–ü–æ–ø—É–ª—è—Ü–∏—è', value: '–°–æ–≤–æ–∫—É–ø–Ω–æ—Å—Ç—å –æ—Å–æ–±–µ–π –æ–¥–Ω–æ–≥–æ –≤–∏–¥–∞ –Ω–∞ –æ–±—â–µ–π —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–∏' },
                    { key: '–ì–µ–Ω–æ—Ñ–æ–Ω–¥', value: '–°–æ–≤–æ–∫—É–ø–Ω–æ—Å—Ç—å –≥–µ–Ω–æ–≤ –ø–æ–ø—É–ª—è—Ü–∏–∏' },
                    { key: '–ï—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–π –æ—Ç–±–æ—Ä', value: '–í—ã–∂–∏–≤–∞–Ω–∏–µ –∏ —Ä–∞–∑–º–Ω–æ–∂–µ–Ω–∏–µ –Ω–∞–∏–±–æ–ª–µ–µ –ø—Ä–∏—Å–ø–æ—Å–æ–±–ª–µ–Ω–Ω—ã—Ö' },
                    { key: '–î—Ä–µ–π—Ñ –≥–µ–Ω–æ–≤', value: '–°–ª—É—á–∞–π–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —á–∞—Å—Ç–æ—Ç –∞–ª–ª–µ–ª–µ–π –≤ –ø–æ–ø—É–ª—è—Ü–∏–∏' },
                    { key: '–ò–∑–æ–ª—è—Ü–∏—è', value: '–†–∞–∑–æ–±—â–µ–Ω–∏–µ –ø–æ–ø—É–ª—è—Ü–∏–π, –ø—Ä–µ–ø—è—Ç—Å—Ç–≤—É—é—â–µ–µ —Å–∫—Ä–µ—â–∏–≤–∞–Ω–∏—é' },
                    { key: '–í–∏–¥–æ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ', value: '–ü—Ä–æ—Ü–µ—Å—Å –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏—è –Ω–æ–≤—ã—Ö –≤–∏–¥–æ–≤' },
                    { key: '–°—É–∫—Ü–µ—Å—Å–∏—è', value: '–ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–∞—è —Å–º–µ–Ω–∞ —Å–æ–æ–±—â–µ—Å—Ç–≤ –Ω–∞ —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–∏' },
                    { key: '–≠–∫–æ–ª–æ–≥–∏—á–µ—Å–∫–∞—è –Ω–∏—à–∞', value: '–†–æ–ª—å –≤–∏–¥–∞ –≤ —ç–∫–æ—Å–∏—Å—Ç–µ–º–µ –∏ —É—Å–ª–æ–≤–∏—è –µ–≥–æ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è' },
                    { key: '–ö–æ–Ω–∫—É—Ä–µ–Ω—Ü–∏—è', value: '–í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ –æ—Ä–≥–∞–Ω–∏–∑–º–æ–≤ –∑–∞ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã' },
                    { key: '–°–∏–º–±–∏–æ–∑', value: '–¢–µ—Å–Ω–æ–µ —Å–æ–≤–º–µ—Å—Ç–Ω–æ–µ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ –æ—Ä–≥–∞–Ω–∏–∑–º–æ–≤ —Ä–∞–∑–Ω—ã—Ö –≤–∏–¥–æ–≤' },
                    { key: '–¢—Ä–æ—Ñ–∏—á–µ—Å–∫–∞—è —Ü–µ–ø—å', value: '–ü–µ—Ä–µ–¥–∞—á–∞ –≤–µ—â–µ—Å—Ç–≤–∞ –∏ —ç–Ω–µ—Ä–≥–∏–∏ —á–µ—Ä–µ–∑ –ø–∏—Ç–∞–Ω–∏–µ' },
                    { key: '–ü—Ä–æ–¥—É—Ü–µ–Ω—Ç—ã', value: '–û—Ä–≥–∞–Ω–∏–∑–º—ã, —Å–æ–∑–¥–∞—é—â–∏–µ –æ—Ä–≥–∞–Ω–∏—á–µ—Å–∫–æ–µ –≤–µ—â–µ—Å—Ç–≤–æ (–æ–±—ã—á–Ω–æ —Ä–∞—Å—Ç–µ–Ω–∏—è)' },
                    { key: '–ö–æ–Ω—Å—É–º–µ–Ω—Ç—ã', value: '–û—Ä–≥–∞–Ω–∏–∑–º—ã, –ø–∏—Ç–∞—é—â–∏–µ—Å—è –≥–æ—Ç–æ–≤—ã–º –æ—Ä–≥–∞–Ω–∏—á–µ—Å–∫–∏–º –≤–µ—â–µ—Å—Ç–≤–æ–º' },
                    { key: '–†–µ–¥—É—Ü–µ–Ω—Ç—ã', value: '–û—Ä–≥–∞–Ω–∏–∑–º—ã, —Ä–∞–∑–ª–∞–≥–∞—é—â–∏–µ –æ—Ä–≥–∞–Ω–∏–∫—É –¥–æ –º–∏–Ω–µ—Ä–∞–ª—å–Ω—ã—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π' }
                ];

                const genetics = [
                    { key: '–ó–∞–∫–æ–Ω –µ–¥–∏–Ω–æ–æ–±—Ä–∞–∑–∏—è –≥–∏–±—Ä–∏–¥–æ–≤ F1', value: '–ü—Ä–∏ —Å–∫—Ä–µ—â–∏–≤–∞–Ω–∏–∏ –≥–æ–º–æ–∑–∏–≥–æ—Ç —Ä–∞–∑–ª–∏—á–∞—é—â–∏—Ö—Å—è —Ñ–æ—Ä–º –≤—Å–µ F1 –æ–¥–∏–Ω–∞–∫–æ–≤—ã (–¥–æ–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ)' },
                    { key: '–ó–∞–∫–æ–Ω —Ä–∞—Å—â–µ–ø–ª–µ–Ω–∏—è', value: '–í–æ –≤—Ç–æ—Ä–æ–º –ø–æ–∫–æ–ª–µ–Ω–∏–∏ –ø—Ä–∏–∑–Ω–∞–∫–∏ —Ä–∞—Å—â–µ–ø–ª—è—é—Ç—Å—è –≤ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã—Ö —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏—è—Ö' },
                    { key: '–ù–µ–∑–∞–≤–∏—Å–∏–º–æ–µ –Ω–∞—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ', value: '–ü—Ä–∏–∑–Ω–∞–∫–∏ –Ω–∞—Å–ª–µ–¥—É—é—Ç—Å—è –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ, –µ—Å–ª–∏ –≥–µ–Ω—ã –≤ —Ä–∞–∑–Ω—ã—Ö —Ö—Ä–æ–º–æ—Å–æ–º–∞—Ö' },
                    { key: '–ì–æ–º–æ–∑–∏–≥–æ—Ç–∞', value: '–û—Ä–≥–∞–Ω–∏–∑–º —Å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º–∏ –∞–ª–ª–µ–ª—è–º–∏ –¥–∞–Ω–Ω–æ–≥–æ –≥–µ–Ω–∞' },
                    { key: '–ì–µ—Ç–µ—Ä–æ–∑–∏–≥–æ—Ç–∞', value: '–û—Ä–≥–∞–Ω–∏–∑–º —Å —Ä–∞–∑–Ω—ã–º–∏ –∞–ª–ª–µ–ª—è–º–∏ –¥–∞–Ω–Ω–æ–≥–æ –≥–µ–Ω–∞' },
                    { key: '–î–æ–º–∏–Ω–∞–Ω—Ç–Ω—ã–π –ø—Ä–∏–∑–Ω–∞–∫', value: '–ü—Ä–æ—è–≤–ª—è–µ—Ç—Å—è –≤ —Ñ–µ–Ω–æ—Ç–∏–ø–µ –≥–µ—Ç–µ—Ä–æ–∑–∏–≥–æ—Ç—ã' },
                    { key: '–†–µ—Ü–µ—Å—Å–∏–≤–Ω—ã–π –ø—Ä–∏–∑–Ω–∞–∫', value: '–ü—Ä–æ—è–≤–ª—è–µ—Ç—Å—è –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –¥–æ–º–∏–Ω–∞–Ω—Ç–Ω–æ–≥–æ (–æ–±—ã—á–Ω–æ –≤ –≥–æ–º–æ–∑–∏–≥–æ—Ç–µ)' },
                    { key: '–ù–µ–ø–æ–ª–Ω–æ–µ –¥–æ–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ', value: '–§–µ–Ω–æ—Ç–∏–ø –≥–µ—Ç–µ—Ä–æ–∑–∏–≥–æ—Ç—ã –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–π –º–µ–∂–¥—É –≥–æ–º–æ–∑–∏–≥–æ—Ç–∞–º–∏' },
                    { key: '–ö–æ–¥–æ–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ', value: '–û–±–∞ –∞–ª–ª–µ–ª—è –ø—Ä–æ—è–≤–ª—è—é—Ç—Å—è –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≥—Ä—É–ø–ø—ã –∫—Ä–æ–≤–∏ AB)' },
                    { key: '–°—Ü–µ–ø–ª–µ–Ω–Ω–æ–µ –Ω–∞—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ', value: '–°–æ–≤–º–µ—Å—Ç–Ω–æ–µ –Ω–∞—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –≥–µ–Ω–æ–≤, —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–Ω—ã—Ö –≤ –æ–¥–Ω–æ–π —Ö—Ä–æ–º–æ—Å–æ–º–µ' },
                    { key: '–ö–∞—Ä—Ç–∞ —Ö—Ä–æ–º–æ—Å–æ–º—ã', value: '–°—Ö–µ–º–∞ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏—è –≥–µ–Ω–æ–≤ –≤ —Ö—Ä–æ–º–æ—Å–æ–º–µ' },
                    { key: '–ì–µ–Ω–µ—Ç–∏—á–µ—Å–∫–∞—è —Ä–µ–∫–æ–º–±–∏–Ω–∞—Ü–∏—è', value: '–û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö —Å–æ—á–µ—Ç–∞–Ω–∏–π –∞–ª–ª–µ–ª–µ–π' },
                    { key: '–¢–µ—Å—Ç-—Å–∫—Ä–µ—â–∏–≤–∞–Ω–∏–µ', value: '–°–∫—Ä–µ—â–∏–≤–∞–Ω–∏–µ —Å –≥–æ–º–æ–∑–∏–≥–æ—Ç–æ–π –ø–æ —Ä–µ—Ü–µ—Å—Å–∏–≤—É –¥–ª—è –≤—ã—è—Å–Ω–µ–Ω–∏—è –≥–µ–Ω–æ—Ç–∏–ø–∞' },
                    { key: '–ú—É—Ç–∞–≥–µ–Ω', value: '–§–∞–∫—Ç–æ—Ä, –ø–æ–≤—ã—à–∞—é—â–∏–π —á–∞—Å—Ç–æ—Ç—É –º—É—Ç–∞—Ü–∏–π' },
                    { key: '–•—Ä–æ–º–æ—Å–æ–º–Ω–∞—è –º—É—Ç–∞—Ü–∏—è', value: '–ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Ö—Ä–æ–º–æ—Å–æ–º—ã (–¥–µ–ª–µ—Ü–∏—è, –∏–Ω–≤–µ—Ä—Å–∏—è, –¥—É–ø–ª–∏–∫–∞—Ü–∏—è)' },
                    { key: '–ì–µ–Ω–Ω–∞—è –º—É—Ç–∞—Ü–∏—è', value: '–ò–∑–º–µ–Ω–µ–Ω–∏–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –Ω—É–∫–ª–µ–æ—Ç–∏–¥–æ–≤ –≤ –≥–µ–Ω–µ' },
                    { key: '–ü–æ–ª–∏–ø–ª–æ–∏–¥–∏—è', value: '–£–≤–µ–ª–∏—á–µ–Ω–∏–µ —á–∏—Å–ª–∞ –Ω–∞–±–æ—Ä–æ–≤ —Ö—Ä–æ–º–æ—Å–æ–º' },
                    { key: '–ê–Ω–µ—É–ø–ª–æ–∏–¥–∏—è', value: '–ò–∑–º–µ–Ω–µ–Ω–∏–µ —á–∏—Å–ª–∞ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö —Ö—Ä–æ–º–æ—Å–æ–º (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Ç—Ä–∏—Å–æ–º–∏—è)' },
                    { key: '–ì–µ–Ω–µ—Ç–∏—á–µ—Å–∫–∏–π –¥—Ä–µ–π—Ñ', value: '–°–ª—É—á–∞–π–Ω–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ —á–∞—Å—Ç–æ—Ç –∞–ª–ª–µ–ª–µ–π –≤ –º–∞–ª—ã—Ö –ø–æ–ø—É–ª—è—Ü–∏—è—Ö' },
                    { key: '–ü–∞–Ω–º–∏–∫—Å–∏—è', value: '–°–ª—É—á–∞–π–Ω–æ–µ —Å–∫—Ä–µ—â–∏–≤–∞–Ω–∏–µ –≤ –ø–æ–ø—É–ª—è—Ü–∏–∏' }
                    ,{ key: '–ü–æ–ª–∏–≥–µ–Ω–Ω–æ–µ –Ω–∞—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ', value: '–ù–∞—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–∞, –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ–º–æ–≥–æ –º–Ω–æ–≥–∏–º–∏ –≥–µ–Ω–∞–º–∏' }
                    ,{ key: '–≠–ø–∏—Å—Ç–∞–∑', value: '–í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ –≥–µ–Ω–æ–≤, –ø—Ä–∏ –∫–æ—Ç–æ—Ä–æ–º –æ–¥–∏–Ω –≥–µ–Ω –ø–æ–¥–∞–≤–ª—è–µ—Ç –ø—Ä–æ—è–≤–ª–µ–Ω–∏–µ –¥—Ä—É–≥–æ–≥–æ' }
                    ,{ key: '–ü–ª–µ–π–æ—Ç—Ä–æ–ø–∏—è', value: '–í–ª–∏—è–Ω–∏–µ –æ–¥–Ω–æ–≥–æ –≥–µ–Ω–∞ –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤' }
                    ,{ key: '–ü–µ–Ω–µ—Ç—Ä–∞–Ω—Ç–Ω–æ—Å—Ç—å', value: '–ß–∞—Å—Ç–æ—Ç–∞ –ø—Ä–æ—è–≤–ª–µ–Ω–∏—è –≥–µ–Ω–∞ –≤ —Ñ–µ–Ω–æ—Ç–∏–ø–µ —É –Ω–æ—Å–∏—Ç–µ–ª–µ–π' }
                ];

                addTwoWayDefinitions({ suffix: 'mol', pairs: molBio, topic: '–ú–æ–ª–µ–∫—É–ª—è—Ä–Ω–∞—è –±–∏–æ–ª–æ–≥–∏—è', difficulty: 4, seedBase: 1101 });
                addTwoWayDefinitions({ suffix: 'phys', pairs: phys, topic: '–§–∏–∑–∏–æ–ª–æ–≥–∏—è –∏ —Ä–µ–≥—É–ª—è—Ü–∏—è', difficulty: 4, seedBase: 1201 });
                addTwoWayDefinitions({ suffix: 'eco', pairs: ecologyEvolution, topic: '–≠–∫–æ–ª–æ–≥–∏—è –∏ —ç–≤–æ–ª—é—Ü–∏—è', difficulty: 4, seedBase: 1301 });
                addTwoWayDefinitions({ suffix: 'gen', pairs: genetics, topic: '–ì–µ–Ω–µ—Ç–∏–∫–∞', difficulty: 4, seedBase: 1401 });
            } else {
                // –î–ª—è –º–ª–∞–¥—à–∏—Ö/—Å—Ä–µ–¥–Ω–∏—Ö –æ—Å—Ç–∞–≤–ª—è–µ–º –±–∞–∑—É, –Ω–æ –±–µ–∑ "–¥–µ—Ç—Å–∫–∏—Ö" –≤–æ–ø—Ä–æ—Å–æ–≤ –≤ —Å—Ç–∞—Ä—à–∏—Ö –∫–ª–∞—Å—Å–∞—Ö.

                if (isJunior) {
                    const organToFunc = [
                        { key: '–õ—ë–≥–∫–∏–µ', value: '–î—ã—Ö–∞–Ω–∏–µ (–≥–∞–∑–æ–æ–±–º–µ–Ω)' },
                        { key: '–°–µ—Ä–¥—Ü–µ', value: '–ü–µ—Ä–µ–∫–∞—á–∏–≤–∞–Ω–∏–µ –∫—Ä–æ–≤–∏' },
                        { key: '–ñ–µ–ª—É–¥–æ–∫', value: '–ù–∞—á–∞–ª—å–Ω–æ–µ –ø–µ—Ä–µ–≤–∞—Ä–∏–≤–∞–Ω–∏–µ –ø–∏—â–∏' },
                        { key: '–ü–µ—á–µ–Ω—å', value: '–û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –∂–µ–ª—á–∏ –∏ –æ–±–µ–∑–≤—Ä–µ–∂–∏–≤–∞–Ω–∏–µ –≤—Ä–µ–¥–Ω—ã—Ö –≤–µ—â–µ—Å—Ç–≤' },
                        { key: '–ü–æ—á–∫–∏', value: '–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∫—Ä–æ–≤–∏ –∏ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –º–æ—á–∏' },
                        { key: '–ú–æ–∑–≥', value: '–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–æ–π –æ—Ä–≥–∞–Ω–∏–∑–º–∞' },
                        { key: '–ö–æ–∂–∞', value: '–ó–∞—â–∏—Ç–∞ —Ç–µ–ª–∞ –∏ —Ç–µ—Ä–º–æ—Ä–µ–≥—É–ª—è—Ü–∏—è' },
                        { key: '–ö–∏—à–µ—á–Ω–∏–∫', value: '–í—Å–∞—Å—ã–≤–∞–Ω–∏–µ –ø–∏—Ç–∞—Ç–µ–ª—å–Ω—ã—Ö –≤–µ—â–µ—Å—Ç–≤' }
                    ];
                    out.push(
                        ...buildMcqFromPairs({
                            prefix: `${prefix}_organs`,
                            pairs: organToFunc,
                            topic: band === '1-4' ? '–ß–µ–ª–æ–≤–µ–∫' : '–ê–Ω–∞—Ç–æ–º–∏—è',
                            difficulty: diff,
                            seedBase: 11,
                            questionText: (p) => `–ö–∞–∫–∞—è –æ—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –æ—Ä–≥–∞–Ω–∞ ¬´${p.key}¬ª?`,
                            optionsFromKeys: (keys, byKey) => keys.map(k => byKey[k]),
                            correctIndexFn: (keys, correctKey) => keys.indexOf(correctKey),
                            explanationFn: (p) => `${p.key}: ${p.value}.`
                        })
                    );

                    const senseToOrgan = [
                        { key: '–ó—Ä–µ–Ω–∏–µ', value: '–ì–ª–∞–∑–∞' },
                        { key: '–°–ª—É—Ö', value: '–£—à–∏' },
                        { key: '–û–±–æ–Ω—è–Ω–∏–µ', value: '–ù–æ—Å' },
                        { key: '–í–∫—É—Å', value: '–Ø–∑—ã–∫' },
                        { key: '–û—Å—è–∑–∞–Ω–∏–µ', value: '–ö–æ–∂–∞' }
                    ];
                    out.push(
                        ...buildMcqFromPairs({
                            prefix: `${prefix}_senses`,
                            pairs: senseToOrgan,
                            topic: '–ß–µ–ª–æ–≤–µ–∫',
                            difficulty: Math.max(1, diff - 1),
                            seedBase: 71,
                            questionText: (p) => `–ö–∞–∫–æ–π –æ—Ä–≥–∞–Ω –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ ¬´${p.key}¬ª?`,
                            optionsFromKeys: (keys, byKey) => keys.map(k => byKey[k]),
                            correctIndexFn: (keys, correctKey) => keys.indexOf(correctKey),
                            explanationFn: (p) => `${p.key} –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—Ç: ${p.value}.`
                        })
                    );
                }

                if (band !== '1-4' && !isSenior) {
                    const termToDef = [
                        { key: '–ö–ª–µ—Ç–∫–∞', value: '–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –∂–∏–≤–∞—è —Å–∏—Å—Ç–µ–º–∞' },
                        { key: '–¢–∫–∞–Ω—å', value: '–°–æ–≤–æ–∫—É–ø–Ω–æ—Å—Ç—å –∫–ª–µ—Ç–æ–∫, —Å—Ö–æ–¥–Ω—ã—Ö –ø–æ —Å—Ç—Ä–æ–µ–Ω–∏—é –∏ —Ñ—É–Ω–∫—Ü–∏—è–º' },
                        { key: '–û—Ä–≥–∞–Ω', value: '–ß–∞—Å—Ç—å —Ç–µ–ª–∞, –≤—ã–ø–æ–ª–Ω—è—é—â–∞—è –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é' },
                        { key: '–°–∏—Å—Ç–µ–º–∞ –æ—Ä–≥–∞–Ω–æ–≤', value: '–ì—Ä—É–ø–ø–∞ –æ—Ä–≥–∞–Ω–æ–≤, —Ä–∞–±–æ—Ç–∞—é—â–∏—Ö –≤–º–µ—Å—Ç–µ' },
                        { key: '–î–ù–ö', value: '–ú–æ–ª–µ–∫—É–ª–∞, –Ω–µ—Å—É—â–∞—è –Ω–∞—Å–ª–µ–¥—Å—Ç–≤–µ–Ω–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é' },
                        { key: '–ì–µ–Ω', value: '–£—á–∞—Å—Ç–æ–∫ –î–ù–ö, –æ–ø—Ä–µ–¥–µ–ª—è—é—â–∏–π –ø—Ä–∏–∑–Ω–∞–∫' },
                        { key: '–§–æ—Ç–æ—Å–∏–Ω—Ç–µ–∑', value: '–û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –æ—Ä–≥–∞–Ω–∏—á–µ—Å–∫–∏—Ö –≤–µ—â–µ—Å—Ç–≤ –Ω–∞ —Å–≤–µ—Ç—É –∏–∑ CO2 –∏ –≤–æ–¥—ã' },
                        { key: '–ü–æ–ø—É–ª—è—Ü–∏—è', value: '–°–æ–≤–æ–∫—É–ø–Ω–æ—Å—Ç—å –æ—Å–æ–±–µ–π –æ–¥–Ω–æ–≥–æ –≤–∏–¥–∞ –Ω–∞ —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–∏' },
                        { key: '–≠–∫–æ—Å–∏—Å—Ç–µ–º–∞', value: '–°–æ–æ–±—â–µ—Å—Ç–≤–æ –æ—Ä–≥–∞–Ω–∏–∑–º–æ–≤ –∏ —Å—Ä–µ–¥–∞ –∏—Ö –æ–±–∏—Ç–∞–Ω–∏—è' },
                        { key: '–ï—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–π –æ—Ç–±–æ—Ä', value: '–í—ã–∂–∏–≤–∞–Ω–∏–µ –∏ —Ä–∞–∑–º–Ω–æ–∂–µ–Ω–∏–µ –Ω–∞–∏–±–æ–ª–µ–µ –ø—Ä–∏—Å–ø–æ—Å–æ–±–ª–µ–Ω–Ω—ã—Ö' }
                    ];
                    addTwoWayDefinitions({ suffix: 'terms', pairs: termToDef, topic: band === '5-6' ? '–û—Å–Ω–æ–≤—ã –±–∏–æ–ª–æ–≥–∏–∏' : '–ë–∏–æ–ª–æ–≥–∏—è', difficulty: diff, seedBase: 37 });
                }

                if (isMiddle || isGrade9) {
                    const cellAdvanced = [
                        { key: '–Ø–¥—Ä–æ', value: '–•—Ä–∞–Ω–µ–Ω–∏–µ –î–ù–ö –∏ —Ä–µ–≥—É–ª—è—Ü–∏—è –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –≤ –∫–ª–µ—Ç–∫–µ' },
                        { key: '–†–∏–±–æ—Å–æ–º—ã', value: '–°–∏–Ω—Ç–µ–∑ –±–µ–ª–∫–∞' },
                        { key: '–ú–∏—Ç–æ—Ö–æ–Ω–¥—Ä–∏–∏', value: '–°–∏–Ω—Ç–µ–∑ –ê–¢–§ –ø—Ä–∏ –∫–ª–µ—Ç–æ—á–Ω–æ–º –¥—ã—Ö–∞–Ω–∏–∏' },
                        { key: '–ê–ø–ø–∞—Ä–∞—Ç –ì–æ–ª—å–¥–∂–∏', value: '–ú–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ —É–ø–∞–∫–æ–≤–∫–∞ –≤–µ—â–µ—Å—Ç–≤ –¥–ª—è —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞' },
                        { key: '–≠–ü–°', value: '–°–∏–Ω—Ç–µ–∑/—Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç –≤–µ—â–µ—Å—Ç–≤ –≤–Ω—É—Ç—Ä–∏ –∫–ª–µ—Ç–∫–∏' },
                        { key: '–õ–∏–∑–æ—Å–æ–º—ã', value: '–í–Ω—É—Ç—Ä–∏–∫–ª–µ—Ç–æ—á–Ω–æ–µ –ø–∏—â–µ–≤–∞—Ä–µ–Ω–∏–µ' },
                        { key: '–•–ª–æ—Ä–æ–ø–ª–∞—Å—Ç—ã', value: '–§–æ—Ç–æ—Å–∏–Ω—Ç–µ–∑ (—É —Ä–∞—Å—Ç–µ–Ω–∏–π)' }
                    ];
                    addTwoWayDefinitions({ suffix: 'cell', pairs: cellAdvanced, topic: '–ö–ª–µ—Ç–∫–∞', difficulty: Math.min(3, diff), seedBase: 83 });
                }

                if (band === '1-4' || band === '5-6' || isMiddle) {
                    const plantPartToFunc = [
                        { key: '–ö–æ—Ä–µ–Ω—å', value: '–ó–∞–∫—Ä–µ–ø–ª—è–µ—Ç —Ä–∞—Å—Ç–µ–Ω–∏–µ –∏ –≤—Å–∞—Å—ã–≤–∞–µ—Ç –≤–æ–¥—É –∏ –º–∏–Ω–µ—Ä–∞–ª—å–Ω—ã–µ –≤–µ—â–µ—Å—Ç–≤–∞' },
                        { key: '–°—Ç–µ–±–µ–ª—å', value: '–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∏ –ø—Ä–æ–≤–æ–¥–∏—Ç –≤–µ—â–µ—Å—Ç–≤–∞' },
                        { key: '–õ–∏—Å—Ç', value: '–§–æ—Ç–æ—Å–∏–Ω—Ç–µ–∑ –∏ –≥–∞–∑–æ–æ–±–º–µ–Ω' },
                        { key: '–¶–≤–µ—Ç–æ–∫', value: '–†–∞–∑–º–Ω–æ–∂–µ–Ω–∏–µ (–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ —Å–µ–º—è–Ω)' },
                        { key: '–ü–ª–æ–¥', value: '–ó–∞—â–∏—â–∞–µ—Ç —Å–µ–º–µ–Ω–∞ –∏ –ø–æ–º–æ–≥–∞–µ—Ç —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏—é' }
                    ];
                    out.push(
                        ...buildMcqFromPairs({
                            prefix: `${prefix}_plants`,
                            pairs: plantPartToFunc,
                            topic: '–†–∞—Å—Ç–µ–Ω–∏—è',
                            difficulty: diff,
                            seedBase: 23,
                            questionText: (p) => `–ö–∞–∫–æ–≤–∞ –æ—Å–Ω–æ–≤–Ω–∞—è —Ä–æ–ª—å: ¬´${p.key}¬ª?`,
                            optionsFromKeys: (keys, byKey) => keys.map(k => byKey[k]),
                            correctIndexFn: (keys, correctKey) => keys.indexOf(correctKey),
                            explanationFn: (p) => `${p.key}: ${p.value}.`
                        })
                    );
                }

                if (band === '1-4' || band === '5-6') {
                    const seasonToChange = [
                        { key: '–í–µ—Å–Ω–∞', value: '–¢–∞—è–Ω–∏–µ —Å–Ω–µ–≥–∞ –∏ –Ω–∞—á–∞–ª–æ —Ä–æ—Å—Ç–∞ —Ä–∞—Å—Ç–µ–Ω–∏–π' },
                        { key: '–õ–µ—Ç–æ', value: '–°–∞–º—ã–µ —Ç—ë–ø–ª—ã–µ –¥–Ω–∏ –∏ –∞–∫—Ç–∏–≤–Ω—ã–π —Ä–æ—Å—Ç' },
                        { key: '–û—Å–µ–Ω—å', value: '–õ–∏—Å—Ç–æ–ø–∞–¥ –∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ –∑–∏–º–µ' },
                        { key: '–ó–∏–º–∞', value: '–•–æ–ª–æ–¥ –∏ —Å–Ω–µ–∂–Ω—ã–π –ø–æ–∫—Ä–æ–≤ (—á–∞—Å—Ç–æ)' }
                    ];
                    seasonToChange.forEach((s, idx) => {
                        const seed = 2001 + idx * 17;
                        const seasons = ['–í–µ—Å–Ω–∞', '–õ–µ—Ç–æ', '–û—Å–µ–Ω—å', '–ó–∏–º–∞'];
                        const distract = pickDistractors(seasons, s.key, 3, seed);
                        const options = shuffleWithSeed([s.key, ...distract], seed + 1);
                        out.push(
                            makeMcq({
                                id: stableId(`${prefix}_seasons`, idx + 1),
                                topic: '–ü—Ä–∏—Ä–æ–¥–∞',
                                difficulty: Math.max(1, diff - 1),
                                question: `–í –∫–∞–∫–æ–µ –≤—Ä–µ–º—è –≥–æ–¥–∞ –æ–±—ã—á–Ω–æ –Ω–∞–±–ª—é–¥–∞—é—Ç: ¬´${s.value}¬ª?`,
                                options,
                                correct: options.indexOf(s.key),
                                explanation: `–ß–∞—â–µ –≤—Å–µ–≥–æ —ç—Ç–æ –æ—Ç–Ω–æ—Å–∏—Ç—Å—è –∫: ${s.key}.`
                            })
                        );
                    });
                }
            }

            // –§–∏–Ω–∞–ª: —É–Ω–∏–∫–∞–ª–∏–∑–∏—Ä—É–µ–º, –ø–µ—Ä–µ–º–µ—à–∏–≤–∞–µ–º, –æ—Ç—Ä–µ–∑–∞–µ–º desiredCount
            const uniqByText = new Map();
            out.forEach(q => {
                const k = `${(q.question || '').trim()}@@${q.topic || ''}`;
                if (!uniqByText.has(k)) uniqByText.set(k, q);
            });
            const unique = Array.from(uniqByText.values());
            const rotated = shuffleWithSeed(unique, bandStartGrade * 101);
            return rotated
                .slice(0, desiredCount)
                .map(q => ({ ...q, subject: 'biology', gradeBand: band }));
        }

        function generateChemistryByGrade(bandStartGrade, desiredCount = 64) {
            const band = normalizeBandLabel(bandStartGrade);
            const prefix = `chemistry_${band}`;
            const diff = difficultyByBand(band);
            const out = [];

            const isSenior = band === '10-11';

            const addTwoWayDefinitions = ({ suffix, pairs, topic, difficulty, seedBase }) => {
                const defPrompts = [
                    (p) => `–í—ã–±–µ—Ä–∏—Ç–µ –≤–µ—Ä–Ω–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–µ—Ä–º–∏–Ω–∞: ¬´${p.key}¬ª.`,
                    (p) => `–ß—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç —Ç–µ—Ä–º–∏–Ω ¬´${p.key}¬ª?`
                ];
                defPrompts.forEach((qText, i) => {
                    out.push(
                        ...buildMcqFromPairs({
                            prefix: `${prefix}_${suffix}_def${i + 1}`,
                            pairs,
                            topic,
                            difficulty,
                            seedBase: seedBase + i * 13,
                            questionText: (p) => qText(p),
                            optionsFromKeys: (keys, byKey) => keys.map(k => byKey[k]),
                            correctIndexFn: (keys, correctKey) => keys.indexOf(correctKey),
                            explanationFn: (p) => `–ü—Ä–∞–≤–∏–ª—å–Ω–æ: ${p.value}.`
                        })
                    );
                });

                const inverted = pairs.map(p => ({ key: p.value, value: p.key }));
                const invPrompts = [
                    (p) => `–ö–∞–∫–æ–π —Ç–µ—Ä–º–∏–Ω —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—é: ¬´${p.key}¬ª?`,
                    (p) => `–í—ã–±–µ—Ä–∏—Ç–µ —Ç–µ—Ä–º–∏–Ω –ø–æ –æ–ø–∏—Å–∞–Ω–∏—é: ¬´${p.key}¬ª.`
                ];
                invPrompts.forEach((qText, i) => {
                    out.push(
                        ...buildMcqFromPairs({
                            prefix: `${prefix}_${suffix}_inv${i + 1}`,
                            pairs: inverted,
                            topic,
                            difficulty,
                            seedBase: seedBase + 97 + i * 17,
                            questionText: (p) => qText(p),
                            optionsFromKeys: (keys, byKey) => keys.map(k => byKey[k]),
                            correctIndexFn: (keys, correctKey) => keys.indexOf(correctKey),
                            explanationFn: (p) => `–ü—Ä–∞–≤–∏–ª—å–Ω–æ: ${p.value}.`
                        })
                    );
                });
            };

            if (isSenior) {
                const core = [
                    { key: '–ú–æ–ª—å', value: '–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–µ—â–µ—Å—Ç–≤–∞, —Å–æ–¥–µ—Ä–∂–∞—â–µ–µ —á–∏—Å–ª–æ –ê–≤–æ–≥–∞–¥—Ä–æ —á–∞—Å—Ç–∏—Ü' },
                    { key: '–ú–æ–ª—è—Ä–Ω–∞—è –º–∞—Å—Å–∞', value: '–ú–∞—Å—Å–∞ 1 –º–æ–ª—å –≤–µ—â–µ—Å—Ç–≤–∞ (–≥/–º–æ–ª—å)' },
                    { key: '–ú–æ–ª—è—Ä–Ω–∞—è –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏—è', value: '–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–µ—â–µ—Å—Ç–≤–∞ –≤ 1 –ª–∏—Ç—Ä–µ —Ä–∞—Å—Ç–≤–æ—Ä–∞ (–º–æ–ª—å/–ª)' },
                    { key: '–°—Ç–µ–ø–µ–Ω—å –æ–∫–∏—Å–ª–µ–Ω–∏—è', value: '–£—Å–ª–æ–≤–Ω—ã–π –∑–∞—Ä—è–¥ –∞—Ç–æ–º–∞ –≤ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–∏' },
                    { key: '–û–í–†', value: '–†–µ–∞–∫—Ü–∏—è —Å –ø–µ—Ä–µ–¥–∞—á–µ–π —ç–ª–µ–∫—Ç—Ä–æ–Ω–æ–≤ (–æ–∫–∏—Å–ª–µ–Ω–∏–µ –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ)' },
                    { key: '–û–∫–∏—Å–ª–∏—Ç–µ–ª—å', value: '–ß–∞—Å—Ç–∏—Ü–∞, –ø—Ä–∏–Ω–∏–º–∞—é—â–∞—è —ç–ª–µ–∫—Ç—Ä–æ–Ω—ã (–≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è)' },
                    { key: '–í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ–ª—å', value: '–ß–∞—Å—Ç–∏—Ü–∞, –æ—Ç–¥–∞—é—â–∞—è —ç–ª–µ–∫—Ç—Ä–æ–Ω—ã (–æ–∫–∏—Å–ª—è–µ—Ç—Å—è)' },
                    { key: '–•–∏–º–∏—á–µ—Å–∫–æ–µ —Ä–∞–≤–Ω–æ–≤–µ—Å–∏–µ', value: '–°–æ—Å—Ç–æ—è–Ω–∏–µ, –∫–æ–≥–¥–∞ —Å–∫–æ—Ä–æ—Å—Ç–∏ –ø—Ä—è–º–æ–π –∏ –æ–±—Ä–∞—Ç–Ω–æ–π —Ä–µ–∞–∫—Ü–∏–π —Ä–∞–≤–Ω—ã' },
                    { key: '–ö–æ–Ω—Å—Ç–∞–Ω—Ç–∞ —Ä–∞–≤–Ω–æ–≤–µ—Å–∏—è', value: '–í–µ–ª–∏—á–∏–Ω–∞, —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏–∑—É—é—â–∞—è –ø–æ–ª–æ–∂–µ–Ω–∏–µ —Ä–∞–≤–Ω–æ–≤–µ—Å–∏—è' },
                    { key: '–ü—Ä–∏–Ω—Ü–∏–ø –õ–µ –®–∞—Ç–µ–ª—å–µ', value: '–°–º–µ—â–µ–Ω–∏–µ —Ä–∞–≤–Ω–æ–≤–µ—Å–∏—è –ø—Ä–∏ –≤–Ω–µ—à–Ω–µ–º –≤–æ–∑–¥–µ–π—Å—Ç–≤–∏–∏' },
                    { key: '–°–∫–æ—Ä–æ—Å—Ç—å —Ä–µ–∞–∫—Ü–∏–∏', value: '–ò–∑–º–µ–Ω–µ–Ω–∏–µ –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏–∏ —Ä–µ–∞–≥–µ–Ω—Ç–∞/–ø—Ä–æ–¥—É–∫—Ç–∞ –∑–∞ –µ–¥–∏–Ω–∏—Ü—É –≤—Ä–µ–º–µ–Ω–∏' },
                    { key: '–ö–∞—Ç–∞–ª–∏–∑–∞—Ç–æ—Ä', value: '–í–µ—â–µ—Å—Ç–≤–æ, —É—Å–∫–æ—Ä—è—é—â–µ–µ —Ä–µ–∞–∫—Ü–∏—é –∏ –Ω–µ —Ä–∞—Å—Ö–æ–¥—É—é—â–µ–µ—Å—è' },
                    { key: '–¢–µ–ø–ª–æ–≤–æ–π —ç—Ñ—Ñ–µ–∫—Ç —Ä–µ–∞–∫—Ü–∏–∏', value: '–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–µ–ø–ª–æ—Ç—ã, –≤—ã–¥–µ–ª—è–µ–º–æ–µ/–ø–æ–≥–ª–æ—â–∞–µ–º–æ–µ –≤ —Ä–µ–∞–∫—Ü–∏–∏' },
                    { key: '–≠–ª–µ–∫—Ç—Ä–æ–ª–∏—Ç–∏—á–µ—Å–∫–∞—è –¥–∏—Å—Å–æ—Ü–∏–∞—Ü–∏—è', value: '–†–∞—Å–ø–∞–¥ —ç–ª–µ–∫—Ç—Ä–æ–ª–∏—Ç–∞ –Ω–∞ –∏–æ–Ω—ã –≤ —Ä–∞—Å—Ç–≤–æ—Ä–µ' }
                ];

                const solutions = [
                    { key: '–†–∞—Å—Ç–≤–æ—Ä', value: '–û–¥–Ω–æ—Ä–æ–¥–Ω–∞—è —Å–º–µ—Å—å —Ä–∞—Å—Ç–≤–æ—Ä–∏—Ç–µ–ª—è –∏ —Ä–∞—Å—Ç–≤–æ—Ä—ë–Ω–Ω–æ–≥–æ –≤–µ—â–µ—Å—Ç–≤–∞' },
                    { key: '–†–∞—Å—Ç–≤–æ—Ä–∏—Ç–µ–ª—å', value: '–ö–æ–º–ø–æ–Ω–µ–Ω—Ç —Ä–∞—Å—Ç–≤–æ—Ä–∞ –≤ –±–æ–ª—å—à–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ' },
                    { key: '–†–∞—Å—Ç–≤–æ—Ä—ë–Ω–Ω–æ–µ –≤–µ—â–µ—Å—Ç–≤–æ', value: '–ö–æ–º–ø–æ–Ω–µ–Ω—Ç —Ä–∞—Å—Ç–≤–æ—Ä–∞ –≤ –º–µ–Ω—å—à–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ' },
                    { key: '–ú–∞—Å—Å–æ–≤–∞—è –¥–æ–ª—è', value: '–û—Ç–Ω–æ—à–µ–Ω–∏–µ –º–∞—Å—Å—ã –≤–µ—â–µ—Å—Ç–≤–∞ –∫ –º–∞—Å—Å–µ —Ä–∞—Å—Ç–≤–æ—Ä–∞' },
                    { key: '–¢–∏—Ç—Ä', value: '–ú–∞—Å—Å–∞ —Ä–∞—Å—Ç–≤–æ—Ä—ë–Ω–Ω–æ–≥–æ –≤–µ—â–µ—Å—Ç–≤–∞ –≤ 1 –º–ª —Ä–∞—Å—Ç–≤–æ—Ä–∞' },
                    { key: '–≠–ª–µ–∫—Ç—Ä–æ–ª–∏—Ç', value: '–í–µ—â–µ—Å—Ç–≤–æ, —Ä–∞—Å—Ç–≤–æ—Ä/—Ä–∞—Å–ø–ª–∞–≤ –∫–æ—Ç–æ—Ä–æ–≥–æ –ø—Ä–æ–≤–æ–¥–∏—Ç —Ç–æ–∫' },
                    { key: '–ù–µ—ç–ª–µ–∫—Ç—Ä–æ–ª–∏—Ç', value: '–í–µ—â–µ—Å—Ç–≤–æ, —Ä–∞—Å—Ç–≤–æ—Ä –∫–æ—Ç–æ—Ä–æ–≥–æ –Ω–µ –ø—Ä–æ–≤–æ–¥–∏—Ç —Ç–æ–∫' },
                    { key: '–î–∏—Å—Å–æ—Ü–∏–∞—Ü–∏—è', value: '–†–∞—Å–ø–∞–¥ –º–æ–ª–µ–∫—É–ª —ç–ª–µ–∫—Ç—Ä–æ–ª–∏—Ç–∞ –Ω–∞ –∏–æ–Ω—ã' },
                    { key: '–ì–∏–¥—Ä–æ–ª–∏–∑', value: '–í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ –∏–æ–Ω–æ–≤ —Å–æ–ª–∏ —Å –≤–æ–¥–æ–π' }
                ];

                const acidBase = [
                    { key: '–ö–∏—Å–ª–æ—Ç–∞', value: '–≠–ª–µ–∫—Ç—Ä–æ–ª–∏—Ç, –¥–∏—Å—Å–æ—Ü–∏–∏—Ä—É—é—â–∏–π —Å –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ–º H+' },
                    { key: '–û—Å–Ω–æ–≤–∞–Ω–∏–µ', value: '–≠–ª–µ–∫—Ç—Ä–æ–ª–∏—Ç, –¥–∏—Å—Å–æ—Ü–∏–∏—Ä—É—é—â–∏–π —Å –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ–º OH-' },
                    { key: '–°–æ–ª—å', value: '–°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –∫–∞—Ç–∏–æ–Ω–∞ –º–µ—Ç–∞–ª–ª–∞ (–∏–ª–∏ NH4+) —Å –∞–Ω–∏–æ–Ω–æ–º –∫–∏—Å–ª–æ—Ç–Ω–æ–≥–æ –æ—Å—Ç–∞—Ç–∫–∞' },
                    { key: 'pH', value: '–ü–æ–∫–∞–∑–∞—Ç–µ–ª—å –∫–∏—Å–ª–æ—Ç–Ω–æ—Å—Ç–∏ —Ä–∞—Å—Ç–≤–æ—Ä–∞' },
                    { key: '–ò–Ω–¥–∏–∫–∞—Ç–æ—Ä', value: '–í–µ—â–µ—Å—Ç–≤–æ, –º–µ–Ω—è—é—â–µ–µ —Ü–≤–µ—Ç –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç pH' },
                    { key: '–ù–µ–π—Ç—Ä–∞–ª–∏–∑–∞—Ü–∏—è', value: '–†–µ–∞–∫—Ü–∏—è –∫–∏—Å–ª–æ—Ç—ã –∏ –æ—Å–Ω–æ–≤–∞–Ω–∏—è —Å –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ–º —Å–æ–ª–∏ –∏ –≤–æ–¥—ã' },
                    { key: '–ê–º—Ñ–æ—Ç–µ—Ä–Ω–æ—Å—Ç—å', value: '–°–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –ø—Ä–æ—è–≤–ª—è—Ç—å –∫–∏—Å–ª–æ—Ç–Ω—ã–µ –∏ –æ—Å–Ω–æ–≤–Ω—ã–µ —Å–≤–æ–π—Å—Ç–≤–∞' },
                    { key: '–ë—É—Ñ–µ—Ä–Ω—ã–π —Ä–∞—Å—Ç–≤–æ—Ä', value: '–†–∞—Å—Ç–≤–æ—Ä, —Å–æ–ø—Ä–æ—Ç–∏–≤–ª—è—é—â–∏–π—Å—è –∏–∑–º–µ–Ω–µ–Ω–∏—é pH –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –∫–∏—Å–ª–æ—Ç—ã/—â–µ–ª–æ—á–∏' }
                ];

                const structure = [
                    { key: '–ö–æ–≤–∞–ª–µ–Ω—Ç–Ω–∞—è —Å–≤—è–∑—å', value: '–°–≤—è–∑—å –∑–∞ —Å—á—ë—Ç –æ–±—â–∏—Ö —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω—ã—Ö –ø–∞—Ä' },
                    { key: '–ò–æ–Ω–Ω–∞—è —Å–≤—è–∑—å', value: '–°–≤—è–∑—å –∑–∞ —Å—á—ë—Ç —ç–ª–µ–∫—Ç—Ä–æ—Å—Ç–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø—Ä–∏—Ç—è–∂–µ–Ω–∏—è –∏–æ–Ω–æ–≤' },
                    { key: '–ú–µ—Ç–∞–ª–ª–∏—á–µ—Å–∫–∞—è —Å–≤—è–∑—å', value: '–°–≤—è–∑—å –º–µ–∂–¥—É –∫–∞—Ç–∏–æ–Ω–∞–º–∏ –º–µ—Ç–∞–ª–ª–∞ –∏ ¬´—ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω—ã–º –≥–∞–∑–æ–º¬ª' },
                    { key: '–í–∞–ª–µ–Ω—Ç–Ω–æ—Å—Ç—å', value: '–ß–∏—Å–ª–æ —Å–≤—è–∑–µ–π, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–∂–µ—Ç –æ–±—Ä–∞–∑–æ–≤—ã–≤–∞—Ç—å –∞—Ç–æ–º' },
                    { key: '–ü–æ–ª—è—Ä–Ω–æ—Å—Ç—å —Å–≤—è–∑–∏', value: '–°–º–µ—â–µ–Ω–∏–µ —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ–π –ø–ª–æ—Ç–Ω–æ—Å—Ç–∏ –∫ –±–æ–ª–µ–µ —ç–ª–µ–∫—Ç—Ä–æ–æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ–º—É –∞—Ç–æ–º—É' },
                    { key: '–≠–ª–µ–∫—Ç—Ä–æ–æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å', value: '–°–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –∞—Ç–æ–º–∞ –ø—Ä–∏—Ç—è–≥–∏–≤–∞—Ç—å —ç–ª–µ–∫—Ç—Ä–æ–Ω—ã –≤ —Å–≤—è–∑–∏' },
                    { key: '–ò–∑–æ–º–µ—Ä–∏—è', value: '–û–¥–∏–Ω–∞–∫–æ–≤—ã–π —Å–æ—Å—Ç–∞–≤, –Ω–æ —Ä–∞–∑–Ω–æ–µ —Å—Ç—Ä–æ–µ–Ω–∏–µ –∏ —Å–≤–æ–π—Å—Ç–≤–∞' }
                ];

                const electrochem = [
                    { key: '–≠–ª–µ–∫—Ç—Ä–æ–¥', value: '–ü—Ä–æ–≤–æ–¥–Ω–∏–∫, –ø–æ–≥—Ä—É–∂—ë–Ω–Ω—ã–π –≤ —ç–ª–µ–∫—Ç—Ä–æ–ª–∏—Ç' },
                    { key: '–≠–ª–µ–∫—Ç—Ä–æ–ª–∏–∑', value: '–•–∏–º–∏—á–µ—Å–∫–∏–µ –ø—Ä–µ–≤—Ä–∞—â–µ–Ω–∏—è –Ω–∞ —ç–ª–µ–∫—Ç—Ä–æ–¥–∞—Ö –ø—Ä–∏ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏–∏ —Ç–æ–∫–∞' },
                    { key: '–ì–∞–ª—å–≤–∞–Ω–∏—á–µ—Å–∫–∏–π —ç–ª–µ–º–µ–Ω—Ç', value: '–ò—Å—Ç–æ—á–Ω–∏–∫ —Ç–æ–∫–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –û–í–†, –ø—Ä–æ—Ç–µ–∫–∞—é—â–µ–π —Å–∞–º–æ–ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ' },
                    { key: '–ö–∞—Ç–æ–¥', value: '–≠–ª–µ–∫—Ç—Ä–æ–¥, –Ω–∞ –∫–æ—Ç–æ—Ä–æ–º –∏–¥—ë—Ç –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ' },
                    { key: '–ê–Ω–æ–¥', value: '–≠–ª–µ–∫—Ç—Ä–æ–¥, –Ω–∞ –∫–æ—Ç–æ—Ä–æ–º –∏–¥—ë—Ç –æ–∫–∏—Å–ª–µ–Ω–∏–µ' }
                ];

                const organic = [
                    { key: '–ê–ª–∫–∞–Ω—ã', value: '–ù–∞—Å—ã—â–µ–Ω–Ω—ã–µ —É–≥–ª–µ–≤–æ–¥–æ—Ä–æ–¥—ã —Å –æ–¥–∏–Ω–∞—Ä–Ω—ã–º–∏ —Å–≤—è–∑—è–º–∏ C‚ÄìC' },
                    { key: '–ê–ª–∫–µ–Ω—ã', value: '–£–≥–ª–µ–≤–æ–¥–æ—Ä–æ–¥—ã —Å –¥–≤–æ–π–Ω–æ–π —Å–≤—è–∑—å—é C=C' },
                    { key: '–ê–ª–∫–∏–Ω—ã', value: '–£–≥–ª–µ–≤–æ–¥–æ—Ä–æ–¥—ã —Å —Ç—Ä–æ–π–Ω–æ–π —Å–≤—è–∑—å—é C‚â°C' },
                    { key: '–ê—Ä–µ–Ω—ã', value: '–ê—Ä–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —É–≥–ª–µ–≤–æ–¥–æ—Ä–æ–¥—ã —Å –±–µ–Ω–∑–æ–ª—å–Ω—ã–º –∫–æ–ª—å—Ü–æ–º' },
                    { key: '–°–ø–∏—Ä—Ç—ã', value: '–û—Ä–≥–∞–Ω–∏—á–µ—Å–∫–∏–µ –≤–µ—â–µ—Å—Ç–≤–∞ —Å –≥—Ä—É–ø–ø–æ–π ‚ÄìOH' },
                    { key: '–§–µ–Ω–æ–ª—ã', value: '–°–æ–µ–¥–∏–Ω–µ–Ω–∏—è, –≥–¥–µ ‚ÄìOH —Å–≤—è–∑–∞–Ω —Å –∞—Ä–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –∫–æ–ª—å—Ü–æ–º' },
                    { key: '–ê–ª—å–¥–µ–≥–∏–¥—ã', value: '–°–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å –≥—Ä—É–ø–ø–æ–π ‚ÄìCHO' },
                    { key: '–ö–µ—Ç–æ–Ω—ã', value: '–°–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å –∫–∞—Ä–±–æ–Ω–∏–ª—å–Ω–æ–π –≥—Ä—É–ø–ø–æ–π >C=O' },
                    { key: '–ö–∞—Ä–±–æ–Ω–æ–≤—ã–µ –∫–∏—Å–ª–æ—Ç—ã', value: '–°–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å –≥—Ä—É–ø–ø–æ–π ‚ÄìCOOH' },
                    { key: '–°–ª–æ–∂–Ω—ã–µ —ç—Ñ–∏—Ä—ã', value: '–ü—Ä–æ–∏–∑–≤–æ–¥–Ω—ã–µ –∫–∏—Å–ª–æ—Ç –∏ —Å–ø–∏—Ä—Ç–æ–≤: R‚ÄìCOO‚ÄìR' },
                    { key: '–ê–º–∏–Ω—ã', value: '–ü—Ä–æ–∏–∑–≤–æ–¥–Ω—ã–µ –∞–º–º–∏–∞–∫–∞ —Å –≥—Ä—É–ø–ø–æ–π ‚ÄìNH2/‚ÄìNHR/‚ÄìNR2' },
                    { key: '–ì–∞–ª–æ–≥–µ–Ω–∞–ª–∫–∞–Ω—ã', value: '–ü—Ä–æ–∏–∑–≤–æ–¥–Ω—ã–µ –∞–ª–∫–∞–Ω–æ–≤, –≥–¥–µ H –∑–∞–º–µ—â—ë–Ω –Ω–∞ –≥–∞–ª–æ–≥–µ–Ω' },
                    { key: '–ü–æ–ª–∏–º–µ—Ä—ã', value: '–í—ã—Å–æ–∫–æ–º–æ–ª–µ–∫—É–ª—è—Ä–Ω—ã–µ –≤–µ—â–µ—Å—Ç–≤–∞ –∏–∑ –ø–æ–≤—Ç–æ—Ä—è—é—â–∏—Ö—Å—è –∑–≤–µ–Ω—å–µ–≤' },
                    { key: '–ú–æ–Ω–æ–º–µ—Ä', value: '–ù–∏–∑–∫–æ–º–æ–ª–µ–∫—É–ª—è—Ä–Ω–æ–µ –≤–µ—â–µ—Å—Ç–≤–æ ‚Äî ¬´—Å—Ç—Ä–æ–∏—Ç–µ–ª—å–Ω—ã–π –±–ª–æ–∫¬ª –ø–æ–ª–∏–º–µ—Ä–∞' },
                    { key: '–ü–æ–ª–∏–º–µ—Ä–∏–∑–∞—Ü–∏—è', value: '–†–µ–∞–∫—Ü–∏—è –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –ø–æ–ª–∏–º–µ—Ä–∞ –∏–∑ –º–æ–Ω–æ–º–µ—Ä–æ–≤' },
                    { key: '–≠—Å—Ç–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è', value: '–û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ —Å–ª–æ–∂–Ω–æ–≥–æ —ç—Ñ–∏—Ä–∞ –∏–∑ –∫–∏—Å–ª–æ—Ç—ã –∏ —Å–ø–∏—Ä—Ç–∞' },
                    { key: '–ì–∏–¥—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ', value: '–ü—Ä–∏—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –≤–æ–¥–æ—Ä–æ–¥–∞ –ø–æ –∫—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏' }
                ];

                const reactions = [
                    { key: '–ó–∞–º–µ—â–µ–Ω–∏–µ', value: '–û–¥–∏–Ω —ç–ª–µ–º–µ–Ω—Ç –∑–∞–º–µ—â–∞–µ—Ç –¥—Ä—É–≥–æ–π –≤ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–∏' },
                    { key: '–°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ', value: '–ò–∑ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –≤–µ—â–µ—Å—Ç–≤ –æ–±—Ä–∞–∑—É–µ—Ç—Å—è –æ–¥–Ω–æ' },
                    { key: '–†–∞–∑–ª–æ–∂–µ–Ω–∏–µ', value: '–ò–∑ –æ–¥–Ω–æ–≥–æ –≤–µ—â–µ—Å—Ç–≤–∞ –æ–±—Ä–∞–∑—É–µ—Ç—Å—è –Ω–µ—Å–∫–æ–ª—å–∫–æ' },
                    { key: '–û–±–º–µ–Ω', value: '–û–±–º–µ–Ω –∏–æ–Ω–∞–º–∏/—á–∞—Å—Ç—è–º–∏ –º–µ–∂–¥—É –¥–≤—É–º—è –≤–µ—â–µ—Å—Ç–≤–∞–º–∏' },
                    { key: '–ù–µ–π—Ç—Ä–∞–ª–∏–∑–∞—Ü–∏—è', value: '–†–µ–∞–∫—Ü–∏—è –∫–∏—Å–ª–æ—Ç—ã –∏ –æ—Å–Ω–æ–≤–∞–Ω–∏—è —Å –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ–º —Å–æ–ª–∏ –∏ –≤–æ–¥—ã' }
                ];

                addTwoWayDefinitions({ suffix: 'core', pairs: core, topic: '–û–±—â–∞—è —Ö–∏–º–∏—è', difficulty: 4, seedBase: 2101 });
                addTwoWayDefinitions({ suffix: 'org', pairs: organic, topic: '–û—Ä–≥–∞–Ω–∏—á–µ—Å–∫–∞—è —Ö–∏–º–∏—è', difficulty: 4, seedBase: 2201 });
                addTwoWayDefinitions({ suffix: 'rxn', pairs: reactions, topic: '–¢–∏–ø—ã —Ä–µ–∞–∫—Ü–∏–π', difficulty: 4, seedBase: 2301 });
                addTwoWayDefinitions({ suffix: 'sol', pairs: solutions, topic: '–†–∞—Å—Ç–≤–æ—Ä—ã', difficulty: 4, seedBase: 2401 });
                addTwoWayDefinitions({ suffix: 'ab', pairs: acidBase, topic: '–ö–∏—Å–ª–æ—Ç—ã –∏ –æ—Å–Ω–æ–≤–∞–Ω–∏—è', difficulty: 4, seedBase: 2501 });
                addTwoWayDefinitions({ suffix: 'str', pairs: structure, topic: '–°—Ç—Ä–æ–µ–Ω–∏–µ –≤–µ—â–µ—Å—Ç–≤–∞', difficulty: 4, seedBase: 2601 });
                addTwoWayDefinitions({ suffix: 'el', pairs: electrochem, topic: '–≠–ª–µ–∫—Ç—Ä–æ—Ö–∏–º–∏—è', difficulty: 4, seedBase: 2701 });
            }

            if (!isSenior) {

            // 1) –°–æ—Å—Ç–æ—è–Ω–∏—è –≤–µ—â–µ—Å—Ç–≤–∞
            const stateExamples = [
                { key: '–¢–≤—ë—Ä–¥–æ–µ', value: '–õ—ë–¥' },
                { key: '–¢–≤—ë—Ä–¥–æ–µ', value: '–ö–∞–º–µ–Ω—å' },
                { key: '–¢–≤—ë—Ä–¥–æ–µ', value: '–ñ–µ–ª–µ–∑–æ' },
                { key: '–ñ–∏–¥–∫–æ—Å—Ç—å', value: '–í–æ–¥–∞' },
                { key: '–ñ–∏–¥–∫–æ—Å—Ç—å', value: '–ú–æ–ª–æ–∫–æ' },
                { key: '–ñ–∏–¥–∫–æ—Å—Ç—å', value: '–ú–∞—Å–ª–æ' },
                { key: '–ì–∞–∑', value: '–í–æ–∑–¥—É—Ö' },
                { key: '–ì–∞–∑', value: '–ö–∏—Å–ª–æ—Ä–æ–¥' },
                { key: '–ì–∞–∑', value: '–£–≥–ª–µ–∫–∏—Å–ª—ã–π –≥–∞–∑' }
            ];

            // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –≤–æ–ø—Ä–æ—Å—ã ¬´—á—Ç–æ —ç—Ç–æ –∑–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–µ?¬ª
            stateExamples.forEach((ex, idx) => {
                const seed = (bandStartGrade * 1000) + idx * 31;
                const states = ['–¢–≤—ë—Ä–¥–æ–µ', '–ñ–∏–¥–∫–æ—Å—Ç—å', '–ì–∞–∑'];
                const distract = pickDistractors(states, ex.key, 3, seed);
                const optionStates = shuffleWithSeed([ex.key, ...distract], seed + 9);
                out.push(
                    makeMcq({
                        id: stableId(prefix, out.length + 1),
                        topic: '–°–æ—Å—Ç–æ—è–Ω–∏—è –≤–µ—â–µ—Å—Ç–≤–∞',
                        difficulty: Math.max(1, diff - 1),
                        question: `–ö–∞–∫–æ–µ –∞–≥—Ä–µ–≥–∞—Ç–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –æ–±—ã—á–Ω–æ –∏–º–µ–µ—Ç ¬´${ex.value}¬ª –ø—Ä–∏ –∫–æ–º–Ω–∞—Ç–Ω–æ–π —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–µ?`,
                        options: optionStates,
                        correct: optionStates.indexOf(ex.key),
                        explanation: `–ü—Ä–∏–º–µ—Ä: ¬´${ex.value}¬ª –æ—Ç–Ω–æ—Å—è—Ç –∫ —Å–æ—Å—Ç–æ—è–Ω–∏—é ¬´${ex.key}¬ª –≤ –æ–±—ã—á–Ω—ã—Ö —É—Å–ª–æ–≤–∏—è—Ö.`
                    })
                );
            });

            // 2) –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ —Å–º–µ—Å–µ–π (–±–µ–∑–æ–ø–∞—Å–Ω—ã–µ —à–∫–æ–ª—å–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã)
            const mixToMethod = [
                { key: '–ü–µ—Å–æ–∫ + –≤–æ–¥–∞', value: '–§–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–∏–µ' },
                { key: '–°–æ–ª—å + –≤–æ–¥–∞', value: '–í—ã–ø–∞—Ä–∏–≤–∞–Ω–∏–µ' },
                { key: '–°–∞—Ö–∞—Ä + –≤–æ–¥–∞', value: '–í—ã–ø–∞—Ä–∏–≤–∞–Ω–∏–µ' },
                { key: '–ö–∞–º–µ—à–∫–∏ + –ø–µ—Å–æ–∫', value: '–ü—Ä–æ—Å–µ–∏–≤–∞–Ω–∏–µ' },
                { key: '–û–ø–∏–ª–∫–∏ + –≤–æ–¥–∞', value: '–û—Ç—Å—Ç–∞–∏–≤–∞–Ω–∏–µ' },
                { key: '–ñ–µ–ª–µ–∑–Ω—ã–µ –æ–ø–∏–ª–∫–∏ + –ø–µ—Å–æ–∫', value: '–ú–∞–≥–Ω–∏—Ç' },
                { key: '–ú–∞—Å–ª–æ + –≤–æ–¥–∞', value: '–û—Ç—Å—Ç–∞–∏–≤–∞–Ω–∏–µ' },
                { key: '–ß–∞–π–Ω—ã–µ –ª–∏—Å—Ç—å—è + –≤–æ–¥–∞', value: '–§–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–∏–µ' },
                { key: '–†–∏—Å + –≤–æ–¥–∞', value: '–ü—Ä–æ—Ü–µ–∂–∏–≤–∞–Ω–∏–µ/—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–∏–µ' },
                { key: '–ì–ª–∏–Ω–∞ + –≤–æ–¥–∞', value: '–û—Ç—Å—Ç–∞–∏–≤–∞–Ω–∏–µ' }
            ];

            // –í–æ–ø—Ä–æ—Å—ã ¬´–∫–∞–∫–∏–º —Å–ø–æ—Å–æ–±–æ–º —Ä–∞–∑–¥–µ–ª–∏—Ç—å?¬ª
            const methods = Array.from(new Set(mixToMethod.map(m => m.value)));
            mixToMethod.forEach((m, idx) => {
                const seed = 777 + idx * 97 + bandStartGrade * 3;
                const distract = pickDistractors(methods, m.value, 3, seed);
                const options = shuffleWithSeed([m.value, ...distract], seed + 5);
                out.push(
                    makeMcq({
                        id: stableId(prefix, out.length + 1),
                        topic: '–°–º–µ—Å–∏',
                        difficulty: diff,
                        question: `–ö–∞–∫ –ª—É—á—à–µ —Ä–∞–∑–¥–µ–ª–∏—Ç—å —Å–º–µ—Å—å: ${m.key}?`,
                        options,
                        correct: options.indexOf(m.value),
                        explanation: `–ü–æ–¥—Ö–æ–¥–∏—Ç —Å–ø–æ—Å–æ–±: ${m.value}.`
                    })
                );
            });

            // 3) –ë–∞–∑–æ–≤—ã–µ —Ç–µ—Ä–º–∏–Ω—ã (–¥–ª—è 7+)
            if (band !== '1-4') {
                const termToDef = [
                    { key: '–ê—Ç–æ–º', value: '–ù–∞–∏–º–µ–Ω—å—à–∞—è —á–∞—Å—Ç–∏—Ü–∞ —Ö–∏–º–∏—á–µ—Å–∫–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞' },
                    { key: '–ú–æ–ª–µ–∫—É–ª–∞', value: '–ß–∞—Å—Ç–∏—Ü–∞ –≤–µ—â–µ—Å—Ç–≤–∞, —Å–æ—Ö—Ä–∞–Ω—è—é—â–∞—è –µ–≥–æ —Ö–∏–º–∏—á–µ—Å–∫–∏–µ —Å–≤–æ–π—Å—Ç–≤–∞' },
                    { key: '–≠–ª–µ–º–µ–Ω—Ç', value: '–í–∏–¥ –∞—Ç–æ–º–æ–≤ —Å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º –∑–∞—Ä—è–¥–æ–º —è–¥—Ä–∞' },
                    { key: '–°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ', value: '–í–µ—â–µ—Å—Ç–≤–æ –∏–∑ –∞—Ç–æ–º–æ–≤ —Ä–∞–∑–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤' },
                    { key: '–†–µ–∞–∫—Ü–∏—è', value: '–ü—Ä–æ—Ü–µ—Å—Å –ø—Ä–µ–≤—Ä–∞—â–µ–Ω–∏—è –æ–¥–Ω–∏—Ö –≤–µ—â–µ—Å—Ç–≤ –≤ –¥—Ä—É–≥–∏–µ' },
                    { key: '–ö–∞—Ç–∞–ª–∏–∑–∞—Ç–æ—Ä', value: '–í–µ—â–µ—Å—Ç–≤–æ, —É—Å–∫–æ—Ä—è—é—â–µ–µ —Ä–µ–∞–∫—Ü–∏—é –∏ –Ω–µ —Ä–∞—Å—Ö–æ–¥—É—é—â–µ–µ—Å—è' },
                    { key: '–†–∞—Å—Ç–≤–æ—Ä', value: '–û–¥–Ω–æ—Ä–æ–¥–Ω–∞—è —Å–º–µ—Å—å —Ä–∞—Å—Ç–≤–æ—Ä–∏—Ç–µ–ª—è –∏ —Ä–∞—Å—Ç–≤–æ—Ä—ë–Ω–Ω–æ–≥–æ –≤–µ—â–µ—Å—Ç–≤–∞' },
                    { key: '–ò–Ω–¥–∏–∫–∞—Ç–æ—Ä', value: '–í–µ—â–µ—Å—Ç–≤–æ, –º–µ–Ω—è—é—â–µ–µ —Ü–≤–µ—Ç –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Å—Ä–µ–¥—ã' },
                    { key: '–û–∫—Å–∏–¥', value: '–°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–∞ —Å –∫–∏—Å–ª–æ—Ä–æ–¥–æ–º' },
                    { key: 'pH', value: '–ú–µ—Ä–∞ –∫–∏—Å–ª–æ—Ç–Ω–æ—Å—Ç–∏/—â–µ–ª–æ—á–Ω–æ—Å—Ç–∏ —Ä–∞—Å—Ç–≤–æ—Ä–∞' },
                    { key: '–û–∫–∏—Å–ª–µ–Ω–∏–µ', value: '–ü—Ä–æ—Ü–µ—Å—Å –æ—Ç–¥–∞—á–∏ —ç–ª–µ–∫—Ç—Ä–æ–Ω–æ–≤ (–≤ –û–í–†)' },
                    { key: '–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ', value: '–ü—Ä–æ—Ü–µ—Å—Å –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —ç–ª–µ–∫—Ç—Ä–æ–Ω–æ–≤ (–≤ –û–í–†)' }
                ];
                out.push(
                    ...buildMcqFromPairs({
                        prefix: `${prefix}_terms`,
                        pairs: termToDef,
                        topic: '–û—Å–Ω–æ–≤—ã —Ö–∏–º–∏–∏',
                        difficulty: diff,
                        seedBase: 101,
                        questionText: (p) => `–í—ã–±–µ—Ä–∏—Ç–µ –≤–µ—Ä–Ω–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–µ—Ä–º–∏–Ω–∞: ¬´${p.key}¬ª.`,
                        optionsFromKeys: (keys, byKey) => keys.map(k => byKey[k]),
                        correctIndexFn: (keys, correctKey) => keys.indexOf(correctKey),
                        explanationFn: (p) => `–ü—Ä–∞–≤–∏–ª—å–Ω–æ: ${p.value}.`
                    })
                );
            }

            // 3b) –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
            const safetyRuleToWhy = [
                { key: '–ß–∏—Ç–∞—Ç—å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é –Ω–∞ —É–ø–∞–∫–æ–≤–∫–µ', value: '–ß—Ç–æ–±—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—Ä–µ–¥—Å—Ç–≤–æ –∏ –Ω–µ –Ω–∞–≤—Ä–µ–¥–∏—Ç—å' },
                { key: '–†–∞–±–æ—Ç–∞—Ç—å –≤ –ø–µ—Ä—á–∞—Ç–∫–∞—Ö (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)', value: '–ß—Ç–æ–±—ã –∑–∞—â–∏—Ç–∏—Ç—å –∫–æ–∂—É' },
                { key: '–ù–µ –ø—Ä–æ–±–æ–≤–∞—Ç—å –≤–µ—â–µ—Å—Ç–≤–∞ –Ω–∞ –≤–∫—É—Å', value: '–≠—Ç–æ –æ–ø–∞—Å–Ω–æ –∏ –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –æ—Ç—Ä–∞–≤–ª–µ–Ω–∏—é' },
                { key: '–ù–µ —Å–º–µ—à–∏–≤–∞—Ç—å —Å—Ä–µ–¥—Å—Ç–≤–∞ –±–µ–∑ —É–∫–∞–∑–∞–Ω–∏–π', value: '–ú–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å –æ–ø–∞—Å–Ω—ã–µ –ø–∞—Ä—ã –∏–ª–∏ —Ä–µ–∞–∫—Ü–∏—é' },
                { key: '–ü—Ä–æ–≤–µ—Ç—Ä–∏–≤–∞—Ç—å –ø–æ–º–µ—â–µ–Ω–∏–µ', value: '–ß—Ç–æ–±—ã –Ω–µ –≤–¥—ã—Ö–∞—Ç—å –ø–∞—Ä—ã' },
                { key: '–î–µ—Ä–∂–∞—Ç—å –±—ã—Ç–æ–≤—É—é —Ö–∏–º–∏—é –≤–¥–∞–ª–∏ –æ—Ç –¥–µ—Ç–µ–π', value: '–ß—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –Ω–µ—Å—á–∞—Å—Ç–Ω—ã—Ö —Å–ª—É—á–∞–µ–≤' },
                { key: '–ú—ã—Ç—å —Ä—É–∫–∏ –ø–æ—Å–ª–µ —Ä–∞–±–æ—Ç—ã', value: '–ß—Ç–æ–±—ã —É–¥–∞–ª–∏—Ç—å –æ—Å—Ç–∞—Ç–∫–∏ –≤–µ—â–µ—Å—Ç–≤' },
                { key: '–ù–µ –Ω–∞–≥—Ä–µ–≤–∞—Ç—å –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–µ —Å–º–µ—Å–∏', value: '–ù–∞–≥—Ä–µ–≤ –º–æ–∂–µ—Ç —É—Å–∏–ª–∏—Ç—å —Ä–µ–∞–∫—Ü–∏—é –∏ –æ–ø–∞—Å–Ω–æ—Å—Ç—å' },
                { key: '–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ—á–∫–∏ –≤ –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–∏–∏', value: '–ß—Ç–æ–±—ã –∑–∞—â–∏—Ç–∏—Ç—å –≥–ª–∞–∑–∞' },
                { key: '–ù–µ –Ω—é—Ö–∞—Ç—å –≤–µ—â–µ—Å—Ç–≤–∞ –Ω–∞–ø—Ä—è–º—É—é', value: '–ù–µ–∫–æ—Ç–æ—Ä—ã–µ –ø–∞—Ä—ã —Ä–∞–∑–¥—Ä–∞–∂–∞—é—Ç –¥—ã—Ö–∞—Ç–µ–ª—å–Ω—ã–µ –ø—É—Ç–∏' },
                { key: '–ü–æ–¥–ø–∏—Å—ã–≤–∞—Ç—å —ë–º–∫–æ—Å—Ç–∏', value: '–ß—Ç–æ–±—ã –Ω–µ –ø–µ—Ä–µ–ø—É—Ç–∞—Ç—å –≤–µ—â–µ—Å—Ç–≤–∞' },
                { key: '–°–æ–±–ª—é–¥–∞—Ç—å –ø–æ—Ä—è–¥–æ–∫ –Ω–∞ —Å—Ç–æ–ª–µ', value: '–ß—Ç–æ–±—ã —Å–Ω–∏–∑–∏—Ç—å —Ä–∏—Å–∫ –ø—Ä–æ–ª–∏–≤–æ–≤ –∏ –æ—à–∏–±–æ–∫' }
            ];
            out.push(
                ...buildMcqFromPairs({
                    prefix: `${prefix}_safety`,
                    pairs: safetyRuleToWhy,
                    topic: '–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å',
                    difficulty: Math.max(1, diff - 1),
                    seedBase: 303,
                    questionText: (p) => `–ó–∞—á–µ–º –≤–∞–∂–Ω–æ –ø—Ä–∞–≤–∏–ª–æ: ¬´${p.key}¬ª?`,
                    optionsFromKeys: (keys, byKey) => keys.map(k => byKey[k]),
                    correctIndexFn: (keys, correctKey) => keys.indexOf(correctKey),
                    explanationFn: (p) => `${p.key}: ${p.value}.`
                })
            );

            // 3c) –§–∏–∑–∏—á–µ—Å–∫–∏–µ —è–≤–ª–µ–Ω–∏—è/–∏–∑–º–µ–Ω–µ–Ω–∏—è
            const processToResult = [
                { key: '–ü–ª–∞–≤–ª–µ–Ω–∏–µ', value: '–ü–µ—Ä–µ—Ö–æ–¥ –∏–∑ —Ç–≤—ë—Ä–¥–æ–≥–æ –≤ –∂–∏–¥–∫–æ–µ' },
                { key: '–ó–∞–º–µ—Ä–∑–∞–Ω–∏–µ', value: '–ü–µ—Ä–µ—Ö–æ–¥ –∏–∑ –∂–∏–¥–∫–æ–≥–æ –≤ —Ç–≤—ë—Ä–¥–æ–µ' },
                { key: '–ò—Å–ø–∞—Ä–µ–Ω–∏–µ', value: '–ü–µ—Ä–µ—Ö–æ–¥ –∏–∑ –∂–∏–¥–∫–æ–≥–æ –≤ –≥–∞–∑–æ–æ–±—Ä–∞–∑–Ω–æ–µ' },
                { key: '–ö–æ–Ω–¥–µ–Ω—Å–∞—Ü–∏—è', value: '–ü–µ—Ä–µ—Ö–æ–¥ –∏–∑ –≥–∞–∑–æ–æ–±—Ä–∞–∑–Ω–æ–≥–æ –≤ –∂–∏–¥–∫–æ–µ' },
                { key: '–ö–∏–ø–µ–Ω–∏–µ', value: '–ë—ã—Å—Ç—Ä–æ–µ –∏—Å–ø–∞—Ä–µ–Ω–∏–µ –ø–æ –≤—Å–µ–º—É –æ–±—ä—ë–º—É –∂–∏–¥–∫–æ—Å—Ç–∏' },
                { key: '–†–∞—Å—Ç–≤–æ—Ä–µ–Ω–∏–µ', value: '–†–∞–≤–Ω–æ–º–µ—Ä–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≤–µ—â–µ—Å—Ç–≤–∞ –≤ —Ä–∞—Å—Ç–≤–æ—Ä–∏—Ç–µ–ª–µ' },
                { key: '–ö—Ä–∏—Å—Ç–∞–ª–ª–∏–∑–∞—Ü–∏—è', value: '–û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –∫—Ä–∏—Å—Ç–∞–ª–ª–æ–≤ –∏–∑ —Ä–∞—Å—Ç–≤–æ—Ä–∞/—Ä–∞—Å–ø–ª–∞–≤–∞' },
                { key: '–°—É–±–ª–∏–º–∞—Ü–∏—è', value: '–ü–µ—Ä–µ—Ö–æ–¥ –∏–∑ —Ç–≤—ë—Ä–¥–æ–≥–æ —Å—Ä–∞–∑—É –≤ –≥–∞–∑–æ–æ–±—Ä–∞–∑–Ω–æ–µ' },
                { key: '–î–µ—Å—É–±–ª–∏–º–∞—Ü–∏—è', value: '–ü–µ—Ä–µ—Ö–æ–¥ –∏–∑ –≥–∞–∑–∞ —Å—Ä–∞–∑—É –≤ —Ç–≤—ë—Ä–¥–æ–µ' },
                { key: '–î–∏—Ñ—Ñ—É–∑–∏—è', value: '–°–∞–º–æ–ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–µ –ø–µ—Ä–µ–º–µ—à–∏–≤–∞–Ω–∏–µ —á–∞—Å—Ç–∏—Ü' }
            ];
            out.push(
                ...buildMcqFromPairs({
                    prefix: `${prefix}_processes`,
                    pairs: processToResult,
                    topic: '–§–∏–∑–∏—á–µ—Å–∫–∏–µ —è–≤–ª–µ–Ω–∏—è',
                    difficulty: Math.max(1, diff - 1),
                    seedBase: 505,
                    questionText: (p) => `–ß—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å: ¬´${p.key}¬ª?`,
                    optionsFromKeys: (keys, byKey) => keys.map(k => byKey[k]),
                    correctIndexFn: (keys, correctKey) => keys.indexOf(correctKey),
                    explanationFn: (p) => `${p.key}: ${p.value}.`
                })
            );

            // 3d) –î–æ–±–æ—Ä –ø—Ä–æ—Å—Ç—ã—Ö –≤–æ–ø—Ä–æ—Å–æ–≤ –¥–ª—è 1‚Äì4 –∫–ª–∞—Å—Å–æ–≤
            if (band === '1-4') {
                const solubility = [
                    { name: '–°–æ–ª—å', soluble: true },
                    { name: '–°–∞—Ö–∞—Ä', soluble: true },
                    { name: '–°–æ–¥–∞ (–ø–∏—â–µ–≤–∞—è)', soluble: true },
                    { name: '–ü–µ—Å–æ–∫', soluble: false },
                    { name: '–ì–ª–∏–Ω–∞', soluble: false },
                    { name: '–ú–µ–ª', soluble: false },
                    { name: '–ú–∞—Å–ª–æ', soluble: false },
                    { name: '–ú—ë–¥', soluble: true },
                    { name: '–ö–∞–∫–∞–æ-–ø–æ—Ä–æ—à–æ–∫', soluble: false },
                    { name: '–ú—É–∫–∞', soluble: false },
                    { name: '–õ–∏–º–æ–Ω–Ω—ã–π —Å–æ–∫', soluble: true },
                    { name: '–£–∫—Å—É—Å', soluble: true },
                    { name: '–ö–æ—Ñ–µ —Ä–∞—Å—Ç–≤–æ—Ä–∏–º—ã–π', soluble: true },
                    { name: '–†–∏—Å', soluble: false },
                    { name: '–û–ø–∏–ª–∫–∏', soluble: false },
                    { name: '–°–∏—Ä–æ–ø', soluble: true }
                ];
                solubility.forEach((x, idx) => {
                    const options = ['–î–∞', '–ù–µ—Ç', '–ó–∞–≤–∏—Å–∏—Ç –æ—Ç —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã', '–ù–µ –∑–Ω–∞—é'];
                    const correct = x.soluble ? 0 : 1;
                    out.push(
                        makeMcq({
                            id: stableId(`${prefix}_solubility`, idx + 1),
                            topic: '–†–∞—Å—Ç–≤–æ—Ä–∏–º–æ—Å—Ç—å',
                            difficulty: 1,
                            question: `–†–∞—Å—Ç–≤–æ—Ä–∏—Ç—Å—è –ª–∏ ¬´${x.name}¬ª –≤ –≤–æ–¥–µ –ø—Ä–∏ –ø–µ—Ä–µ–º–µ—à–∏–≤–∞–Ω–∏–∏?`,
                            options,
                            correct,
                            explanation: x.soluble ? '–≠—Ç–æ –≤–µ—â–µ—Å—Ç–≤–æ –æ–±—ã—á–Ω–æ —Ä–∞—Å—Ç–≤–æ—Ä—è–µ—Ç—Å—è –≤ –≤–æ–¥–µ.' : '–≠—Ç–æ –≤–µ—â–µ—Å—Ç–≤–æ –æ–±—ã—á–Ω–æ –Ω–µ —Ä–∞—Å—Ç–≤–æ—Ä—è–µ—Ç—Å—è –≤ –≤–æ–¥–µ.'
                        })
                    );
                });

                const materials = [
                    { name: '–ñ–µ–ª–µ–∑–æ', prop: '–ü—Ä–∏—Ç—è–≥–∏–≤–∞–µ—Ç—Å—è –º–∞–≥–Ω–∏—Ç–æ–º' },
                    { name: '–°—Ç–∞–ª—å', prop: '–ü—Ä–∏—Ç—è–≥–∏–≤–∞–µ—Ç—Å—è –º–∞–≥–Ω–∏—Ç–æ–º' },
                    { name: '–ú–µ–¥—å', prop: '–ü—Ä–æ–≤–æ–¥–∏—Ç —ç–ª–µ–∫—Ç—Ä–∏—á–µ—Å—Ç–≤–æ' },
                    { name: '–ê–ª—é–º–∏–Ω–∏–π', prop: '–ü—Ä–æ–≤–æ–¥–∏—Ç —ç–ª–µ–∫—Ç—Ä–∏—á–µ—Å—Ç–≤–æ' },
                    { name: '–î–µ—Ä–µ–≤–æ', prop: '–ü–ª–æ—Ö–æ –ø—Ä–æ–≤–æ–¥–∏—Ç —ç–ª–µ–∫—Ç—Ä–∏—á–µ—Å—Ç–≤–æ' },
                    { name: '–ü–ª–∞—Å—Ç–∏–∫', prop: '–ü–ª–æ—Ö–æ –ø—Ä–æ–≤–æ–¥–∏—Ç —ç–ª–µ–∫—Ç—Ä–∏—á–µ—Å—Ç–≤–æ' },
                    { name: '–°—Ç–µ–∫–ª–æ', prop: '–•—Ä—É–ø–∫–æ–µ (–ª–µ–≥–∫–æ —Ä–∞–∑–±–∏—Ç—å)' },
                    { name: '–†–µ–∑–∏–Ω–∞', prop: '–≠–ª–∞—Å—Ç–∏—á–Ω–∞—è (—Ç—è–Ω–µ—Ç—Å—è)' },
                    { name: '–ë—É–º–∞–≥–∞', prop: '–õ–µ–≥–∫–æ –Ω–∞–º–æ–∫–∞–µ—Ç' },
                    { name: '–ö–∞–º–µ–Ω—å', prop: '–¢–≤—ë—Ä–¥—ã–π –º–∞—Ç–µ—Ä–∏–∞–ª' },
                    { name: '–õ—ë–¥', prop: '–¢–∞—ë—Ç –ø—Ä–∏ –Ω–∞–≥—Ä–µ–≤–∞–Ω–∏–∏' },
                    { name: '–í–æ–¥–∞', prop: '–ú–æ–∂–µ—Ç –∏—Å–ø–∞—Ä—è—Ç—å—Å—è –ø—Ä–∏ –Ω–∞–≥—Ä–µ–≤–∞–Ω–∏–∏' }
                ];
                const props = ['–ü—Ä–∏—Ç—è–≥–∏–≤–∞–µ—Ç—Å—è –º–∞–≥–Ω–∏—Ç–æ–º', '–ü—Ä–æ–≤–æ–¥–∏—Ç —ç–ª–µ–∫—Ç—Ä–∏—á–µ—Å—Ç–≤–æ', '–ü–ª–æ—Ö–æ –ø—Ä–æ–≤–æ–¥–∏—Ç —ç–ª–µ–∫—Ç—Ä–∏—á–µ—Å—Ç–≤–æ', '–•—Ä—É–ø–∫–æ–µ (–ª–µ–≥–∫–æ —Ä–∞–∑–±–∏—Ç—å)', '–≠–ª–∞—Å—Ç–∏—á–Ω–∞—è (—Ç—è–Ω–µ—Ç—Å—è)', '–õ–µ–≥–∫–æ –Ω–∞–º–æ–∫–∞–µ—Ç', '–¢–≤—ë—Ä–¥—ã–π –º–∞—Ç–µ—Ä–∏–∞–ª', '–¢–∞—ë—Ç –ø—Ä–∏ –Ω–∞–≥—Ä–µ–≤–∞–Ω–∏–∏', '–ú–æ–∂–µ—Ç –∏—Å–ø–∞—Ä—è—Ç—å—Å—è –ø—Ä–∏ –Ω–∞–≥—Ä–µ–≤–∞–Ω–∏–∏'];
                materials.forEach((m, idx) => {
                    const seed = 4004 + idx * 19;
                    const distract = pickDistractors(props, m.prop, 3, seed);
                    const options = shuffleWithSeed([m.prop, ...distract], seed + 4);
                    out.push(
                        makeMcq({
                            id: stableId(`${prefix}_props`, idx + 1),
                            topic: '–°–≤–æ–π—Å—Ç–≤–∞ –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤',
                            difficulty: 1,
                            question: `–ö–∞–∫–æ–µ —Å–≤–æ–π—Å—Ç–≤–æ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –º–∞—Ç–µ—Ä–∏–∞–ª–∞ ¬´${m.name}¬ª?`,
                            options,
                            correct: options.indexOf(m.prop),
                            explanation: `–î–ª—è –º–∞—Ç–µ—Ä–∏–∞–ª–∞ ¬´${m.name}¬ª —á–∞—Å—Ç–æ —É–∫–∞–∑—ã–≤–∞—é—Ç: ${m.prop}.`
                        })
                    );
                });
            }

            // 4) –°–∏–º–≤–æ–ª—ã —ç–ª–µ–º–µ–Ω—Ç–æ–≤ (–¥–ª—è 7+)
            if (band !== '1-4') {
                const elementToSymbol = [
                    { key: '–ö–∏—Å–ª–æ—Ä–æ–¥', value: 'O' },
                    { key: '–í–æ–¥–æ—Ä–æ–¥', value: 'H' },
                    { key: '–£–≥–ª–µ—Ä–æ–¥', value: 'C' },
                    { key: '–ê–∑–æ—Ç', value: 'N' },
                    { key: '–ù–∞—Ç—Ä–∏–π', value: 'Na' },
                    { key: '–ö–∞–ª–∏–π', value: 'K' },
                    { key: '–ö–∞–ª—å—Ü–∏–π', value: 'Ca' },
                    { key: '–ñ–µ–ª–µ–∑–æ', value: 'Fe' },
                    { key: '–ú–µ–¥—å', value: 'Cu' },
                    { key: '–°–µ—Ä–∞', value: 'S' },
                    { key: '–•–ª–æ—Ä', value: 'Cl' },
                    { key: '–ú–∞–≥–Ω–∏–π', value: 'Mg' }
                ];
                const names = elementToSymbol.map(x => x.key);
                elementToSymbol.forEach((el, idx) => {
                    const seed = 909 + idx * 29 + bandStartGrade * 17;
                    const distract = pickDistractors(names, el.key, 3, seed);
                    const opts = shuffleWithSeed([el.key, ...distract], seed + 7);
                    out.push(
                        makeMcq({
                            id: stableId(prefix, out.length + 1),
                            topic: '–ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∞—è —Å–∏—Å—Ç–µ–º–∞',
                            difficulty: diff,
                            question: `–ö–∞–∫–æ–π —ç–ª–µ–º–µ–Ω—Ç –æ–±–æ–∑–Ω–∞—á–∞–µ—Ç—Å—è —Å–∏–º–≤–æ–ª–æ–º ¬´${el.value}¬ª?`,
                            options: opts,
                            correct: opts.indexOf(el.key),
                            explanation: `–°–∏–º–≤–æ–ª ${el.value} —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —ç–ª–µ–º–µ–Ω—Ç—É: ${el.key}.`
                        })
                    );
                });
            }

            // 5) –§–æ—Ä–º—É–ª—ã —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—ë–Ω–Ω—ã—Ö –≤–µ—â–µ—Å—Ç–≤ (–¥–ª—è 7+)
            if (band !== '1-4') {
                const nameToFormula = [
                    { key: '–í–æ–¥–∞', value: 'H2O' },
                    { key: '–£–≥–ª–µ–∫–∏—Å–ª—ã–π –≥–∞–∑', value: 'CO2' },
                    { key: '–ö–∏—Å–ª–æ—Ä–æ–¥', value: 'O2' },
                    { key: '–ê–∑–æ—Ç', value: 'N2' },
                    { key: '–ü–æ–≤–∞—Ä–µ–Ω–Ω–∞—è —Å–æ–ª—å', value: 'NaCl' },
                    { key: '–ê–º–º–∏–∞–∫', value: 'NH3' },
                    { key: '–ú–µ—Ç–∞–Ω', value: 'CH4' },
                    { key: '–°–µ—Ä–Ω–∞—è –∫–∏—Å–ª–æ—Ç–∞', value: 'H2SO4' },
                    { key: '–°–æ–ª—è–Ω–∞—è –∫–∏—Å–ª–æ—Ç–∞', value: 'HCl' },
                    { key: '–ì–∏–¥—Ä–æ–∫—Å–∏–¥ –Ω–∞—Ç—Ä–∏—è', value: 'NaOH' },
                    { key: '–ö–∞–ª—å—Ü–∏–π –∫–∞—Ä–±–æ–Ω–∞—Ç (–º–µ–ª)', value: 'CaCO3' },
                    { key: '–ì–ª—é–∫–æ–∑–∞', value: 'C6H12O6' },
                    { key: '–û–∫—Å–∏–¥ –∂–µ–ª–µ–∑–∞(III)', value: 'Fe2O3' },
                    { key: '–û–∫—Å–∏–¥ –∫–∞–ª—å—Ü–∏—è', value: 'CaO' },
                    { key: '–≠—Ç–∞–Ω–æ–ª', value: 'C2H5OH' }
                ];
                const formulas = nameToFormula.map(x => x.value);
                nameToFormula.forEach((x, idx) => {
                    const seed = 7007 + idx * 23 + bandStartGrade * 11;
                    const distract = pickDistractors(formulas, x.value, 3, seed);
                    const options = shuffleWithSeed([x.value, ...distract], seed + 2);
                    out.push(
                        makeMcq({
                            id: stableId(`${prefix}_formulas`, idx + 1),
                            topic: '–§–æ—Ä–º—É–ª—ã',
                            difficulty: diff,
                            question: `–ö–∞–∫–∞—è —Ñ–æ—Ä–º—É–ª–∞ —É –≤–µ—â–µ—Å—Ç–≤–∞: ¬´${x.key}¬ª?`,
                            options,
                            correct: options.indexOf(x.value),
                            explanation: `¬´${x.key}¬ª –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç –∫–∞–∫ ${x.value}.`
                        })
                    );
                });
            }

            }

            // –§–∏–Ω–∞–ª: —É–Ω–∏–∫–∞–ª–∏–∑–∏—Ä—É–µ–º –∏ –±–µ—Ä—ë–º —Ä–æ–≤–Ω–æ desiredCount
            const uniq = new Map();
            out.forEach(q => {
                const k = `${q.question}@@${q.topic}`;
                if (!uniq.has(k)) uniq.set(k, q);
            });
            const unique = Array.from(uniq.values());
            const rotated = shuffleWithSeed(unique, bandStartGrade * 313);
            return rotated
                .slice(0, desiredCount)
                .map(q => ({ ...q, subject: 'chemistry', gradeBand: band }));
        }

        // –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –≤–æ–ø—Ä–æ—Å–æ–≤ –ø–æ –∫–ª–∞—Å—Å–∞–º –∏ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏
        // –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –≤–æ–ø—Ä–æ—Å–æ–≤ - –∏—Å–ø–æ–ª—å–∑—É–µ–º —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
        console.log('Initializing questionDatabase...');

        // 20 –∫–∞—Ä—Ç–æ—á–µ–∫ —Ç–µ—Å—Ç–æ–≤ (–∫–∞–∫ –≤ UI). –î–µ–ª–∞–µ–º –±–æ–ª—å—à–∏–µ –±–∞–Ω–∫–∏, —á—Ç–æ–±—ã –≤–æ–ø—Ä–æ—Å—ã –Ω–µ –ø–æ–≤—Ç–æ—Ä—è–ª–∏—Å—å.
        const TEST_CARD_IDS = [
            'profession_general_1','profession_general_5','profession_general_7','profession_general_9','profession_general_10',
            'profession_med_1','profession_med_5','profession_med_7','profession_med_9','profession_med_10',
            'biology_1','biology_5','biology_7','biology_9','biology_10',
            'chemistry_1','chemistry_5','chemistry_7','chemistry_9','chemistry_10'
        ];

        function targetCountByBandStart(bandStartGrade) {
            const g = parseInt(bandStartGrade, 10);
            if (g === 1) return 120;
            if (g === 5) return 150;
            if (g === 7) return 180;
            if (g === 9) return 220;
            if (g === 10) return 260;
            return 180;
        }

        // Meta –¥–ª—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –∏ –¥–ª—è –ª–µ–Ω–∏–≤–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
        const QUESTION_COUNTS_BY_TEST_ID = {};
        TEST_CARD_IDS.forEach((id) => {
            const bandStart = inferBandStartFromTestId(id);
            QUESTION_COUNTS_BY_TEST_ID[id] = targetCountByBandStart(bandStart || 7);
        });
        // –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ–º –≤ window, —á—Ç–æ–±—ã –≥–ª–∞–≤–Ω–∞—è –º–æ–≥–ª–∞ –ø–æ–∫–∞–∑–∞—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–∞–∂–µ –ø—Ä–∏ lazy-–≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
        window.__questionCountsByTestId = QUESTION_COUNTS_BY_TEST_ID;

        function desiredCountForTestId(testId) {
            const bandStart = inferBandStartFromTestId(testId);
            return QUESTION_COUNTS_BY_TEST_ID[testId] || targetCountByBandStart(bandStart || 7);
        }

        const questionDatabase = {
            // –ü—Ä–æ—Ñ–æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏—è –æ–±—â–∞—è
            profession_general_1: () => generateProfessionGeneralQuestions(1, desiredCountForTestId('profession_general_1')),
            profession_general_5: () => generateProfessionGeneralQuestions(5, desiredCountForTestId('profession_general_5')),
            profession_general_7: () => generateProfessionGeneralQuestions(7, desiredCountForTestId('profession_general_7')),
            profession_general_9: () => generateProfessionGeneralQuestions(9, desiredCountForTestId('profession_general_9')),
            profession_general_10: () => generateProfessionGeneralQuestions(10, desiredCountForTestId('profession_general_10')),
            // –ú–µ–¥–∏—Ü–∏–Ω—Å–∫–∞—è –ø—Ä–æ—Ñ–æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏—è
            profession_med_1: () => generateMedicalProfessionQuestions(1, desiredCountForTestId('profession_med_1')),
            profession_med_5: () => generateMedicalProfessionQuestions(5, desiredCountForTestId('profession_med_5')),
            profession_med_7: () => generateMedicalProfessionQuestions(7, desiredCountForTestId('profession_med_7')),
            profession_med_9: () => generateMedicalProfessionQuestions(9, desiredCountForTestId('profession_med_9')),
            profession_med_10: () => generateMedicalProfessionQuestions(10, desiredCountForTestId('profession_med_10')),
            // –ë–∏–æ–ª–æ–≥–∏—è
            biology_1: () => generateBiologyByGrade(1, desiredCountForTestId('biology_1')),
            biology_5: () => generateBiologyByGrade(5, desiredCountForTestId('biology_5')),
            biology_7: () => generateBiologyByGrade(7, desiredCountForTestId('biology_7')),
            biology_9: () => generateBiologyByGrade(9, desiredCountForTestId('biology_9')),
            biology_10: () => generateBiologyByGrade(10, desiredCountForTestId('biology_10')),
            // –•–∏–º–∏—è
            chemistry_1: () => generateChemistryByGrade(1, desiredCountForTestId('chemistry_1')),
            chemistry_5: () => generateChemistryByGrade(5, desiredCountForTestId('chemistry_5')),
            chemistry_7: () => generateChemistryByGrade(7, desiredCountForTestId('chemistry_7')),
            chemistry_9: () => generateChemistryByGrade(9, desiredCountForTestId('chemistry_9')),
            chemistry_10: () => generateChemistryByGrade(10, desiredCountForTestId('chemistry_10')),
            // –°—Ç–∞—Ä—ã–µ –Ω–∞–∑–≤–∞–Ω–∏—è –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏
            biology: () => generateBiologyByGrade(9, desiredCountForTestId('biology_9')),
            chemistry: () => generateChemistryByGrade(9, desiredCountForTestId('chemistry_9')),
            profession: () => generateProfessionGeneralQuestions(9, desiredCountForTestId('profession_general_9'))
        };
        console.log('QuestionDatabase initialized with', Object.keys(questionDatabase).length, 'test types');

        // –°–∏—Å—Ç–µ–º–∞ –∞–¥–∞–ø—Ç–∏–≤–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
        class AdaptiveTestSystem {
            constructor() {
                this.currentTest = null;
                this.currentQuestion = 0;
                this.score = 0;
                this.answers = [];
                this.currentDifficulty = 1;
                this.questionsUsed = new Set();
                this.questionKeysUsed = new Set();
                this.skippedQuestions = [];
                this.totalQuestions = 40;
                this.maxDifficulty = 4;
                this.startTime = null;
                this.testResults = null;
                this.currentQuestionData = null;
            }

            getQuestionUniqueKey(q, fallbackIndex = 0) {
                if (!q) return `null_${fallbackIndex}`;
                const kind = q.kind || 'mcq';
                const topic = q.topic || '';
                const dim = q.dimension || '';
                const text = (q.question || '').trim();
                // –ï—Å–ª–∏ –≤–¥—Ä—É–≥ –Ω–µ—Ç —Ç–µ–∫—Å—Ç–∞, –∏—Å–ø–æ–ª—å–∑—É–µ–º id/–∏–Ω–¥–µ–∫—Å
                const base = text || String(q.id || fallbackIndex);
                return `${kind}|${topic}|${dim}|${base}`;
            }

            collectQuestionsForCurrentTest() {
                const subject = questionDatabase[this.currentTest];
                if (!subject) return [];
                if (Array.isArray(subject)) return subject;

                // Lazy generator: —Ñ—É–Ω–∫—Ü–∏—è, –≤–æ–∑–≤—Ä–∞—â–∞—é—â–∞—è –º–∞—Å—Å–∏–≤ –≤–æ–ø—Ä–æ—Å–æ–≤
                if (typeof subject === 'function') {
                    try {
                        const generated = subject();
                        const arr = Array.isArray(generated) ? generated : [];
                        const cat = inferCategoryFromTestId(this.currentTest);
                        if (!cat) return arr;
                        const hasTags = arr.some(q => q && q.subject);
                        if (!hasTags) return arr;
                        return arr.filter(q => q && q.subject === cat);
                    } catch (e) {
                        console.warn('Failed to generate questions for', this.currentTest, e);
                        return [];
                    }
                }

                const maxLevel = Math.min(this.maxDifficulty || 4, 4);
                let questions = [];
                for (let level = 1; level <= maxLevel; level++) {
                    questions = questions.concat(subject[level] || []);
                }
                const cat = inferCategoryFromTestId(this.currentTest);
                if (!cat) return questions;
                const hasTags = questions.some(q => q && q.subject);
                if (!hasTags) return questions;
                return questions.filter(q => q && q.subject === cat);
            }

            startTest(subject, userGrade = 5) {
                console.log('AdaptiveTestSystem.startTest called with:', subject, userGrade);
                
                this.currentTest = subject;
                this.currentQuestion = 0;
                this.score = 0;
                this.answers = [];

                // –°–ª–æ–∂–Ω–æ—Å—Ç—å –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –∫–∞—Ä—Ç–æ—á–∫–æ–π —Ç–µ—Å—Ç–∞ (biology_10 / chemistry_9 –∏ —Ç.–ø.)
                const bandStart = inferBandStartFromTestId(subject);
                const band = bandStart ? normalizeBandLabel(bandStart) : null;
                const byCard = band ? difficultyByBand(band) : null;
                this.maxDifficulty = byCard || this.getDifficultyForGrade(userGrade);
                this.currentDifficulty = this.maxDifficulty;
                this.questionsUsed.clear();
                this.questionKeysUsed.clear();
                this.skippedQuestions = [];
                this.startTime = Date.now();
                this.testResults = null;
                this.updateSkippedInfo();

                // –ü–æ–¥—Å—Ç—Ä–∞–∏–≤–∞–µ–º –¥–ª–∏–Ω—É —Ç–µ—Å—Ç–∞ –ø–æ–¥ —Ä–µ–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –±–∞–Ω–∫–∞, —á—Ç–æ–±—ã –Ω–µ –±—ã–ª–æ –ø–æ–≤—Ç–æ—Ä–æ–≤
                try {
                    const pool = this.collectQuestionsForCurrentTest();
                    const uniq = new Set();
                    pool.forEach((q, idx) => uniq.add(this.getQuestionUniqueKey(q, idx)));
                    const available = uniq.size || pool.length || 0;
                    const bandStart = inferBandStartFromTestId(subject);
                    const desiredLen = bandStart === 1 ? 30 : bandStart === 5 ? 40 : bandStart === 7 ? 45 : bandStart === 9 ? 50 : bandStart === 10 ? 60 : 45;
                    this.totalQuestions = available > 0 ? Math.min(desiredLen, available) : desiredLen;
                } catch {
                    this.totalQuestions = 45;
                }
                
                console.log('Test initialized, calling showQuestion');
                this.showQuestion();
            }

            getNextQuestion() {
                const questions = this.collectQuestionsForCurrentTest();
                if (!questions || questions.length === 0) return null;

                // –§–∏–ª—å—Ç—Ä—É–µ–º —É–∂–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã (–ø–æ id –∏ –ø–æ –∫–ª—é—á—É —Ç–µ–∫—Å—Ç–∞)
                const availableQuestions = questions.filter((q, index) => {
                    const idKey = q && q.id ? String(q.id) : String(index);
                    const uniqKey = this.getQuestionUniqueKey(q, index);
                    return !this.questionsUsed.has(idKey) && !this.questionKeysUsed.has(uniqKey);
                });

                if (availableQuestions.length === 0) {
                    return null;
                }

                const isOrientation = isOrientationSubjectId(this.currentTest);

                // –î–ª—è –ø—Ä–µ–¥–º–µ—Ç–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤ —Å—Ç–∞—Ä–∞–µ–º—Å—è –¥–µ—Ä–∂–∞—Ç—å—Å—è –æ–∫–æ–ª–æ —Ç–µ–∫—É—â–µ–π —Å–ª–æ–∂–Ω–æ—Å—Ç–∏
                let question = null;
                if (!isOrientation) {
                    const target = Math.min(4, Math.max(1, this.currentDifficulty || this.maxDifficulty || 3));
                    const withDist = availableQuestions.map((q) => {
                        const d = Math.min(4, Math.max(1, parseInt(q?.difficulty, 10) || target));
                        const dist = Math.abs(d - target);
                        return { q, d, dist };
                    });

                    // –ü—ã—Ç–∞–µ–º—Å—è –±—Ä–∞—Ç—å –≤–æ–ø—Ä–æ—Å—ã —Å dist 0..1, –∏–Ω–∞—á–µ fallback
                    const near = withDist.filter(x => x.dist <= 1);
                    const pool = near.length > 0 ? near : withDist;

                    // –í–∑–≤–µ—à–µ–Ω–Ω—ã–π –≤—ã–±–æ—Ä: –±–ª–∏–∂–µ –∫ target ‚Äî –≤—ã—à–µ —à–∞–Ω—Å
                    const weights = pool.map(x => (x.dist === 0 ? 3 : x.dist === 1 ? 2 : 1));
                    const totalW = weights.reduce((s, w) => s + w, 0);
                    let r = Math.random() * totalW;
                    let picked = pool[pool.length - 1];
                    for (let i = 0; i < pool.length; i++) {
                        r -= weights[i];
                        if (r <= 0) { picked = pool[i]; break; }
                    }
                    question = picked.q;
                } else {
                    // –ü—Ä–æ—Ñ–æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏—è: —Å–ª—É—á–∞–π–Ω—ã–π –≤–æ–ø—Ä–æ—Å
                    const randomIndex = Math.floor(Math.random() * availableQuestions.length);
                    question = availableQuestions[randomIndex];
                }

                const originalIndex = questions.indexOf(question);

                const idKey = question && question.id ? String(question.id) : String(originalIndex);
                const uniqKey = this.getQuestionUniqueKey(question, originalIndex);
                this.questionsUsed.add(idKey);
                this.questionKeysUsed.add(uniqKey);
                return question;
            }

            getDifficultyForGrade(grade) {
                const g = parseInt(grade, 10) || 9;
                if (g <= 4) return 1;
                if (g <= 6) return 2;
                if (g <= 8) return 3;
                if (g === 9) return 3;
                return 4;
            }

            showQuestion() {
                console.log('showQuestion called, currentQuestion:', this.currentQuestion);
                
                const answeredCount = this.answers.length;
                const skippedCount = this.skippedQuestions.length;
                const remainingSlots = this.totalQuestions - answeredCount;
                const shouldFinish = remainingSlots <= 0 && skippedCount === 0;
                if (shouldFinish) {
                    console.log('All required questions answered, finishing test');
                    this.finishTest();
                    return;
                }

                let question = null;
                if (skippedCount > 0 && skippedCount >= remainingSlots) {
                    // –ï—Å–ª–∏ –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ, —á—Ç–æ–±—ã –∑–∞–∫—Ä—ã—Ç—å –æ—Å—Ç–∞–≤—à–∏–µ—Å—è —Å–ª–æ—Ç—ã, —Å–Ω–∞—á–∞–ª–∞ –≤–µ—Ä–Ω—ë–º –∏—Ö
                    question = this.skippedQuestions.shift();
                } else {
                    question = this.getNextQuestion() || this.skippedQuestions.shift();
                }

                console.log('Got question:', question);
                
                if (!question) {
                    console.log('No more questions available, finishing test');
                    this.finishTest();
                    return;
                }

                this.renderQuestion(question, answeredCount + 1);
                this.updateProgressBar();
                this.updateSkippedInfo();
            }

            renderQuestion(question, displayNumber) {
                // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º –≤–æ–ø—Ä–æ—Å —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤
                const questionCounter = document.getElementById('question-counter');
                const questionText = document.getElementById('question-text');
                const difficultyIndicator = document.getElementById('difficulty-indicator');
                const optionsContainer = document.getElementById('options-container');

                if (questionCounter) {
                    const num = Math.min(displayNumber, this.totalQuestions);
                    questionCounter.textContent = `–í–æ–ø—Ä–æ—Å ${num} –∏–∑ ${this.totalQuestions}`;
                }

                if (questionText) {
                    questionText.textContent = question.question;
                }

                if (difficultyIndicator) {
                    const difficultyLevels = ['–ù–∞—á–∞–ª—å–Ω—ã–π', '–õ—ë–≥–∫–∏–π', '–°—Ä–µ–¥–Ω–∏–π', '–°–ª–æ–∂–Ω—ã–π', '–ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π'];
                    const level = Math.min(4, Math.max(0, (question.difficulty || 1) - 1));
                    difficultyIndicator.textContent = `–£—Ä–æ–≤–µ–Ω—å —Å–ª–æ–∂–Ω–æ—Å—Ç–∏: ${difficultyLevels[level]}`;
                }

                if (optionsContainer) {
                    optionsContainer.innerHTML = '';
                    (question.options || []).forEach((option, index) => {
                        const optionElement = document.createElement('div');
                        optionElement.className = 'option';
                        optionElement.onclick = () => this.selectOption(index);
                        optionElement.innerHTML = `
                            <input type="radio" name="answer" value="${index}">
                            <span>${option}</span>
                        `;
                        optionsContainer.appendChild(optionElement);
                    });
                }

                // –ë–ª–æ–∫–∏—Ä—É–µ–º –∫–Ω–æ–ø–∫—É –æ—Ç–≤–µ—Ç–∞ –¥–æ –≤—ã–±–æ—Ä–∞ –≤–∞—Ä–∏–∞–Ω—Ç–∞
                const nextBtn = document.getElementById('adaptive-next-btn');
                if (nextBtn) {
                    nextBtn.disabled = true;
                    nextBtn.style.display = 'inline-flex';
                }

                // –í–∫–ª—é—á–∞–µ–º/–≤—ã–∫–ª—é—á–∞–µ–º –∫–Ω–æ–ø–∫—É "–ù–∞–∑–∞–¥" (–ø—Ä–µ–¥—ã–¥—É—â–∏–π –≤–æ–ø—Ä–æ—Å)
                const prevBtn = document.getElementById('adaptive-prev-btn');
                if (prevBtn) {
                    prevBtn.disabled = this.answers.length === 0;
                    prevBtn.style.display = 'inline-flex';
                }

                this.currentQuestionData = question;
            }

            selectOption(selectedIndex) {
                const options = document.querySelectorAll('.option');
                options.forEach(option => option.classList.remove('selected'));
                options[selectedIndex].classList.add('selected');

                const nextBtn = document.getElementById('adaptive-next-btn');
                if (nextBtn) {
                    nextBtn.disabled = false;
                    nextBtn.style.display = 'inline-flex';
                }
            }

            submitAnswer() {
                const selectedOption = document.querySelector('.option.selected');
                if (!selectedOption) return;

                const selectedIndex = parseInt(selectedOption.querySelector('input').value);
                const isOrientation = this.currentQuestionData && this.currentQuestionData.kind === 'likert';
                const isCorrect = isOrientation ? null : (selectedIndex === this.currentQuestionData.correct);
                
                // —Å–æ—Ö—Ä–∞–Ω—è–µ–º —Å–Ω–∞–ø—à–æ—Ç –≤–æ–ø—Ä–æ—Å–∞, —á—Ç–æ–±—ã –º–æ–∂–Ω–æ –±—ã–ª–æ –≤–µ—Ä–Ω—É—Ç—å—Å—è "–ù–∞–∑–∞–¥"
                const questionSnapshot = {
                    id: this.currentQuestionData.id,
                    kind: this.currentQuestionData.kind,
                    dimension: this.currentQuestionData.dimension,
                    topic: this.currentQuestionData.topic,
                    question: this.currentQuestionData.question,
                    options: Array.isArray(this.currentQuestionData.options) ? [...this.currentQuestionData.options] : [],
                    correct: this.currentQuestionData.correct,
                    difficulty: this.currentQuestionData.difficulty,
                    explanation: this.currentQuestionData.explanation
                };

                this.answers.push({
                    question: questionSnapshot.question,
                    selectedIndex,
                    correctIndex: questionSnapshot.correct,
                    isCorrect,
                    difficulty: questionSnapshot.difficulty,
                    explanation: questionSnapshot.explanation,
                    topic: questionSnapshot.topic,
                    kind: questionSnapshot.kind,
                    dimension: questionSnapshot.dimension,
                    questionId: questionSnapshot.id,
                    questionData: questionSnapshot
                });

                if (!isOrientation && isCorrect) this.score++;

                // –ü—Ä–æ—Å—Ç–∞—è –∞–¥–∞–ø—Ç–∞—Ü–∏—è —Å–ª–æ–∂–Ω–æ—Å—Ç–∏: –≤–≤–µ—Ä—Ö –∑–∞ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π, –≤–Ω–∏–∑ –∑–∞ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π
                if (!isOrientation) {
                    if (isCorrect === true && this.currentDifficulty < this.maxDifficulty) {
                        this.currentDifficulty += 1;
                    } else if (isCorrect === false && this.currentDifficulty > 1) {
                        this.currentDifficulty -= 1;
                    }
                }
                this.currentQuestion++;
                
                setTimeout(() => {
                    this.showQuestion();
                }, 500);
            }

            goBackOneQuestion() {
                if (!this.currentTest) return;
                if (!this.answers || this.answers.length === 0) return;

                const last = this.answers.pop();
                // –æ—Ç–∫–∞—Ç—ã–≤–∞–µ–º score —Ç–æ–ª—å–∫–æ –¥–ª—è –ø—Ä–µ–¥–º–µ—Ç–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤
                if (!isOrientationSubjectId(this.currentTest) && last && last.isCorrect) {
                    this.score = Math.max(0, this.score - 1);
                }

                // –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Ç–æ—Ç –∂–µ –≤–æ–ø—Ä–æ—Å —Å–Ω–æ–≤–∞
                const q = last && last.questionData ? last.questionData : null;
                if (!q) {
                    this.showQuestion();
                    return;
                }

                // –í–æ–∑–≤—Ä–∞—â–∞–µ–º –≤–æ–ø—Ä–æ—Å –≤ –ø–æ—Ç–æ–∫: —É–±–∏—Ä–∞–µ–º –∏–∑ used, —á—Ç–æ–±—ã –Ω–µ —Ç–µ—Ä—è–ª—Å—è
                try {
                    if (q.id) this.questionsUsed.delete(String(q.id));
                    this.questionKeysUsed.delete(this.getQuestionUniqueKey(q, 0));
                } catch {
                    // ignore
                }
                this.currentQuestionData = q;

                // –†–µ–Ω–¥–µ—Ä–∏–º –∫–∞–∫ "—Ç–µ–∫—É—â–∏–π" (–Ω–æ–º–µ—Ä = answers.length + 1)
                this.renderQuestion(q, this.answers.length + 1);
                this.updateProgressBar();
                this.updateSkippedInfo();
            }

            skipCurrentQuestion() {
                if (!this.currentQuestionData) return;
                this.skippedQuestions.push(this.currentQuestionData);
                this.currentQuestionData = null;
                this.updateSkippedInfo();
                this.showQuestion();
            }

            updateProgressBar() {
                const progress = (this.answers.length / this.totalQuestions) * 100;
                const progressFill = document.getElementById('progress-fill');
                if (progressFill) {
                    progressFill.style.width = `${progress}%`;
                }
            }

            updateSkippedInfo() {
                const skippedInfo = document.getElementById('skipped-info');
                if (!skippedInfo) return;
                const skipped = this.skippedQuestions.length;
                skippedInfo.textContent = skipped > 0
                    ? `–ü—Ä–æ–ø—É—â–µ–Ω–æ: ${skipped}`
                    : '–ù–µ—Ç –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö –≤–æ–ø—Ä–æ—Å–æ–≤';
            }

            finishTest() {
                const endTime = Date.now();
                const timeSpent = Math.floor((endTime - this.startTime) / 1000);

                const isOrientation = isOrientationSubjectId(this.currentTest);
                let percentage = 0;
                let profile = null;
                if (isOrientation) {
                    profile = this.computeOrientationProfile();
                    percentage = profile.overallScore;
                } else {
                    percentage = this.answers.length > 0
                        ? Math.round((this.score / this.answers.length) * 100)
                        : 0;
                }
                
                this.testResults = {
                    score: this.score,
                    total: this.answers.length,
                    percentage,
                    timeSpent,
                    answers: this.answers,
                    subject: this.currentTest,
                    isOrientation,
                    profile
                };

                this.showResults();
                this.saveResults();
            }

            showResults() {
                // –°–∫—Ä—ã—Ç—å —Ç–æ–ª—å–∫–æ –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Ç–µ—Å—Ç–∞ –≤–Ω—É—Ç—Ä–∏ —Å–µ–∫—Ü–∏–∏ tests (–Ω–µ —Å—Ç–∞—Ä—ã–π)
                const adaptiveContainer = [...document.querySelectorAll('#tests .test-container')]
                    .find(c => c.id !== 'test-questions-container');
                if (adaptiveContainer) adaptiveContainer.style.display = 'none';

                // –ü–æ–∫–∞–∑–∞—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã
                const adaptiveResultContainer = document.getElementById('adaptive-result-container');
                if (adaptiveResultContainer) {
                    adaptiveResultContainer.style.display = 'block';
                    adaptiveResultContainer.classList.add('show');
                }

                const adaptiveResultScore = document.getElementById('adaptive-result-score');
                if (adaptiveResultScore) {
                    adaptiveResultScore.textContent = `${this.testResults.percentage}%`;
                }
                
                this.displayDetailedResults();
            }
            
            displayDetailedResults() {
                const statsContainer = document.getElementById('adaptive-result-stats');
                if (statsContainer) {
                    const incorrectCount = this.testResults.isOrientation ? 0 : (this.testResults.total - this.testResults.score);
                    statsContainer.innerHTML = `
                        <div class="stat-item">
                            <span class="stat-icon">${this.testResults.isOrientation ? 'üß≠' : '‚úÖ'}</span>
                            <span class="stat-value">${this.testResults.isOrientation ? this.testResults.total : this.testResults.score}</span>
                            <span class="stat-label">${this.testResults.isOrientation ? '–û—Ç–≤–µ—Ç–æ–≤' : '–ü—Ä–∞–≤–∏–ª—å–Ω—ã—Ö'}</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-icon">${this.testResults.isOrientation ? 'üìå' : '‚ùå'}</span>
                            <span class="stat-value">${this.testResults.isOrientation ? this.skippedQuestions.length : incorrectCount}</span>
                            <span class="stat-label">${this.testResults.isOrientation ? '–ü—Ä–æ–ø—É—â–µ–Ω–æ' : '–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö'}</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-icon">‚è±Ô∏è</span>
                            <span class="stat-value">${Math.floor(this.testResults.timeSpent / 60)}:${(this.testResults.timeSpent % 60).toString().padStart(2, '0')}</span>
                            <span class="stat-label">–í—Ä–µ–º—è</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-icon">üìä</span>
                            <span class="stat-value">${this.testResults.percentage}%</span>
                            <span class="stat-label">${this.testResults.isOrientation ? '–ü—Ä–æ—Ñ–∏–ª—å' : '–¢–æ—á–Ω–æ—Å—Ç—å'}</span>
                        </div>
                    `;
                }
                
                const analysisContainer = document.getElementById('adaptive-analysis-section');
                if (analysisContainer) {
                    const levelInfo = this.getLevelInfo();
                    const weaknesses = this.getWeaknesses();

                    if (this.testResults.isOrientation) {
                        const prof = this.testResults.profile;
                        const scores = (prof && Array.isArray(prof.scores)) ? prof.scores : [];
                        const top = scores.slice(0, 3);

                        const labelOf = (k) => (typeof ORIENTATION_DIM_LABELS === 'object' && ORIENTATION_DIM_LABELS && ORIENTATION_DIM_LABELS[k]) ? ORIENTATION_DIM_LABELS[k] : String(k);

                        const suggestCareers = () => {
                            const keys = top.map(t => t.key);
                            const subject = String(this.testResults.subject || '');
                            const list = [];

                            const push = (v) => { if (v && !list.includes(v)) list.push(v); };
                            const has = (k) => keys.includes(k);

                            // –ú–µ–¥.—Ç—Ä–µ–∫ ‚Äî –±–æ–ª—å—à–µ —É–ø–æ—Ä –Ω–∞ –º–µ–¥.–ø—Ä–æ—Ñ–µ—Å—Å–∏–∏
                            if (subject.startsWith('profession_med_')) {
                                if (has('empathy') || has('people')) { push('–ú–µ–¥—Å–µ—Å—Ç—Ä–∞ / –º–µ–¥–±—Ä–∞—Ç'); push('–ü–µ–¥–∏–∞—Ç—Ä'); }
                                if (has('science') || has('analysis')) { push('–õ–∞–±–æ—Ä–∞–Ω—Ç / –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞'); push('–§–∞—Ä–º–∞—Ü–µ–≤—Ç'); }
                                if (has('accuracy')) { push('–°—Ç–æ–º–∞—Ç–æ–ª–æ–≥'); push('–ú–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–π –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω—ã–π —Ç–µ—Ö–Ω–∏–∫'); }
                                if (has('stress')) { push('–°–∫–æ—Ä–∞—è –ø–æ–º–æ—â—å (—Ñ–µ–ª—å–¥—à–µ—Ä)'); }
                                if (has('teamwork')) { push('–í—Ä–∞—á –≤ —Å—Ç–∞—Ü–∏–æ–Ω–∞—Ä–µ (–∫–æ–º–∞–Ω–¥–Ω–∞—è —Ä–∞–±–æ—Ç–∞)'); }
                                if (has('responsibility')) { push('–í—Ä–∞—á –æ–±—â–µ–π –ø—Ä–∞–∫—Ç–∏–∫–∏'); }
                                // —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–µ
                                push('–ü—Å–∏—Ö–æ–ª–æ–≥ (–º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–π/–∫–ª–∏–Ω–∏—á–µ—Å–∫–∏–π)');
                                return list.slice(0, 7);
                            }

                            // –û–±—â–∞—è –ø—Ä–æ—Ñ–æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏—è
                            if (has('people')) { push('–ü—Å–∏—Ö–æ–ª–æ–≥'); push('–ü—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å'); push('HR-—Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç'); }
                            if (has('analysis')) { push('–ê–Ω–∞–ª–∏—Ç–∏–∫'); push('–ü—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç'); push('–ò–Ω–∂–µ–Ω–µ—Ä'); }
                            if (has('creativity')) { push('–î–∏–∑–∞–π–Ω–µ—Ä'); push('–ú–∞—Ä–∫–µ—Ç–æ–ª–æ–≥'); push('–ö–æ–Ω—Ç–µ–Ω—Ç-–º–µ–Ω–µ–¥–∂–µ—Ä'); }
                            if (has('practice')) { push('–¢–µ—Ö–Ω–∏–∫'); push('–ú–∞—Å—Ç–µ—Ä/—Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç –ø–æ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—é'); }
                            if (has('science')) { push('–ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å'); push('–õ–∞–±–æ—Ä–∞–Ω—Ç'); }
                            if (has('teamwork')) { push('–ú–µ–Ω–µ–¥–∂–µ—Ä –ø—Ä–æ–µ–∫—Ç–æ–≤'); push('–û—Ä–≥–∞–Ω–∏–∑–∞—Ç–æ—Ä –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π'); }

                            return list.slice(0, 7);
                        };

                        const careers = suggestCareers();

                        analysisContainer.innerHTML = `
                            <h3><i class="fas fa-compass"></i> –í–∞—à –ø—Ä–æ—Ñ–æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏–æ–Ω–Ω—ã–π –ø—Ä–æ—Ñ–∏–ª—å</h3>
                            <div class="grade-estimate">
                                üß≠ –ò—Ç–æ–≥: <strong>${levelInfo.level}</strong>
                                <br><small style="opacity: 0.9; margin-top: 8px; display: block;">${levelInfo.description}</small>
                            </div>

                            <div class="strengths">
                                <h4>–ß—Ç–æ –≤–∞–º –ø–æ–¥—Ö–æ–¥–∏—Ç —Å–∏–ª—å–Ω–µ–µ –≤—Å–µ–≥–æ</h4>
                                <div class="category-list">
                                    <ul>
                                        ${(top.length ? top : scores.slice(0, 3)).map(s => `<li>${labelOf(s.key)} ‚Äî ${s.score}%</li>`).join('')}
                                    </ul>
                                </div>
                            </div>

                            <div class="recommendations">
                                <h4>–ö–µ–º –º–æ–∂–Ω–æ –±—ã—Ç—å (–ø—Ä–∏–º–µ—Ä—ã)</h4>
                                <div class="category-list">
                                    <ul>
                                        ${(careers.length ? careers : ['–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π –ø–æ–∫–∞ –º–∞–ª–æ ‚Äî –æ—Ç–≤–µ—Ç—å—Ç–µ –Ω–∞ –±–æ–ª—å—à–µ –≤–æ–ø—Ä–æ—Å–æ–≤ –∏–ª–∏ –ø—Ä–æ–π–¥–∏—Ç–µ —Ç–µ—Å—Ç –µ—â—ë —Ä–∞–∑.']).map(c => `<li>${c}</li>`).join('')}
                                    </ul>
                                </div>
                            </div>

                            <div class="recommendations">
                                <h4>–ß—Ç–æ –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –¥–∞–ª—å—à–µ</h4>
                                <div class="category-list">
                                    <ul>
                                        ${this.getRecommendations().map(rec => `<li>${rec}</li>`).join('')}
                                    </ul>
                                </div>
                            </div>
                        `;
                    } else {
                        analysisContainer.innerHTML = `
                            <h3><i class="fas fa-chart-line"></i> –ê–Ω–∞–ª–∏–∑ –≤–∞—à–µ–≥–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞</h3>
                            
                            <div class="grade-estimate">
                                üìà –í–∞—à —É—Ä–æ–≤–µ–Ω—å –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏: <strong>${levelInfo.level}</strong>
                                <br><small style="opacity: 0.9; margin-top: 8px; display: block;">${levelInfo.description}</small>
                            </div>
                            
                            <div class="strengths">
                                <h4>–°–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã</h4>
                                <div class="category-list">
                                    <ul>
                                        ${this.getStrengths().map(strength => `<li>${strength}</li>`).join('')}
                                    </ul>
                                </div>
                            </div>
                            
                            <div class="weaknesses">
                                <h4>–û–±–ª–∞—Å—Ç–∏ –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è</h4>
                                <div class="category-list">
                                    <ul>
                                        ${weaknesses.map(weakness => `<li>${weakness}</li>`).join('')}
                                    </ul>
                                </div>
                            </div>
                            
                            <div class="recommendations">
                                <h4>–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏</h4>
                                <div class="category-list">
                                    <ul>
                                        ${this.getRecommendations().map(rec => `<li>${rec}</li>`).join('')}
                                    </ul>
                                </div>
                            </div>
                        `;
                    }
                }
                
                const answersContainer = document.getElementById('adaptive-detailed-answers');
                if (answersContainer) {
                    const difficultyNames = ['–ù–∞—á–∞–ª—å–Ω—ã–π', '–õ—ë–≥–∫–∏–π', '–°—Ä–µ–¥–Ω–∏–π', '–°–ª–æ–∂–Ω—ã–π'];
                    const isOrientationTest = !!this.testResults.isOrientation;
                    
                    answersContainer.innerHTML = `
                        <h3>üìã –î–µ—Ç–∞–ª—å–Ω—ã–π —Ä–∞–∑–±–æ—Ä –æ—Ç–≤–µ—Ç–æ–≤</h3>
                        ${this.testResults.answers.map((answer, index) => {
                            const difficultyName = difficultyNames[Math.min(answer.difficulty - 1, 3)] || '–°—Ä–µ–¥–Ω–∏–π';
                            const statusClass = isOrientationTest ? 'orientation' : (answer.isCorrect ? 'correct' : 'incorrect');
                            const statusText = isOrientationTest
                                ? `üß≠ ${LIKERT_5[clamp(answer.selectedIndex, 0, 4)]}`
                                : (answer.isCorrect ? '‚úì –í–µ—Ä–Ω–æ' : '‚úó –ù–µ–≤–µ—Ä–Ω–æ');
                            return `
                            <div class="answer-review ${statusClass}">
                                <div class="answer-header">
                                    <span class="question-num">–í–æ–ø—Ä–æ—Å ${index + 1}</span>
                                    <span class="difficulty-badge">${difficultyName}</span>
                                    <span class="result-badge ${statusClass}">
                                        ${statusText}
                                    </span>
                                </div>
                                <div class="answer-question">${answer.question}</div>
                                <div class="answer-explanation">
                                    <strong>üí° –û–±—ä—è—Å–Ω–µ–Ω–∏–µ:</strong> ${answer.explanation || '–û–±—ä—è—Å–Ω–µ–Ω–∏–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç'}
                                </div>
                            </div>
                        `}).join('')}
                    `;
                }
            }

            computeOrientationProfile() {
                const subject = this.currentTest;
                const answers = this.answers.filter(a => a.kind === 'likert' && typeof a.selectedIndex === 'number');

                const dims = {};
                answers.forEach(a => {
                    const dim = a.dimension || 'other';
                    const value = clamp(a.selectedIndex, 0, 4); // 0..4
                    if (!dims[dim]) dims[dim] = { sum: 0, count: 0 };
                    dims[dim].sum += value;
                    dims[dim].count += 1;
                });

                const scores = Object.entries(dims)
                    .map(([k, v]) => ({
                        key: k,
                        score: v.count > 0 ? Math.round((v.sum / (v.count * 4)) * 100) : 0
                    }))
                    .sort((a, b) => b.score - a.score);

                // –û–±—â–∏–π ¬´–∏–Ω–¥–µ–∫—Å –≤—ã—Ä–∞–∂–µ–Ω–Ω–æ—Å—Ç–∏¬ª: —á–µ–º –≤—ã—à–µ —Å—Ä–µ–¥–Ω–µ–µ –ø–æ –≤—Å–µ–º —à–∫–∞–ª–∞–º, —Ç–µ–º —è—Å–Ω–µ–µ –ø—Ä–æ—Ñ–∏–ª—å
                const avg = scores.length > 0
                    ? Math.round(scores.reduce((acc, s) => acc + s.score, 0) / scores.length)
                    : 0;

                // –î–ª—è –º–µ–¥.–ø—Ä–æ—Ñ–æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏–∏ —Å—á–∏—Ç–∞–µ–º ¬´–º–µ–¥–∏—Ü–∏–Ω—Å–∫—É—é –ø—Ä–∏–≥–æ–¥–Ω–æ—Å—Ç—å¬ª –ø–æ –∫–ª—é—á–µ–≤—ã–º —à–∫–∞–ª–∞–º
                const scoreByKey = Object.fromEntries(scores.map(s => [s.key, s.score]));
                const medKeys = ['empathy', 'responsibility', 'stress', 'accuracy', 'science', 'teamwork'];
                const medAvg = Math.round(medKeys.reduce((acc, k) => acc + (scoreByKey[k] ?? 0), 0) / medKeys.length);

                const overallScore = subject.startsWith('profession_med_') ? medAvg : avg;

                return {
                    overallScore,
                    scores
                };
            }
            
            getLevelInfo() {
                if (this.testResults.isOrientation) {
                    const p = this.testResults.profile;
                    const overall = p?.overallScore ?? this.testResults.percentage;
                    if (overall >= 80) {
                        return { level: '–ü—Ä–æ—Ñ–∏–ª—å –≤—ã—Ä–∞–∂–µ–Ω', description: '–û—Ç–≤–µ—Ç—ã –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —É—Å—Ç–æ–π—á–∏–≤—ã–µ: –≤–∏–¥–Ω–æ, –∫–∞–∫–∏–µ —Ñ–æ—Ä–º–∞—Ç—ã –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –≤–∞–º –ø–æ–¥—Ö–æ–¥—è—Ç.' };
                    }
                    if (overall >= 60) {
                        return { level: '–ü—Ä–æ—Ñ–∏–ª—å —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è', description: '–ï—Å—Ç—å –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏—è, –Ω–æ —á–∞—Å—Ç—å —à–∫–∞–ª –ø–æ–∫–∞ –≤—ã—Ä–∞–∂–µ–Ω–∞ —É–º–µ—Ä–µ–Ω–Ω–æ ‚Äî —ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ.' };
                    }
                    return { level: '–ü—Ä–æ—Ñ–∏–ª—å –Ω–µ—É—Å—Ç–æ–π—á–∏–≤', description: '–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: –ø—Ä–æ–π—Ç–∏ —Ç–µ—Å—Ç –µ—â—ë —Ä–∞–∑ —á–µ—Ä–µ–∑ –Ω–µ—Å–∫–æ–ª—å–∫–æ –¥–Ω–µ–π –∏ —Å—Ä–∞–≤–Ω–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã.' };
                }

                const percentage = this.testResults.percentage;
                if (percentage >= 90) {
                    return { level: '–û—Ç–ª–∏—á–Ω–æ (5)', description: '–ü—Ä–µ–≤–æ—Å—Ö–æ–¥–Ω–æ–µ –∑–Ω–∞–Ω–∏–µ –º–∞—Ç–µ—Ä–∏–∞–ª–∞! –í—ã –≥–æ—Ç–æ–≤—ã –∫ —É–≥–ª—É–±–ª—ë–Ω–Ω–æ–º—É –∏–∑—É—á–µ–Ω–∏—é.' };
                } else if (percentage >= 75) {
                    return { level: '–•–æ—Ä–æ—à–æ (4)', description: '–•–æ—Ä–æ—à–∏–π —É—Ä–æ–≤–µ–Ω—å –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏. –ï—â—ë –Ω–µ–º–Ω–æ–≥–æ –ø—Ä–∞–∫—Ç–∏–∫–∏ –¥–ª—è —Å–æ–≤–µ—Ä—à–µ–Ω—Å—Ç–≤–∞!' };
                } else if (percentage >= 60) {
                    return { level: '–£–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–∏—Ç–µ–ª—å–Ω–æ (3)', description: '–ë–∞–∑–æ–≤—ã–µ –∑–Ω–∞–Ω–∏—è –µ—Å—Ç—å, –Ω–æ —Ç—Ä–µ–±—É–µ—Ç—Å—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞.' };
                } else {
                    return { level: '–¢—Ä–µ–±—É–µ—Ç—Å—è –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞', description: '–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º –ø–æ–≤—Ç–æ—Ä–∏—Ç—å –º–∞—Ç–µ—Ä–∏–∞–ª –∏ –ø—Ä–æ–π—Ç–∏ —Ç–µ—Å—Ç —Å–Ω–æ–≤–∞.' };
                }
            }
            
            getWeaknesses() {
                if (this.testResults.isOrientation) {
                    const scores = this.testResults.profile?.scores || [];
                    const bottom = [...scores].reverse().slice(0, 2);
                    if (bottom.length === 0) return ['–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–∞–Ω–Ω—ã—Ö: –æ—Ç–≤–µ—Ç—å—Ç–µ –Ω–∞ –±–æ–ª—å—à–µ–µ —á–∏—Å–ª–æ –≤–æ–ø—Ä–æ—Å–æ–≤.'];
                    const labelOf = (k) => (typeof ORIENTATION_DIM_LABELS === 'object' && ORIENTATION_DIM_LABELS && ORIENTATION_DIM_LABELS[k]) ? ORIENTATION_DIM_LABELS[k] : String(k);
                    return bottom.map(s => `–®–∫–∞–ª–∞ ¬´${labelOf(s.key)}¬ª: ${s.score}% ‚Äî –º–æ–∂–Ω–æ —É—Å–∏–ª–∏—Ç—å —á–µ—Ä–µ–∑ –ø—Ä–∞–∫—Ç–∏–∫—É –∏ –ø—Ä–æ–±–Ω—ã–µ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏`);
                }

                const incorrectAnswers = this.testResults.answers.filter(a => a.isCorrect === false);
                const weaknesses = [];
                
                if (incorrectAnswers.length > 0) {
                    const easyMistakes = incorrectAnswers.filter(a => a.difficulty <= 2).length;
                    const mediumMistakes = incorrectAnswers.filter(a => a.difficulty > 2 && a.difficulty <= 4).length;
                    const hardMistakes = incorrectAnswers.filter(a => a.difficulty > 4).length;
                    
                    if (easyMistakes > 0) {
                        weaknesses.push(`–û—à–∏–±–∫–∏ –≤ –±–∞–∑–æ–≤—ã—Ö –≤–æ–ø—Ä–æ—Å–∞—Ö (${easyMistakes} —à—Ç.) - –ø–æ–≤—Ç–æ—Ä–∏—Ç–µ –æ—Å–Ω–æ–≤—ã`);
                    }
                    if (mediumMistakes > 0) {
                        weaknesses.push(`–û—à–∏–±–∫–∏ –≤ –≤–æ–ø—Ä–æ—Å–∞—Ö —Å—Ä–µ–¥–Ω–µ–π —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ (${mediumMistakes} —à—Ç.)`);
                    }
                    if (hardMistakes > 0) {
                        weaknesses.push(`–°–ª–æ–∂–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã —Ç—Ä–µ–±—É—é—Ç –¥–æ—Ä–∞–±–æ—Ç–∫–∏ (${hardMistakes} —à—Ç.)`);
                    }
                }
                
                if (weaknesses.length === 0) {
                    weaknesses.push('–û—Ç–ª–∏—á–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç! –û—Å–æ–±—ã—Ö —Å–ª–∞–±—ã—Ö –º–µ—Å—Ç –Ω–µ –≤—ã—è–≤–ª–µ–Ω–æ.');
                }
                
                return weaknesses;
            }
            
            getStrengths() {
                if (this.testResults.isOrientation) {
                    const scores = this.testResults.profile?.scores || [];
                    const top = scores.slice(0, 3);
                    if (top.length === 0) return ['–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–∞–Ω–Ω—ã—Ö: –æ—Ç–≤–µ—Ç—å—Ç–µ –Ω–∞ –±–æ–ª—å—à–µ–µ —á–∏—Å–ª–æ –≤–æ–ø—Ä–æ—Å–æ–≤.'];
                    const labelOf = (k) => (typeof ORIENTATION_DIM_LABELS === 'object' && ORIENTATION_DIM_LABELS && ORIENTATION_DIM_LABELS[k]) ? ORIENTATION_DIM_LABELS[k] : String(k);
                    return top.map(s => `–®–∫–∞–ª–∞ ¬´${labelOf(s.key)}¬ª: ${s.score}% ‚Äî –≤—ã—Ä–∞–∂–µ–Ω–∞ —Å–∏–ª—å–Ω–µ–µ –≤—Å–µ–≥–æ`);
                }

                // –î–ª—è –ø—Ä–µ–¥–º–µ—Ç–æ–≤: –∞–Ω–∞–ª–∏–∑ –ø–æ —Ç–µ–º–∞–º
                const topicStats = this.getTopicStats();
                const strengths = [];
                if (topicStats.length > 0) {
                    topicStats.slice(0, 3).forEach(t => strengths.push(`–¢–µ–º–∞ ¬´${t.topic}¬ª: ${t.accuracy}% –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö (${t.correct}/${t.total})`));
                }

                if (strengths.length === 0) {
                    strengths.push('–ï—Å—Ç—å –±–∞–∑–æ–≤—ã–µ –∑–Ω–∞–Ω–∏—è, –Ω–æ —Ç—Ä–µ–±—É–µ—Ç—Å—è —Ä–∞–∑–≤–∏—Ç–∏–µ.' );
                }
                return strengths;
            }

            getTopicStats() {
                const answers = (this.testResults.answers || []).filter(a => a.topic);
                if (answers.length === 0) return [];

                const map = new Map();
                answers.forEach(a => {
                    const key = a.topic;
                    const current = map.get(key) || { topic: key, total: 0, correct: 0 };
                    current.total += 1;
                    if (a.isCorrect) current.correct += 1;
                    map.set(key, current);
                });

                const stats = Array.from(map.values()).map(s => ({
                    ...s,
                    accuracy: s.total > 0 ? Math.round((s.correct / s.total) * 100) : 0
                }));

                // –°–∏–ª—å–Ω—ã–µ ‚Äî —Å–≤–µ—Ä—Ö—É, —Å–ª–∞–±—ã–µ ‚Äî —Å–Ω–∏–∑—É
                stats.sort((a, b) => b.accuracy - a.accuracy);
                return stats;
            }
            
            getRecommendations() {
                if (this.testResults.isOrientation) {
                    const overall = this.testResults.profile?.overallScore ?? this.testResults.percentage;
                    const top = (this.testResults.profile?.scores || []).slice(0, 2);
                    const rec = [];
                    if (this.testResults.subject.startsWith('profession_med_')) {
                        rec.push('–ü–æ–ø—Ä–æ–±—É–π—Ç–µ ¬´–ø–æ–≥—Ä—É–∂–µ–Ω–∏–µ¬ª: –≤–æ–ª–æ–Ω—Ç—ë—Ä—Å—Ç–≤–æ/–º–µ–¥.–∫—Ä—É–∂–æ–∫/–î–µ–Ω—å –æ—Ç–∫—Ä—ã—Ç—ã—Ö –¥–≤–µ—Ä–µ–π –≤ –∫–æ–ª–ª–µ–¥–∂–µ/–≤—É–∑–µ.');
                        rec.push('–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –±–∞–∑—É: –±–∏–æ–ª–æ–≥–∏—è + —Ö–∏–º–∏—è ‚Äî —ç—Ç–æ —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç –¥–ª—è –ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏—è.');
                        if (overall < 60) rec.push('–°–æ–±–µ—Ä–∏—Ç–µ –±–æ–ª—å—à–µ –æ–ø—ã—Ç–∞: 2‚Äì3 –Ω–µ–¥–µ–ª–∏ –Ω–∞–±–ª—é–¥–µ–Ω–∏–π –∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–µ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏–µ —Ç–µ—Å—Ç–∞.');
                        if (top.length > 0) rec.push(`–°—Ñ–æ–∫—É—Å–∏—Ä—É–π—Ç–µ—Å—å –Ω–∞ —Å–∏–ª—å–Ω—ã—Ö —à–∫–∞–ª–∞—Ö: ${top.map(t => t.key).join(', ')}.`);
                        return rec;
                    }
                    rec.push('–°–æ—Å—Ç–∞–≤—å—Ç–µ —Å–ø–∏—Å–æ–∫ 5 –ø—Ä–æ—Ñ–µ—Å—Å–∏–π –∏ —Å—Ä–∞–≤–Ω–∏—Ç–µ –∏—Ö –ø–æ –∏–Ω—Ç–µ—Ä–µ—Å–∞–º/–∑–∞–¥–∞—á–∞–º/—É—Å–ª–æ–≤–∏—è–º —Ç—Ä—É–¥–∞.');
                    rec.push('–ü–æ–≥–æ–≤–æ—Ä–∏—Ç–µ —Å 1‚Äì2 –ª—é–¥—å–º–∏ –∏–∑ –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã—Ö —Å—Ñ–µ—Ä (–∏–Ω—Ç–µ—Ä–≤—å—é –Ω–∞ 10‚Äì15 –º–∏–Ω—É—Ç).');
                    if (overall < 60) rec.push('–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø—Ä–æ–µ–∫—Ç/–∫—Ä—É–∂–æ–∫ –Ω–∞ 2 –Ω–µ–¥–µ–ª–∏ –∏ –ø—Ä–æ–π–¥–∏—Ç–µ —Ç–µ—Å—Ç –ø–æ–≤—Ç–æ—Ä–Ω–æ.');
                    if (top.length > 0) rec.push(`–í–∞—à–∏ –≤–µ–¥—É—â–∏–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è: ${top.map(t => t.key).join(', ')}.`);
                    return rec;
                }

                const recommendations = [];
                const topicStats = this.getTopicStats();
                const weak = [...topicStats].reverse().slice(0, 3);
                if (weak.length > 0) {
                    recommendations.push(`–ü–æ–≤—Ç–æ—Ä–∏—Ç–µ —Ç–µ–º—ã: ${weak.map(w => `¬´${w.topic}¬ª`).join(', ')}`);
                    recommendations.push('–°–¥–µ–ª–∞–π—Ç–µ 10‚Äì15 –∑–∞–¥–∞—á –ø–æ –∫–∞–∂–¥–æ–π —Å–ª–∞–±–æ–π —Ç–µ–º–µ –∏ —Å–Ω–æ–≤–∞ –ø—Ä–æ–π–¥–∏—Ç–µ —Ç–µ—Å—Ç.' );
                }

                const percentage = this.testResults.percentage;
                if (percentage < 60) {
                    recommendations.push('–ù–∞—á–Ω–∏—Ç–µ —Å –±–∞–∑–æ–≤—ã—Ö –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–π –∏ –ø—Ä–∏–º–µ—Ä–æ–≤, –∑–∞—Ç–µ–º –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç–µ –∫ –∑–∞–¥–∞—á–∞–º.' );
                } else if (percentage < 80) {
                    recommendations.push('–î–æ–±–∞–≤—å—Ç–µ –∑–∞–¥–∞—á–∏ —Å—Ä–µ–¥–Ω–µ–≥–æ —É—Ä–æ–≤–Ω—è –∏ —Ä–∞–∑–±–æ—Ä –æ—à–∏–±–æ–∫ –ø–æ –æ–±—ä—è—Å–Ω–µ–Ω–∏—è–º.' );
                } else {
                    recommendations.push('–ü–µ—Ä–µ—Ö–æ–¥–∏—Ç–µ –∫ –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω—ã–º –∑–∞–¥–∞—á–∞–º –∏ –∑–∞–¥–∞–Ω–∏—è–º –Ω–∞ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∑–Ω–∞–Ω–∏–π.' );
                }

                if (recommendations.length === 0) {
                    recommendations.push('–ü—Ä–æ–¥–æ–ª–∂–∞–π—Ç–µ –∏–∑—É—á–µ–Ω–∏–µ –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω—ã—Ö —Ç–µ–º.' );
                }
                return recommendations;
            }

            generateDetailedAnswers() {
                return this.answers.map((answer, index) => `
                    <div class="answer-review ${answer.isCorrect ? 'correct' : 'incorrect'}">
                        <div class="answer-header">
                            <span class="question-num">–í–æ–ø—Ä–æ—Å ${index + 1}</span>
                            <span class="difficulty-badge">–°–ª–æ–∂–Ω–æ—Å—Ç—å: ${answer.difficulty}/7</span>
                            <span class="result-badge">${answer.isCorrect ? '‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ' : '‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ'}</span>
                        </div>
                        <div class="answer-question">${answer.question}</div>
                        <div class="answer-explanation">
                            <strong>–û–±—ä—è—Å–Ω–µ–Ω–∏–µ:</strong> ${answer.explanation}
                        </div>
                    </div>
                `).join('');
            }

            saveResults() {
                const savedResults = JSON.parse(localStorage.getItem('testResults') || '[]');
                savedResults.push({
                    ...this.testResults,
                    timestamp: Date.now()
                });
                localStorage.setItem('testResults', JSON.stringify(savedResults));
                
                this.updateUserStats();
            }

            updateUserStats() {
                const stats = JSON.parse(localStorage.getItem('userStats') || '{}');
                if (!stats.testsCompleted) stats.testsCompleted = 0;
                if (!stats.totalScore) stats.totalScore = 0;
                if (!stats.bestScore) stats.bestScore = 0;
                
                stats.testsCompleted++;
                stats.totalScore += this.testResults.percentage;
                stats.averageScore = Math.round(stats.totalScore / stats.testsCompleted);
                stats.bestScore = Math.max(stats.bestScore, this.testResults.percentage);
                
                localStorage.setItem('userStats', JSON.stringify(stats));
            }
        }

        console.log('Creating AdaptiveTestSystem instance...');
        const testSystem = new AdaptiveTestSystem();
        console.log('AdaptiveTestSystem created successfully:', testSystem);

        function setUserGrade(value) {
            const grade = parseInt(value, 10) || 9;
            localStorage.setItem('userGrade', grade.toString());
            const select = document.getElementById('grade-select');
            if (select && select.value !== grade.toString()) {
                select.value = grade.toString();
            }
            const hint = document.getElementById('grade-hint');
            if (hint) {
                hint.textContent = `–°–ª–æ–∂–Ω–æ—Å—Ç—å –∞–¥–∞–ø—Ç–∏—Ä—É–µ—Ç—Å—è –ø–æ–¥ ${grade}-–π –∫–ª–∞—Å—Å`;
            }
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–µ–ª–µ–∫—Ç–æ—Ä–∞ –∫–ª–∞—Å—Å–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        document.addEventListener('DOMContentLoaded', () => {
            const saved = localStorage.getItem('userGrade') || '9';
            setUserGrade(saved);
        });

        function startTest(subject) {
            console.log('startTest called with subject:', subject);
            
            try {
                try { localStorage.setItem('mo_last_test_subject', String(subject)); } catch { /* ignore */ }
                try {
                    const title = resolveTestCardTitle(subject);
                    if (title) localStorage.setItem('mo_last_test_title', String(title));
                    else localStorage.removeItem('mo_last_test_title');
                } catch { /* ignore */ }

                const userGrade = parseInt(localStorage.getItem('userGrade') || '5');
                console.log('User grade:', userGrade);
                
                testSystem.startTest(subject, userGrade);
                console.log('testSystem.startTest called successfully');

                try { if (typeof updateCurrentTestUI === 'function') updateCurrentTestUI(); } catch { /* ignore */ }
                
                // –°–∫—Ä—ã—Ç—å —Ç–æ–ª—å–∫–æ –∫–∞—Ä—Ç–æ—á–∫–∏ –≤—ã–±–æ—Ä–∞ —Ç–µ—Å—Ç–æ–≤ (–∞ –Ω–µ –≤—Å—é —Å–µ–∫—Ü–∏—é)
                const testCards = document.querySelector('#tests .test-cards');
                if (testCards) {
                    testCards.style.display = 'none';
                    console.log('Test cards hidden');
                }
                // –ù–∞ –≤—Å—è–∫–∏–π —Å–ª—É—á–∞–π —Å–∫—Ä—ã—Ç—å —Å—Ç–∞—Ä—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Ç–µ—Å—Ç–æ–≤
                const legacyContainer = document.getElementById('test-questions-container');
                if (legacyContainer) legacyContainer.style.display = 'none';
                
                // –ü–æ–∫–∞–∑–∞—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –∞–¥–∞–ø—Ç–∏–≤–Ω–æ–≥–æ —Ç–µ—Å—Ç–∞ (–ù–ï —Å—Ç–∞—Ä—ã–π test-questions-container)
                const testContainers = document.querySelectorAll('.test-container');
                console.log('Found test containers:', testContainers.length);
                
                // –ù–∞–π–¥–µ–º –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä - –≤—Ç–æ—Ä–æ–π –ø–æ –ø–æ—Ä—è–¥–∫—É (–Ω–µ test-questions-container)
                let adaptiveContainer = null;
                testContainers.forEach((container, index) => {
                    if (container.id !== 'test-questions-container') {
                        adaptiveContainer = container;
                    }
                });
                
                if (adaptiveContainer) {
                    adaptiveContainer.style.display = 'block';
                    adaptiveContainer.classList.add('active');
                    console.log('Adaptive test container shown');
                    console.log('Container style.display:', adaptiveContainer.style.display);
                    console.log('Container visibility:', window.getComputedStyle(adaptiveContainer).visibility);
                    console.log('Container height:', window.getComputedStyle(adaptiveContainer).height);

                    // –ù–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö –ø–æ—Å–ª–µ —Å–∫—Ä—ã—Ç–∏—è —Å–µ—Ç–∫–∏ –∫–∞—Ä—Ç–æ—á–µ–∫ —á–∞—Å—Ç–æ –æ—Å—Ç–∞—ë–º—Å—è ¬´–≤–Ω–∏–∑—É¬ª —Å—Ç—Ä–∞–Ω–∏—Ü—ã.
                    // –ü—Ä–æ–∫—Ä—É—á–∏–≤–∞–µ–º –∫ –∫–∞—Ä—Ç–æ—á–∫–µ –≤–æ–ø—Ä–æ—Å–∞, —á—Ç–æ–±—ã –±—ã–ª–æ –≤–∏–¥–Ω–æ, —á—Ç–æ —Ç–µ—Å—Ç —Å—Ç–∞—Ä—Ç–æ–≤–∞–ª.
                    setTimeout(() => {
                        const questionCard = document.getElementById('question-card');
                        const scrollTarget = questionCard || adaptiveContainer;
                        if (scrollTarget && typeof scrollTarget.scrollIntoView === 'function') {
                            scrollTarget.scrollIntoView({ behavior: 'smooth', block: 'start' });
                        }
                    }, 50);
                } else {
                    console.error('Adaptive test container not found');
                }
                
                // –°–∫—Ä—ã—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
                const resultContainers = document.querySelectorAll('.result-container');
                resultContainers.forEach(container => {
                    container.style.display = 'none';
                });
                
                // –°–∫—Ä—ã—Ç—å –∫–Ω–æ–ø–∫—É next –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ
                const nextBtn = document.getElementById('next-btn');
                if (nextBtn) {
                    nextBtn.style.display = 'none';
                }
                
            } catch (error) {
                console.error('Error in startTest:', error);
            }
        }

        function getLastTestSubject() {
            try { return localStorage.getItem('mo_last_test_subject') || ''; } catch { return ''; }
        }

        function getLastTestTitle() {
            try { return localStorage.getItem('mo_last_test_title') || ''; } catch { return ''; }
        }

        function resolveTestCardTitle(subject) {
            if (!subject) return '';
            try {
                const cards = document.querySelectorAll('#tests .test-card');
                for (const card of cards) {
                    const onclick = (card.getAttribute('onclick') || '');
                    if (onclick.includes(`startTest('${subject}'`) || onclick.includes(`startTest(\"${subject}\"`)) {
                        const h3 = card.querySelector('h3');
                        const title = h3 ? (h3.textContent || '').trim() : '';
                        if (title) return title;
                    }
                }
            } catch { /* ignore */ }
            return '';
        }

        function updateCurrentTestUI() {
            const current = (testSystem && testSystem.currentTest) ? String(testSystem.currentTest) : '';
            const last = getLastTestSubject();
            const subject = current || last;
            const title = subject ? (resolveTestCardTitle(subject) || getLastTestTitle()) : '';
            const fallbackName = subject ? getTestName(subject) : '';
            const displayName = title || fallbackName;

            const label = document.getElementById('current-test-label');
            if (label) {
                label.textContent = displayName ? displayName : '–í—ã–±–µ—Ä–∏—Ç–µ —Ç–µ—Å—Ç, —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å';
            }

            // –ü–æ–¥—Å–≤–µ—Ç–∫–∞ –∫–∞—Ä—Ç–æ—á–∫–∏ –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ —Ç–µ—Å—Ç–∞
            try {
                document.querySelectorAll('#tests .test-card.active-test').forEach(el => el.classList.remove('active-test'));
                if (subject) {
                    document.querySelectorAll('#tests .test-card').forEach(card => {
                        const onclick = (card.getAttribute('onclick') || '');
                        if (onclick.includes(`startTest('${subject}'`) || onclick.includes(`startTest(\"${subject}\"`)) {
                            card.classList.add('active-test');
                        }
                    });
                }
            } catch { /* ignore */ }
        }

        function nextQuestion() {
            testSystem.submitAnswer();
        }

        function prevAdaptiveQuestion() {
            if (testSystem && typeof testSystem.goBackOneQuestion === 'function') {
                testSystem.goBackOneQuestion();
            }
        }

        function skipQuestion() {
            testSystem.skipCurrentQuestion();
        }
        
        function selectAnswer(optionIndex) {
            testSystem.selectAnswer(optionIndex);
            document.getElementById('next-btn').style.display = 'inline-block';
        }
        
        function restartTest() {
            console.log('restartTest called');
            if (testSystem && testSystem.currentTest) {
                // –°–∫—Ä—ã—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º
                const resultContainers = document.querySelectorAll('.result-container');
                resultContainers.forEach(c => c.style.display = 'none');
                
                startTest(testSystem.currentTest);
            } else {
                console.error('Cannot restart: no current test');
                goBackToTests();
            }
        }
        
        function restartCurrentTest() {
            restartTest();
        }
        
        function goBackToTests() {
            console.log('goBackToTests called');
            
            // 1. –°–∫—Ä—ã—Ç—å –≤—Å–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã —Ç–µ—Å—Ç–æ–≤
            const allTestContainers = document.querySelectorAll('#tests .test-container');
            allTestContainers.forEach(c => c.style.display = 'none');

            // 2. –°–∫—Ä—ã—Ç—å –≤—Å–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
            const resultContainers = document.querySelectorAll('.result-container');
            resultContainers.forEach(c => c.style.display = 'none');

            // 3. –ü–æ–∫–∞–∑–∞—Ç—å —Å–µ–∫—Ü–∏—é —Ç–µ—Å—Ç–æ–≤ –∏ –∫–∞—Ä—Ç–æ—á–∫–∏
            const testsSection = document.getElementById('tests');
            if (testsSection) testsSection.style.display = 'block';

            const testCards = document.querySelector('#tests .test-cards');
            if (testCards) testCards.style.display = 'grid';

            // 4. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–±—â–∏–π —Ä–æ—É—Ç–µ—Ä –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
            if (typeof showSection === 'function') {
                showSection('tests');
            }
            
            // 5. –°–±—Ä–æ—Å —Å–∫—Ä–æ–ª–ª–∞
            window.scrollTo(0, 0);

            try { if (typeof updateCurrentTestUI === 'function') updateCurrentTestUI(); } catch { /* ignore */ }
        }
        
        function shareResults() {
            if (testSystem && testSystem.testResults) {
                const results = testSystem.testResults;
                const time = `${Math.floor(results.timeSpent / 60)}:${(results.timeSpent % 60).toString().padStart(2, '0')}`;
                const title = `–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∞ - ${getTestName(results.subject)}`;

                let text = `üéØ –ú–æ–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: ${results.percentage}%\n‚è±Ô∏è –í—Ä–µ–º—è: ${time}`;
                if (results.isOrientation) {
                    const top = (results.profile?.scores || []).slice(0, 3);
                    const labelOf = (k) => (typeof ORIENTATION_DIM_LABELS === 'object' && ORIENTATION_DIM_LABELS && ORIENTATION_DIM_LABELS[k]) ? ORIENTATION_DIM_LABELS[k] : String(k);
                    if (top.length) text += `\nüß≠ –¢–æ–ø-–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è: ${top.map(t => `${labelOf(t.key)} (${t.score}%)`).join(', ')}`;
                } else {
                    text += `\n‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω—ã—Ö: ${results.score}/${results.total}`;
                }
                text += `\n\n–ü—Ä–æ–π–¥–∏ —Ç–µ—Å—Ç –Ω–∞ ${location.origin}!`;
                
                if (navigator.share) {
                    navigator.share({
                        title,
                        text
                    }).catch(console.error);
                } else {
                    // –ö–æ–ø–∏—Ä—É–µ–º –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞
                    navigator.clipboard.writeText(text).then(() => {
                        alert('–†–µ–∑—É–ª—å—Ç–∞—Ç —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞!');
                    }).catch(() => {
                        alert('–ù–µ —É–¥–∞–ª–æ—Å—å —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç');
                    });
                }
            }
        }
        
        // –°–∫–∞—á–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∫–∞–∫ PDF (–ø—Ä–æ—Å—Ç–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è)
        function downloadResultsPDF() {
            if (!testSystem || !testSystem.testResults) {
                showNotification('–ù–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è', 'warning');
                return;
            }
            
            const results = testSystem.testResults;
            const testName = getTestName(results.subject);
            
            // –°–æ–∑–¥–∞—ë–º HTML –¥–ª—è –ø–µ—á–∞—Ç–∏/PDF
            const htmlContent = `
                <!DOCTYPE html>
                <html>
                <head>
                    <meta charset="UTF-8">
                    <title>–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∞ - ${testName}</title>
                    <style>
                        body { font-family: Arial, sans-serif; padding: 40px; max-width: 800px; margin: 0 auto; }
                        h1 { color: #667eea; text-align: center; }
                        .score { font-size: 48px; text-align: center; color: #667eea; font-weight: bold; }
                        .stats { display: flex; justify-content: space-around; margin: 30px 0; }
                        .stat { text-align: center; }
                        .stat-value { font-size: 24px; font-weight: bold; }
                        .stat-label { color: #666; }
                        .section { margin: 20px 0; padding: 15px; background: #f5f5f5; border-radius: 10px; }
                        .footer { text-align: center; margin-top: 40px; color: #999; font-size: 12px; }
                    </style>
                </head>
                <body>
                    <h1>üè• –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∞</h1>
                    <h2 style="text-align: center; color: #666;">${testName}</h2>
                    
                    <div class="score">${results.percentage}%</div>
                    
                    <div class="stats">
                        ${results.isOrientation ? `
                        <div class="stat">
                            <div class="stat-value">üß≠ ${results.percentage}%</div>
                            <div class="stat-label">–ü—Ä–æ—Ñ–∏–ª—å</div>
                        </div>
                        ` : `
                        <div class="stat">
                            <div class="stat-value">‚úÖ ${results.score}</div>
                            <div class="stat-label">–ü—Ä–∞–≤–∏–ª—å–Ω—ã—Ö</div>
                        </div>
                        <div class="stat">
                            <div class="stat-value">‚ùå ${results.total - results.score}</div>
                            <div class="stat-label">–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö</div>
                        </div>
                        `}
                        <div class="stat">
                            <div class="stat-value">‚è±Ô∏è ${Math.floor(results.timeSpent / 60)}:${(results.timeSpent % 60).toString().padStart(2, '0')}</div>
                            <div class="stat-label">–í—Ä–µ–º—è</div>
                        </div>
                    </div>
                    
                    <div class="section">
                        <h3>üìä –ê–Ω–∞–ª–∏–∑</h3>
                        <p>${results.isOrientation ? '–ü—Ä–æ—Ñ–æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏—è: –≤ —ç—Ç–æ–º —Ç–µ—Å—Ç–µ –Ω–µ—Ç ¬´–ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö¬ª –æ—Ç–≤–µ—Ç–æ–≤ ‚Äî –≤–∞–∂–Ω—ã –≤–∞—à–∏ –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏—è.' : `–£—Ä–æ–≤–µ–Ω—å –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏: ${results.percentage >= 90 ? '–û—Ç–ª–∏—á–Ω–æ' : results.percentage >= 75 ? '–•–æ—Ä–æ—à–æ' : results.percentage >= 60 ? '–£–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–∏—Ç–µ–ª—å–Ω–æ' : '–¢—Ä–µ–±—É–µ—Ç—Å—è –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞'}`}</p>
                    </div>
                    
                    <div class="footer">
                        <p>–î–∞—Ç–∞: ${new Date().toLocaleDateString('ru-RU')}</p>
                        <p>–ú–µ–¥–∏—Ü–∏–Ω—Å–∫–∞—è –ü—Ä–æ—Ñ–æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏—è ¬© ${new Date().getFullYear()}</p>
                    </div>
                </body>
                </html>
            `;
            
            // –û—Ç–∫—Ä—ã–≤–∞–µ–º –æ–∫–Ω–æ –¥–ª—è –ø–µ—á–∞—Ç–∏/—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è
            const printWindow = window.open('', '_blank');
            printWindow.document.write(htmlContent);
            printWindow.document.close();
            printWindow.print();
            
            showNotification('PDF –≥–æ—Ç–æ–≤ –∫ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—é', 'success');
        }
        
        // –ü–µ—á–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
        function printResults() {
            downloadResultsPDF();
        }

        function checkTestResults() {
            testSystem.finishTest();
        }

        function viewDetailedAnalysis() {
            const analysisSection = document.querySelector('.detailed-answers');
            analysisSection.style.display = analysisSection.style.display === 'none' ? 'block' : 'none';
        }

        // –ê–Ω–∏–º–∞—Ü–∏—è –ø–æ—è–≤–ª–µ–Ω–∏—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –ø—Ä–∏ —Å–∫—Ä–æ–ª–ª–µ
        function isPerfLiteMode() {
            try {
                const reduceMotion = window.matchMedia && window.matchMedia('(prefers-reduced-motion: reduce)').matches;
                const lowMem = typeof navigator !== 'undefined' && typeof navigator.deviceMemory === 'number' && navigator.deviceMemory > 0 && navigator.deviceMemory <= 2;
                const lowCpu = typeof navigator !== 'undefined' && typeof navigator.hardwareConcurrency === 'number' && navigator.hardwareConcurrency > 0 && navigator.hardwareConcurrency <= 4;
                const saveData = navigator && navigator.connection && navigator.connection.saveData === true;
                return !!(reduceMotion || lowMem || lowCpu || saveData);
            } catch {
                return false;
            }
        }

        const PERF_LITE = isPerfLiteMode();
        try {
            if (PERF_LITE) document.documentElement.classList.add('perf-lite');
        } catch {
            // ignore
        }

        const observerOptions = {
            threshold: 0.1,
            rootMargin: '0px 0px -50px 0px'
        };

        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('animate-fadeIn');
                    // –°—Ä–∞–∑—É –ø–µ—Ä–µ—Å—Ç–∞—ë–º –Ω–∞–±–ª—é–¥–∞—Ç—å, —á—Ç–æ–±—ã –Ω–µ –≥—Ä—É–∑–∏—Ç—å CPU/GPU
                    try { observer.unobserve(entry.target); } catch { /* ignore */ }
                }
            });
        }, observerOptions);

        // –ù–∞–±–ª—é–¥–∞–µ–º –∑–∞ –∫–∞—Ä—Ç–æ—á–∫–∞–º–∏
        document.addEventListener('DOMContentLoaded', () => {
            console.log('=== DOM CONTENT LOADED ===');
            if (!PERF_LITE) {
                const cards = document.querySelectorAll('.card, .test-card, .specialty-card, .achievement');
                console.log('Found cards:', cards.length);
                cards.forEach(card => {
                    observer.observe(card);
                });
            } else {
                console.log('perf-lite enabled: skipping scroll reveal observer');
            }

            // –ú–æ–±–∏–ª—å–Ω—ã–π —Ñ–∏–∫—Å: –ø—Ä–∏ –ø—Ä–æ–∫—Ä—É—Ç–∫–µ –ø–∞–ª—å—Ü–µ–º –ø–æ –∫–∞—Ä—Ç–æ—á–∫–∞–º –∏–Ω–æ–≥–¥–∞ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç click,
            // –∏–∑-–∑–∞ —á–µ–≥–æ –≤–Ω–µ–∑–∞–ø–Ω–æ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è —Ç–µ—Å—Ç –∏ —Å–µ—Ç–∫–∞ ¬´–ø—Ä–æ–ø–∞–¥–∞–µ—Ç¬ª.
            // –ü–æ–¥–∞–≤–ª—è–µ–º click, –µ—Å–ª–∏ –±—ã–ª –∂–µ—Å—Ç –ø—Ä–æ–∫—Ä—É—Ç–∫–∏ (–¥–≤–∏–∂–µ–Ω–∏–µ –±–æ–ª—å—à–µ –ø–æ—Ä–æ–≥–∞).
            (function installTestCardsTapGuard() {
                const MOVE_THRESHOLD = 10; // px
                let activeCard = null;
                let startX = 0;
                let startY = 0;
                let moved = false;

                const getPoint = (ev) => {
                    const t = ev.touches && ev.touches[0] ? ev.touches[0] : (ev.changedTouches && ev.changedTouches[0] ? ev.changedTouches[0] : ev);
                    return { x: t.clientX || 0, y: t.clientY || 0 };
                };

                const onStart = (ev) => {
                    const card = ev.target && ev.target.closest ? ev.target.closest('.test-card') : null;
                    if (!card) return;
                    activeCard = card;
                    moved = false;
                    const p = getPoint(ev);
                    startX = p.x;
                    startY = p.y;
                };

                const onMove = (ev) => {
                    if (!activeCard) return;
                    const p = getPoint(ev);
                    const dx = Math.abs(p.x - startX);
                    const dy = Math.abs(p.y - startY);
                    if (dx + dy > MOVE_THRESHOLD) moved = true;
                };

                const onEnd = () => {
                    if (!activeCard) return;
                    if (moved) {
                        activeCard.dataset.suppressClick = '1';
                        setTimeout(() => {
                            if (activeCard) delete activeCard.dataset.suppressClick;
                        }, 0);
                    }
                    activeCard = null;
                    moved = false;
                };

                // Capture click before inline onclick runs
                document.addEventListener('click', (ev) => {
                    const card = ev.target && ev.target.closest ? ev.target.closest('.test-card') : null;
                    if (!card) return;
                    if (card.dataset.suppressClick === '1') {
                        ev.preventDefault();
                        ev.stopPropagation();
                        ev.stopImmediatePropagation();
                        delete card.dataset.suppressClick;
                    }
                }, true);

                if ('PointerEvent' in window) {
                    document.addEventListener('pointerdown', onStart, { passive: true });
                    document.addEventListener('pointermove', onMove, { passive: true });
                    document.addEventListener('pointerup', onEnd, { passive: true });
                    document.addEventListener('pointercancel', onEnd, { passive: true });
                } else {
                    document.addEventListener('touchstart', onStart, { passive: true });
                    document.addEventListener('touchmove', onMove, { passive: true });
                    document.addEventListener('touchend', onEnd, { passive: true });
                    document.addEventListener('touchcancel', onEnd, { passive: true });
                }
            })();
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ñ–∞–∫—Ç–æ–≤
            initFactsCarousel();
            
            // –¢–∞–π–º–µ—Ä –ï–ì–≠ —É–±—Ä–∞–Ω –ø–æ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ü–∏—Ç–∞—Ç—ã –¥–Ω—è
            initDailyQuote();
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä–∞ —Å–∫—Ä–æ–ª–ª–∞ (–¥–æ—Ä–æ–≥–æ –Ω–∞ —Å–ª–∞–±—ã—Ö –ü–ö)
            if (!PERF_LITE) {
                initScrollProgress();
            }
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –≤—Å–µ –Ω—É–∂–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–æ—Å—Ç—É–ø–Ω—ã
            console.log('Functions check:');
            console.log('- startTest:', typeof startTest);
            console.log('- testSystem:', typeof testSystem, testSystem);
            console.log('- questionDatabase keys:', Object.keys(questionDatabase || {}));
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–Ω–æ–ø–∫–∏ —Ç–µ—Å—Ç–æ–≤
            const testCards = document.querySelectorAll('.test-card');
            console.log('Test cards found:', testCards.length);
            testCards.forEach((card, index) => {
                console.log(`Test card ${index}:`, card.getAttribute('onclick'));
            });
        });
        

        
        function nextFact() {
            currentFactIndex = (currentFactIndex + 1) % totalFacts;
            showFact(currentFactIndex);
        }
        
        function prevFact() {
            currentFactIndex = (currentFactIndex - 1 + totalFacts) % totalFacts;
            showFact(currentFactIndex);
        }
        
        // –¶–∏—Ç–∞—Ç–∞ –¥–Ω—è
        function initDailyQuote() {
            const quotes = [
                { text: "–ú–µ–¥–∏—Ü–∏–Ω–∞ ‚Äî —ç—Ç–æ –Ω–µ —Ç–æ–ª—å–∫–æ –Ω–∞—É–∫–∞, –Ω–æ –∏ –∏—Å–∫—É—Å—Å—Ç–≤–æ. –û–Ω–∞ —Ç—Ä–µ–±—É–µ—Ç –Ω–µ —Ç–æ–ª—å–∫–æ –∑–Ω–∞–Ω–∏–π, –Ω–æ –∏ —Å–µ—Ä–¥—Ü–∞.", author: "–ì–∏–ø–ø–æ–∫—Ä–∞—Ç" },
                { text: "–í—Ä–∞—á –¥–æ–ª–∂–µ–Ω –∏–º–µ—Ç—å –≥–æ–ª–æ–≤—É –ª—å–≤–∞, –≥–ª–∞–∑ –æ—Ä–ª–∞ –∏ —Ä—É–∫–∏ –∂–µ–Ω—â–∏–Ω—ã.", author: "–ê–±—É –ë–∞–∫—Ä –∞—Ä-–†–∞–∑–∏" },
                { text: "–ì–¥–µ –µ—Å—Ç—å –ª—é–±–æ–≤—å –∫ –ª—é–¥—è–º, —Ç–∞–º –µ—Å—Ç—å –∏ –ª—é–±–æ–≤—å –∫ –∏—Å–∫—É—Å—Å—Ç–≤—É –≤—Ä–∞—á–µ–≤–∞–Ω–∏—è.", author: "–ì–∏–ø–ø–æ–∫—Ä–∞—Ç" },
                { text: "–ú–µ–¥–∏—Ü–∏–Ω–∞ –ø–æ–∏—Å—Ç–∏–Ω–µ –µ—Å—Ç—å —Å–∞–º–æ–µ –±–ª–∞–≥–æ—Ä–æ–¥–Ω–æ–µ –∏–∑ –≤—Å–µ—Ö –∏—Å–∫—É—Å—Å—Ç–≤.", author: "–ì–∏–ø–ø–æ–∫—Ä–∞—Ç" },
                { text: "–•–æ—Ä–æ—à–∏–π –≤—Ä–∞—á –ª–µ—á–∏—Ç –±–æ–ª–µ–∑–Ω—å, –≤–µ–ª–∏–∫–∏–π –≤—Ä–∞—á –ª–µ—á–∏—Ç –ø–∞—Ü–∏–µ–Ω—Ç–∞.", author: "–£–∏–ª—å—è–º –û—Å–ª–µ—Ä" },
                { text: "–ü—Ä–æ—Ñ–∏–ª–∞–∫—Ç–∏–∫–∞ ‚Äî –ª—É—á—à–µ–µ –ª–µ—á–µ–Ω–∏–µ.", author: "–ù–∞—Ä–æ–¥–Ω–∞—è –º—É–¥—Ä–æ—Å—Ç—å" },
                { text: "–õ—É—á—à–µ–µ –ª–µ–∫–∞—Ä—Å—Ç–≤–æ ‚Äî —ç—Ç–æ –¥–æ–±—Ä–æ–µ —Å–ª–æ–≤–æ.", author: "–ê–≤–∏—Ü–µ–Ω–Ω–∞" },
                { text: "–ù–µ—Ç –Ω–µ–∏–∑–ª–µ—á–∏–º—ã—Ö –±–æ–ª–µ–∑–Ω–µ–π, –µ—Å—Ç—å –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ–∫ –∑–Ω–∞–Ω–∏–π.", author: "–ì–∏–ø–ø–æ–∫—Ä–∞—Ç" }
            ];
            
            const today = new Date();
            const dayOfYear = Math.floor((today - new Date(today.getFullYear(), 0, 0)) / (1000 * 60 * 60 * 24));
            const quoteIndex = dayOfYear % quotes.length;
            const quote = quotes[quoteIndex];
            
            const quoteEl = document.getElementById('daily-quote');
            const authorEl = document.getElementById('quote-author');
            
            if (quoteEl) quoteEl.textContent = `"${quote.text}"`;
            if (authorEl) authorEl.textContent = `‚Äî ${quote.author}`;
        }
        
        // –ü—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä —Å–∫—Ä–æ–ª–ª–∞
        function initScrollProgress() {
            const progressBar = document.createElement('div');
            progressBar.className = 'scroll-progress';
            progressBar.id = 'scroll-progress';
            document.body.appendChild(progressBar);
            
            window.addEventListener('scroll', () => {
                const scrollHeight = document.documentElement.scrollHeight - window.innerHeight;
                const scrolled = (window.scrollY / scrollHeight) * 100;
                progressBar.style.width = `${scrolled}%`;
            });
        }
        
        // ========================================
        // –§–£–ù–ö–¶–ò–ò –§–ò–õ–¨–¢–†–ê–¶–ò–ò –¢–ï–°–¢–û–í
        // ========================================
        
        let currentGradeFilter = 'all';
        let currentCategoryFilter = 'all';
        
        function filterByGrade(grade) {
            currentGradeFilter = grade;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—É—é –∫–Ω–æ–ø–∫—É –≤ —Ñ–∏–ª—å—Ç—Ä–µ –∫–ª–∞—Å—Å–æ–≤
            document.querySelectorAll('.grade-filters .filter-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            applyFilters();
        }
        
        function filterByCategory(category) {
            currentCategoryFilter = category;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—É—é –∫–Ω–æ–ø–∫—É –≤ —Ñ–∏–ª—å—Ç—Ä–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–π
            document.querySelectorAll('.category-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            applyFilters();
        }
        
        function applyFilters() {
            const testCards = document.querySelectorAll('#tests-grid .test-card');
            let visibleCount = 0;
            
            testCards.forEach(card => {
                const cardGrades = card.dataset.grade ? card.dataset.grade.split(',') : ['all'];
                const cardCategory = card.dataset.category || 'all';
                
                let showByGrade = currentGradeFilter === 'all' || cardGrades.includes(currentGradeFilter.toString()) || cardGrades.includes('all');
                let showByCategory = currentCategoryFilter === 'all' || cardCategory === currentCategoryFilter;
                
                if (showByGrade && showByCategory) {
                    card.style.display = 'block';
                    card.style.animation = 'neon-fade-in 0.4s ease-out forwards';
                    card.style.animationDelay = (visibleCount * 0.1) + 's';
                    visibleCount++;
                } else {
                    card.style.display = 'none';
                }
            });
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –µ—Å–ª–∏ –Ω–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
            const noResultsMsg = document.getElementById('no-tests-message');
            if (visibleCount === 0) {
                if (!noResultsMsg) {
                    const msg = document.createElement('div');
                    msg.id = 'no-tests-message';
                    msg.className = 'no-tests-message';
                    msg.innerHTML = '<i class="fas fa-search"></i> –¢–µ—Å—Ç—ã –¥–ª—è –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö —Ñ–∏–ª—å—Ç—Ä–æ–≤ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã';
                    msg.style.cssText = `
                        text-align: center;
                        padding: 40px;
                        color: var(--neon-cyan);
                        font-size: 18px;
                        grid-column: 1 / -1;
                    `;
                    document.getElementById('tests-grid').appendChild(msg);
                }
            } else if (noResultsMsg) {
                noResultsMsg.remove();
            }
        }
        
        // ========================================
        // –§–£–ù–ö–¶–ò–ò –†–ï–î–ê–ö–¢–ò–†–û–í–ê–ù–ò–Ø –ü–†–û–§–ò–õ–Ø
        // ========================================
        
        function editProfileName() {
            const currentName = document.getElementById('profile-name').textContent;
            const newName = prompt('–í–≤–µ–¥–∏—Ç–µ –Ω–æ–≤–æ–µ –∏–º—è:', currentName);
            
            if (newName && newName.trim() !== '') {
                // –û–±–Ω–æ–≤–ª—è–µ–º –≤ localStorage
                const currentUser = JSON.parse(localStorage.getItem(CURRENT_USER_KEY));
                if (currentUser) {
                    currentUser.name = newName.trim();
                    localStorage.setItem(CURRENT_USER_KEY, JSON.stringify(currentUser));
                    
                    // –û–±–Ω–æ–≤–ª—è–µ–º –≤ —Å–ø–∏—Å–∫–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
                    const users = JSON.parse(localStorage.getItem(USERS_KEY) || '[]');
                    const userIndex = users.findIndex(u => u.id === currentUser.id);
                    if (userIndex !== -1) {
                        users[userIndex].name = newName.trim();
                        localStorage.setItem(USERS_KEY, JSON.stringify(users));
                    }
                    
                    // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
                    document.getElementById('profile-name').textContent = newName.trim();
                    
                    // –û–±–Ω–æ–≤–ª—è–µ–º –∞–≤–∞—Ç–∞—Ä-–ø–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä
                    const avatarPlaceholder = document.getElementById('avatar-placeholder');
                    if (avatarPlaceholder && avatarPlaceholder.style.display !== 'none') {
                        avatarPlaceholder.textContent = newName.trim().charAt(0).toUpperCase();
                    }
                    
                    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
                    showNotification('‚úÖ –ò–º—è —É—Å–ø–µ—à–Ω–æ –∏–∑–º–µ–Ω–µ–Ω–æ!', 'success');
                }
            }
        }
        
        function viewTestHistory() {
            // –°–∫—Ä–æ–ª–ª –∫ –∏—Å—Ç–æ—Ä–∏–∏ —Ç–µ—Å—Ç–æ–≤
            const historySection = document.querySelector('.test-history');
            if (historySection) {
                historySection.scrollIntoView({ behavior: 'smooth', block: 'start' });
                historySection.style.animation = 'neon-pulse 1s ease 2';
            }
        }
        
        function showNotification(message, type = 'info') {
            // –°–æ–∑–¥–∞—ë–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.innerHTML = message;
            notification.style.cssText = `
                position: fixed;
                top: 100px;
                right: 20px;
                background: var(--card-bg, rgba(10, 10, 20, 0.95));
                border: 2px solid var(--neon-cyan, #00f5ff);
                color: var(--neon-cyan, #00f5ff);
                padding: 15px 25px;
                border-radius: 10px;
                box-shadow: 0 0 30px rgba(0, 245, 255, 0.3);
                z-index: 9999;
                animation: notification-in 0.5s ease;
                font-family: 'Orbitron', sans-serif;
            `;
            
            document.body.appendChild(notification);
            
            // –£–¥–∞–ª—è–µ–º —á–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã
            setTimeout(() => {
                notification.style.animation = 'notification-out 0.5s ease forwards';
                setTimeout(() => notification.remove(), 500);
            }, 3000);
        }
        
        console.log('=== SCRIPT END ===');
    </script>
    
</body>
</html>
